<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>global_coordinator &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>global_coordinator
      <small>Module Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.9% of total for procedures.">141 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe_mpi_fragment_distribution_scheme.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe_mpi_fragment_distribution_scheme.f90.html'>mqc_mbe_mpi_fragment_distribution_scheme.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe_fragment_distribution_scheme.html'>mqc_mbe_fragment_distribution_scheme</a></li>
            <li class="breadcrumb-item active" aria-current="page">global_coordinator</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-calc_type_local~2">calc_type_local</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-coord_timer">coord_timer</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-current_fragment">current_fragment</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-dummy_msg">dummy_msg</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-finished_nodes">finished_nodes</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-fragment_idx~3">fragment_idx</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-handling_local_workers">handling_local_workers</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-has_pending">has_pending</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_dummy">local_dummy</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_finished_workers">local_finished_workers</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-local_status">local_status</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-req~3">req</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-request_source">request_source</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-results">results</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-results_received">results_received</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-status~3">status</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-worker_fragment_map">worker_fragment_map</a>
            <a class="list-group-item" href="../proc/global_coordinator.html#variable-worker_source">worker_source</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/global_coordinator.html#src">global_coordinator</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>module subroutine global_coordinator(world_comm, node_comm, total_fragments, polymers, max_level, node_leader_ranks, num_nodes, sys_geom, calc_type, bonds)  
    <a href="../interface/global_coordinator.html"><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
</h2>
    

    <p>Global coordinator for distributing fragments to node coordinators
will act as a node coordinator for a single node calculation
Uses int64 for total_fragments to handle large fragment counts that overflow int32.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~10"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_comm~5"></span>
              type(comm_t),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>node_comm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_fragments~5"></span>
              integer(kind=int64),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_fragments</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~7"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~6"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-node_leader_ranks~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>node_leader_ranks</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-num_nodes~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>num_nodes</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~15"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-calc_type~8"></span>
              integer(kind=int32),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>calc_type</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~5"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~global_coordinator~~CallsGraph Pages: 1 -->
<svg id="procglobal_coordinatorCallsGraph" width="641pt" height="684pt"
 viewBox="0.00 0.00 641.00 684.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~global_coordinator~~CallsGraph" class="graph" transform="scale(0.37 0.37) rotate(0) translate(4 1826.35)">
<title>proc~~global_coordinator~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1826.35 1711,-1826.35 1711,4 -4,4"/>
<!-- proc~global_coordinator -->
<g id="proc~~global_coordinator~~CallsGraph_node1" class="node">
<title>proc~global_coordinator</title>
<polygon fill="none" stroke="black" points="113,-355.35 0,-355.35 0,-331.35 113,-331.35 113,-355.35"/>
<text text-anchor="middle" x="56.5" y="-340.95" font-family="Helvetica,sans-Serif" font-size="10.50">global_coordinator</text>
</g>
<!-- abort_comm -->
<g id="proc~~global_coordinator~~CallsGraph_node2" class="node">
<title>abort_comm</title>
<polygon fill="#777777" stroke="#777777" points="1064.5,-742.35 984.5,-742.35 984.5,-718.35 1064.5,-718.35 1064.5,-742.35"/>
<text text-anchor="middle" x="1024.5" y="-727.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abort_comm</text>
</g>
<!-- proc~global_coordinator&#45;&gt;abort_comm -->
<g id="proc~~global_coordinator~~CallsGraph_edge1" class="edge">
<title>proc~global_coordinator&#45;&gt;abort_comm</title>
<path fill="none" stroke="#ff0000" d="M61.15,-355.42C70.74,-385.22 99.37,-463.07 149,-507.35 216.19,-567.31 249.23,-561.25 336,-585.35 447.25,-616.26 495.99,-560.74 593,-623.35 617.86,-639.4 603.99,-663.53 629,-679.35 657.68,-697.49 874.86,-717.84 974.19,-726.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="974.02,-729.81 984.28,-727.17 974.61,-722.84 974.02,-729.81"/>
</g>
<!-- debug -->
<g id="proc~~global_coordinator~~CallsGraph_node3" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="1051.5,-460.35 997.5,-460.35 997.5,-436.35 1051.5,-436.35 1051.5,-460.35"/>
<text text-anchor="middle" x="1024.5" y="-445.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~global_coordinator&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge2" class="edge">
<title>proc~global_coordinator&#45;&gt;debug</title>
<path fill="none" stroke="#ff0000" d="M60.89,-355.51C69.73,-384.54 96.52,-457.63 149,-486.35 223.28,-527.01 831.07,-468.07 987.1,-452.14"/>
<polygon fill="#ff0000" stroke="#ff0000" points="987.54,-455.61 997.13,-451.11 986.83,-448.65 987.54,-455.61"/>
</g>
<!-- error -->
<g id="proc~~global_coordinator~~CallsGraph_node4" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1617.5,-1163.35 1563.5,-1163.35 1563.5,-1139.35 1617.5,-1139.35 1617.5,-1163.35"/>
<text text-anchor="middle" x="1590.5" y="-1148.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~global_coordinator&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge3" class="edge">
<title>proc~global_coordinator&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M58.1,-355.69C65.3,-497.96 140.98,-1822.35 463.5,-1822.35 463.5,-1822.35 463.5,-1822.35 1025.5,-1822.35 1121.81,-1822.35 1382.41,-1801.12 1438,-1749.35 1525.73,-1667.65 1575.88,-1271.52 1587.09,-1173.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1590.57,-1173.73 1588.21,-1163.4 1583.61,-1172.95 1590.57,-1173.73"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_node5" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="806,-336.35 700,-336.35 700,-312.35 806,-312.35 806,-336.35"/>
<text text-anchor="middle" x="753" y="-321.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~global_coordinator&#45;&gt;get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_edge4" class="edge">
<title>proc~global_coordinator&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#ff0000" d="M64.38,-331.28C77.54,-309.58 108.58,-264.67 149,-247.35 239.7,-208.5 506.4,-200.07 593,-247.35 618.97,-261.53 604.32,-287.03 629,-303.35 646.78,-315.11 669.06,-320.93 689.76,-323.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="689.45,-327.13 699.77,-324.74 690.21,-320.17 689.45,-327.13"/>
</g>
<!-- info -->
<g id="proc~~global_coordinator~~CallsGraph_node6" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="780,-582.35 726,-582.35 726,-558.35 780,-558.35 780,-582.35"/>
<text text-anchor="middle" x="753" y="-567.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~global_coordinator&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge5" class="edge">
<title>proc~global_coordinator&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M69.79,-331.17C86.2,-315.84 116.95,-290.32 149,-280.35 243.22,-251.05 515.28,-219.57 593,-280.35 645.3,-321.26 598.73,-366.25 629,-425.35 655.3,-476.69 703.01,-525.51 730.64,-551.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="728.47,-554.08 738.2,-558.27 733.21,-548.93 728.47,-554.08"/>
</g>
<!-- iprobe -->
<g id="proc~~global_coordinator~~CallsGraph_node7" class="node">
<title>iprobe</title>
<polygon fill="#777777" stroke="#777777" points="251.5,-477.35 197.5,-477.35 197.5,-453.35 251.5,-453.35 251.5,-477.35"/>
<text text-anchor="middle" x="224.5" y="-462.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iprobe</text>
</g>
<!-- proc~global_coordinator&#45;&gt;iprobe -->
<g id="proc~~global_coordinator~~CallsGraph_edge6" class="edge">
<title>proc~global_coordinator&#45;&gt;iprobe</title>
<path fill="none" stroke="#ff0000" d="M65.97,-355.43C80.67,-375.55 112.81,-416.02 149,-439.35 160.63,-446.85 174.68,-452.48 187.43,-456.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="186.72,-459.99 197.3,-459.48 188.71,-453.28 186.72,-459.99"/>
</g>
<!-- irecv -->
<g id="proc~~global_coordinator~~CallsGraph_node8" class="node">
<title>irecv</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-355.35 437.5,-355.35 437.5,-331.35 491.5,-331.35 491.5,-355.35"/>
<text text-anchor="middle" x="464.5" y="-340.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">irecv</text>
</g>
<!-- proc~global_coordinator&#45;&gt;irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge7" class="edge">
<title>proc~global_coordinator&#45;&gt;irecv</title>
<path fill="none" stroke="#ff0000" d="M69.79,-355.54C86.2,-370.86 116.95,-396.39 149,-406.35 213.08,-426.28 238.17,-432.46 300,-406.35 321.14,-397.43 315.87,-380.35 336,-369.35 364.18,-353.95 400.37,-347.64 426.99,-345.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="427.37,-348.55 437.04,-344.23 426.79,-341.57 427.37,-348.55"/>
</g>
<!-- isend -->
<g id="proc~~global_coordinator~~CallsGraph_node9" class="node">
<title>isend</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-119.35 437.5,-119.35 437.5,-95.35 491.5,-95.35 491.5,-119.35"/>
<text text-anchor="middle" x="464.5" y="-104.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isend</text>
</g>
<!-- proc~global_coordinator&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge8" class="edge">
<title>proc~global_coordinator&#45;&gt;isend</title>
<path fill="none" stroke="#ff0000" d="M60.22,-331C67.94,-299.01 93.17,-213.04 149,-171.35 171.23,-154.76 349.17,-125.25 427.13,-112.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="428.1,-116.36 437.44,-111.35 427.02,-109.44 428.1,-116.36"/>
</g>
<!-- mbe_total_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node10" class="node">
<title>mbe_total_gradient</title>
<polygon fill="#777777" stroke="#777777" points="282.5,-355.35 166.5,-355.35 166.5,-331.35 282.5,-331.35 282.5,-355.35"/>
<text text-anchor="middle" x="224.5" y="-340.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_total_gradient</text>
</g>
<!-- proc~global_coordinator&#45;&gt;mbe_total_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge9" class="edge">
<title>proc~global_coordinator&#45;&gt;mbe_total_gradient</title>
<path fill="none" stroke="#ff0000" d="M113.24,-343.35C127.03,-343.35 141.96,-343.35 156.24,-343.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.49,-346.85 166.49,-343.35 156.49,-339.85 156.49,-346.85"/>
</g>
<!-- mbe_total_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node11" class="node">
<title>mbe_total_hessian</title>
<polygon fill="#777777" stroke="#777777" points="280.5,-313.35 168.5,-313.35 168.5,-289.35 280.5,-289.35 280.5,-313.35"/>
<text text-anchor="middle" x="224.5" y="-298.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mbe_total_hessian</text>
</g>
<!-- proc~global_coordinator&#45;&gt;mbe_total_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge10" class="edge">
<title>proc~global_coordinator&#45;&gt;mbe_total_hessian</title>
<path fill="none" stroke="#ff0000" d="M105.07,-331.32C124.08,-326.51 146.15,-320.92 166.05,-315.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.09,-319.24 175.92,-313.39 165.37,-312.45 167.09,-319.24"/>
</g>
<!-- proc~compute_mbe -->
<g id="proc~~global_coordinator~~CallsGraph_node12" class="node">
<title>proc~compute_mbe</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node12"><a xlink:href="../proc/compute_mbe.html" xlink:title="compute_mbe">
<polygon fill="#d9534f" stroke="#d9534f" points="269,-932.35 180,-932.35 180,-908.35 269,-908.35 269,-932.35"/>
<text text-anchor="middle" x="224.5" y="-917.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~global_coordinator~~CallsGraph_edge11" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M60.97,-355.4C81.72,-427.55 189.56,-802.39 217.1,-898.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.78,-899.24 219.91,-907.88 220.51,-897.3 213.78,-899.24"/>
</g>
<!-- proc~result_irecv -->
<g id="proc~~global_coordinator~~CallsGraph_node13" class="node">
<title>proc~result_irecv</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node13"><a xlink:href="../proc/result_irecv.html" xlink:title="result_irecv">
<polygon fill="#d9534f" stroke="#d9534f" points="261,-397.35 188,-397.35 188,-373.35 261,-373.35 261,-397.35"/>
<text text-anchor="middle" x="224.5" y="-382.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">result_irecv</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~result_irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge12" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~result_irecv</title>
<path fill="none" stroke="#ff0000" d="M105.07,-355.39C128.02,-361.19 155.42,-368.13 178.08,-373.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.25,-377.26 187.8,-376.32 178.96,-370.47 177.25,-377.26"/>
</g>
<!-- proc~send_fragment_to_node -->
<g id="proc~~global_coordinator~~CallsGraph_node14" class="node">
<title>proc~send_fragment_to_node</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node14"><a xlink:href="../proc/send_fragment_to_node.html" xlink:title="send_fragment_to_node">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-119.35 154,-119.35 154,-95.35 295,-95.35 295,-119.35"/>
<text text-anchor="middle" x="224.5" y="-104.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_node</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_node -->
<g id="proc~~global_coordinator~~CallsGraph_edge13" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_node</title>
<path fill="none" stroke="#ff0000" d="M59.33,-331.2C65.32,-295.57 87.62,-190.28 149,-133.35 152.86,-129.78 157.23,-126.69 161.88,-124.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="163.73,-127.01 171.1,-119.4 160.6,-120.75 163.73,-127.01"/>
</g>
<!-- proc~send_fragment_to_worker -->
<g id="proc~~global_coordinator~~CallsGraph_node15" class="node">
<title>proc~send_fragment_to_worker</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node15"><a xlink:href="../proc/send_fragment_to_worker.html" xlink:title="send_fragment_to_worker">
<polygon fill="#d9534f" stroke="#d9534f" points="300,-77.35 149,-77.35 149,-53.35 300,-53.35 300,-77.35"/>
<text text-anchor="middle" x="224.5" y="-62.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">send_fragment_to_worker</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker -->
<g id="proc~~global_coordinator~~CallsGraph_edge14" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~send_fragment_to_worker</title>
<path fill="none" stroke="#ff0000" d="M58.05,-331.32C60.57,-290.52 74.44,-156.05 149,-86.35 150.28,-85.15 151.63,-84.02 153.03,-82.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="155,-85.84 161.55,-77.51 151.24,-79.94 155,-85.84"/>
</g>
<!-- start -->
<g id="proc~~global_coordinator~~CallsGraph_node16" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="780,-294.35 726,-294.35 726,-270.35 780,-270.35 780,-294.35"/>
<text text-anchor="middle" x="753" y="-279.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~global_coordinator&#45;&gt;start -->
<g id="proc~~global_coordinator~~CallsGraph_edge15" class="edge">
<title>proc~global_coordinator&#45;&gt;start</title>
<path fill="none" stroke="#ff0000" d="M61.76,-331.23C71.93,-304.34 100.49,-240.08 149,-214.35 174.94,-200.6 554.94,-202.14 593,-210.35 641.32,-220.78 692.62,-247.15 723.48,-264.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="721.98,-268.09 732.38,-270.13 725.52,-262.05 721.98,-268.09"/>
</g>
<!-- to_char -->
<g id="proc~~global_coordinator~~CallsGraph_node17" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1617.5,-376.35 1563.5,-376.35 1563.5,-352.35 1617.5,-352.35 1617.5,-376.35"/>
<text text-anchor="middle" x="1590.5" y="-361.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~global_coordinator&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge16" class="edge">
<title>proc~global_coordinator&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M59.35,-331.25C67.46,-280 101.55,-81.72 149,-44.35 259.01,42.29 323.47,-25.35 463.5,-25.35 463.5,-25.35 463.5,-25.35 1025.5,-25.35 1224.13,-25.35 1275.71,-82.82 1438,-197.35 1497.89,-239.62 1551.23,-309.41 1575.55,-343.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1572.77,-345.98 1581.36,-352.18 1578.52,-341.97 1572.77,-345.98"/>
</g>
<!-- verbose -->
<g id="proc~~global_coordinator~~CallsGraph_node18" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="780.5,-1386.35 725.5,-1386.35 725.5,-1362.35 780.5,-1362.35 780.5,-1386.35"/>
<text text-anchor="middle" x="753" y="-1371.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~global_coordinator&#45;&gt;verbose -->
<g id="proc~~global_coordinator~~CallsGraph_edge17" class="edge">
<title>proc~global_coordinator&#45;&gt;verbose</title>
<path fill="none" stroke="#ff0000" d="M57.76,-355.54C59.44,-418.78 71.32,-715.39 149,-941.35 204.31,-1102.24 201.63,-1171.01 336,-1275.35 451.92,-1365.37 636.9,-1375.4 715.14,-1375.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="715.48,-1378.79 725.45,-1375.22 715.43,-1371.79 715.48,-1378.79"/>
</g>
<!-- proc~compute_mbe&#45;&gt;abort_comm -->
<g id="proc~~global_coordinator~~CallsGraph_edge18" class="edge">
<title>proc~compute_mbe&#45;&gt;abort_comm</title>
<path fill="none" stroke="#0078ff" d="M242.99,-908.22C264.07,-894.21 301.03,-871.53 336,-859.35 445.37,-821.27 497.76,-882.24 593,-816.35 619.2,-798.22 601.88,-771.08 629,-754.35 685.44,-719.53 881.57,-723.61 974.26,-727.7"/>
<polygon fill="#0078ff" stroke="#0078ff" points="974.35,-731.21 984.5,-728.17 974.67,-724.22 974.35,-731.21"/>
</g>
<!-- proc~compute_mbe&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge21" class="edge">
<title>proc~compute_mbe&#45;&gt;error</title>
<path fill="none" stroke="#0078ff" d="M226.55,-932.37C232.75,-1000.92 266.79,-1342.17 336,-1416.35 467.26,-1557.06 559.57,-1536.35 752,-1536.35 752,-1536.35 752,-1536.35 1025.5,-1536.35 1286.35,-1536.35 1515.43,-1251.97 1574.67,-1172.03"/>
<polygon fill="#0078ff" stroke="#0078ff" points="1577.66,-1173.86 1580.75,-1163.73 1572.02,-1169.72 1577.66,-1173.86"/>
</g>
<!-- proc~compute_mbe&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge25" class="edge">
<title>proc~compute_mbe&#45;&gt;info</title>
<path fill="none" stroke="#0078ff" d="M227.67,-908.23C235.07,-870.69 263.06,-755.79 336,-703.35 429.75,-635.95 497.2,-729.8 593,-665.35 619.12,-647.78 604.01,-623.5 629,-604.35 654.15,-585.08 689.59,-576.73 715.97,-573.12"/>
<polygon fill="#0078ff" stroke="#0078ff" points="716.44,-576.58 725.95,-571.91 715.6,-569.63 716.44,-576.58"/>
</g>
<!-- proc~compute_mbe&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge41" class="edge">
<title>proc~compute_mbe&#45;&gt;to_char</title>
<path fill="none" stroke="#0078ff" d="M227.28,-908.03C238.21,-832.92 297.2,-438.77 336,-402.35 420.19,-323.33 504,-437.91 593,-364.35 630.38,-333.46 589.46,-289.42 629,-261.35 931.87,-46.38 1429.52,-280.42 1558.3,-347.49"/>
<polygon fill="#0078ff" stroke="#0078ff" points="1556.79,-350.65 1567.27,-352.2 1560.04,-344.45 1556.79,-350.65"/>
</g>
<!-- cart_disp -->
<g id="proc~~global_coordinator~~CallsGraph_node19" class="node">
<title>cart_disp</title>
<polygon fill="#777777" stroke="#777777" points="495,-1266.35 434,-1266.35 434,-1242.35 495,-1242.35 495,-1266.35"/>
<text text-anchor="middle" x="464.5" y="-1251.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cart_disp</text>
</g>
<!-- proc~compute_mbe&#45;&gt;cart_disp -->
<g id="proc~~global_coordinator~~CallsGraph_edge19" class="edge">
<title>proc~compute_mbe&#45;&gt;cart_disp</title>
<path fill="none" stroke="#0078ff" d="M225.68,-932.67C227.11,-980.08 239.04,-1152.12 336,-1233.35 360.17,-1253.6 396.23,-1257.94 423.84,-1257.75"/>
<polygon fill="#0078ff" stroke="#0078ff" points="424.06,-1261.24 433.97,-1257.47 423.87,-1254.24 424.06,-1261.24"/>
</g>
<!-- configuration -->
<g id="proc~~global_coordinator~~CallsGraph_node20" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="1066.5,-540.35 982.5,-540.35 982.5,-516.35 1066.5,-516.35 1066.5,-540.35"/>
<text text-anchor="middle" x="1024.5" y="-525.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe&#45;&gt;configuration -->
<g id="proc~~global_coordinator~~CallsGraph_edge20" class="edge">
<title>proc~compute_mbe&#45;&gt;configuration</title>
<path fill="none" stroke="#0078ff" d="M230.86,-908.24C244.08,-879.96 281.2,-809.63 336,-778.35 436.02,-721.27 504.06,-818.51 593,-745.35 632.07,-713.21 590.84,-670.57 629,-637.35 713.56,-563.75 776.3,-640.62 877,-591.35 896.23,-581.94 894.21,-569.62 913,-559.35 931.31,-549.35 953.14,-542.34 972.54,-537.55"/>
<polygon fill="#0078ff" stroke="#0078ff" points="973.48,-540.92 982.43,-535.24 971.9,-534.11 973.48,-540.92"/>
</g>
<!-- fc_mdyne -->
<g id="proc~~global_coordinator~~CallsGraph_node21" class="node">
<title>fc_mdyne</title>
<polygon fill="#777777" stroke="#777777" points="496.5,-1182.35 432.5,-1182.35 432.5,-1158.35 496.5,-1158.35 496.5,-1182.35"/>
<text text-anchor="middle" x="464.5" y="-1167.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fc_mdyne</text>
</g>
<!-- proc~compute_mbe&#45;&gt;fc_mdyne -->
<g id="proc~~global_coordinator~~CallsGraph_edge22" class="edge">
<title>proc~compute_mbe&#45;&gt;fc_mdyne</title>
<path fill="none" stroke="#0078ff" d="M227.39,-932.52C234.09,-971.33 260.53,-1092.9 336,-1149.35 360.5,-1167.68 395.09,-1172.44 422.06,-1172.89"/>
<polygon fill="#0078ff" stroke="#0078ff" points="422.36,-1176.38 432.35,-1172.86 422.34,-1169.38 422.36,-1176.38"/>
</g>
<!-- force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_node22" class="node">
<title>force_constants</title>
<polygon fill="#777777" stroke="#777777" points="512.5,-1140.35 416.5,-1140.35 416.5,-1116.35 512.5,-1116.35 512.5,-1140.35"/>
<text text-anchor="middle" x="464.5" y="-1125.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">force_constants</text>
</g>
<!-- proc~compute_mbe&#45;&gt;force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_edge23" class="edge">
<title>proc~compute_mbe&#45;&gt;force_constants</title>
<path fill="none" stroke="#0078ff" d="M228.73,-932.45C238.47,-966.37 270.96,-1062.84 336,-1107.35 356.32,-1121.26 382.65,-1127.1 406.11,-1129.24"/>
<polygon fill="#0078ff" stroke="#0078ff" points="406.08,-1132.74 416.3,-1129.96 406.57,-1125.76 406.08,-1132.74"/>
</g>
<!-- frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_node23" class="node">
<title>frequencies</title>
<polygon fill="#777777" stroke="#777777" points="502,-1098.35 427,-1098.35 427,-1074.35 502,-1074.35 502,-1098.35"/>
<text text-anchor="middle" x="464.5" y="-1083.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">frequencies</text>
</g>
<!-- proc~compute_mbe&#45;&gt;frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_edge24" class="edge">
<title>proc~compute_mbe&#45;&gt;frequencies</title>
<path fill="none" stroke="#0078ff" d="M230.86,-932.59C244.09,-961.17 281.21,-1032.4 336,-1065.35 360.16,-1079.88 391.33,-1085.21 416.8,-1086.86"/>
<polygon fill="#0078ff" stroke="#0078ff" points="416.82,-1090.37 426.97,-1087.35 417.15,-1083.38 416.82,-1090.37"/>
</g>
<!-- proc~build_mbe_lookup_table -->
<g id="proc~~global_coordinator~~CallsGraph_node24" class="node">
<title>proc~build_mbe_lookup_table</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node24"><a xlink:href="../proc/build_mbe_lookup_table.html" xlink:title="build_mbe_lookup_table">
<polygon fill="#d9534f" stroke="#d9534f" points="535.5,-435.35 393.5,-435.35 393.5,-411.35 535.5,-411.35 535.5,-435.35"/>
<text text-anchor="middle" x="464.5" y="-420.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_mbe_lookup_table</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table -->
<g id="proc~~global_coordinator~~CallsGraph_edge26" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table</title>
<path fill="none" stroke="#0078ff" d="M225.54,-908.33C226.29,-854.97 235.61,-636.23 336,-501.35 357.44,-472.55 392.94,-452.1 421.05,-439.38"/>
<polygon fill="#0078ff" stroke="#0078ff" points="422.5,-442.57 430.27,-435.37 419.7,-436.15 422.5,-442.57"/>
</g>
<!-- proc~compute_mbe_delta -->
<g id="proc~~global_coordinator~~CallsGraph_node25" class="node">
<title>proc~compute_mbe_delta</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node25"><a xlink:href="../proc/compute_mbe_delta.html" xlink:title="compute_mbe_delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="525,-1056.35 404,-1056.35 404,-1032.35 525,-1032.35 525,-1056.35"/>
<text text-anchor="middle" x="464.5" y="-1041.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_delta</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_delta -->
<g id="proc~~global_coordinator~~CallsGraph_edge27" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_delta</title>
<path fill="none" stroke="#0078ff" d="M234.56,-932.63C251.66,-954.8 291.04,-1001.26 336,-1023.35 353.75,-1032.07 374.38,-1037.28 393.82,-1040.35"/>
<polygon fill="#0078ff" stroke="#0078ff" points="393.46,-1043.84 403.85,-1041.78 394.44,-1036.91 393.46,-1043.84"/>
</g>
<!-- proc~compute_mbe_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node26" class="node">
<title>proc~compute_mbe_gradient</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node26"><a xlink:href="../proc/compute_mbe_gradient.html" xlink:title="compute_mbe_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="534,-972.35 395,-972.35 395,-948.35 534,-948.35 534,-972.35"/>
<text text-anchor="middle" x="464.5" y="-957.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge28" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient</title>
<path fill="none" stroke="#0078ff" d="M269.15,-927.69C301.43,-933.11 346.27,-940.65 384.74,-947.12"/>
<polygon fill="#0078ff" stroke="#0078ff" points="384.45,-950.62 394.89,-948.82 385.61,-943.71 384.45,-950.62"/>
</g>
<!-- proc~compute_mbe_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node27" class="node">
<title>proc~compute_mbe_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node27"><a xlink:href="../proc/compute_mbe_hessian.html" xlink:title="compute_mbe_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="532,-1014.35 397,-1014.35 397,-990.35 532,-990.35 532,-1014.35"/>
<text text-anchor="middle" x="464.5" y="-999.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge29" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian</title>
<path fill="none" stroke="#0078ff" d="M242.99,-932.49C264.06,-946.52 301.01,-969.22 336,-981.35 352.12,-986.94 369.92,-991.07 386.98,-994.1"/>
<polygon fill="#0078ff" stroke="#0078ff" points="386.48,-997.56 396.92,-995.76 387.63,-990.66 386.48,-997.56"/>
</g>
<!-- proc~compute_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_node28" class="node">
<title>proc~compute_vibrational_analysis</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node28"><a xlink:href="../proc/compute_vibrational_analysis.html" xlink:title="compute_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="549.5,-1670.35 379.5,-1670.35 379.5,-1646.35 549.5,-1646.35 549.5,-1670.35"/>
<text text-anchor="middle" x="464.5" y="-1655.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_edge30" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis</title>
<path fill="none" stroke="#0078ff" d="M225.98,-932.54C229.41,-1014.57 252.61,-1486.09 336,-1597.35 352.37,-1619.19 378.59,-1633.57 403,-1642.85"/>
<polygon fill="#0078ff" stroke="#0078ff" points="402.01,-1646.21 412.6,-1646.28 404.36,-1639.62 402.01,-1646.21"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~global_coordinator~~CallsGraph_node29" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node29"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="532.5,-1588.35 396.5,-1588.35 396.5,-1564.35 532.5,-1564.35 532.5,-1588.35"/>
<text text-anchor="middle" x="464.5" y="-1573.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~energy_total -->
<g id="proc~~global_coordinator~~CallsGraph_edge31" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#0078ff" d="M225.83,-932.45C228.25,-1011.81 245.79,-1457.63 336,-1550.35 349.29,-1564.01 367.66,-1571.49 386.32,-1575.38"/>
<polygon fill="#0078ff" stroke="#0078ff" points="385.93,-1578.87 396.38,-1577.15 387.14,-1571.97 385.93,-1578.87"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node30" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node30"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="593,-736.35 336,-736.35 336,-712.35 593,-712.35 593,-736.35"/>
<text text-anchor="middle" x="464.5" y="-721.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge32" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#0078ff" d="M229.64,-908.1C241.04,-876.37 276.06,-791.16 336,-750.35 341.71,-746.47 347.87,-743.14 354.3,-740.29"/>
<polygon fill="#0078ff" stroke="#0078ff" points="355.9,-743.41 363.88,-736.45 353.3,-736.92 355.9,-743.41"/>
</g>
<!-- proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_node31" class="node">
<title>proc~map_fragment_to_system_gradient</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node31"><a xlink:href="../proc/map_fragment_to_system_gradient.html" xlink:title="map_fragment_to_system_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="853,-670.35 653,-670.35 653,-646.35 853,-646.35 853,-670.35"/>
<text text-anchor="middle" x="753" y="-655.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge33" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#0078ff" d="M235.7,-908.29C253.7,-887.87 293.26,-846.72 336,-826.35 440.89,-776.36 496.58,-843.2 593,-778.35 617.55,-761.84 607.14,-742.29 629,-722.35 652.1,-701.28 683.43,-685.11 708.69,-674.3"/>
<polygon fill="#0078ff" stroke="#0078ff" points="710.14,-677.48 718.04,-670.42 707.46,-671.02 710.14,-677.48"/>
</g>
<!-- proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node32" class="node">
<title>proc~map_fragment_to_system_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node32"><a xlink:href="../proc/map_fragment_to_system_hessian.html" xlink:title="map_fragment_to_system_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="851,-902.35 655,-902.35 655,-878.35 851,-878.35 851,-902.35"/>
<text text-anchor="middle" x="753" y="-887.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge34" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#0078ff" d="M269.07,-918.35C337.9,-915.12 475.98,-908.42 593,-901.35 609.74,-900.34 627.46,-899.19 644.77,-898.03"/>
<polygon fill="#0078ff" stroke="#0078ff" points="645.16,-901.51 654.9,-897.34 644.69,-894.52 645.16,-901.51"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_node33" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node33"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="539.5,-1407.35 389.5,-1407.35 389.5,-1383.35 539.5,-1383.35 539.5,-1407.35"/>
<text text-anchor="middle" x="464.5" y="-1392.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_edge35" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#0078ff" d="M227.02,-932.62C233.35,-980.11 260.89,-1155.21 336,-1275.35 362.72,-1318.1 408.33,-1355.82 437.14,-1377.09"/>
<polygon fill="#0078ff" stroke="#0078ff" points="435.35,-1380.12 445.5,-1383.15 439.46,-1374.45 435.35,-1380.12"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~global_coordinator~~CallsGraph_node34" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node34"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="553,-1224.35 376,-1224.35 376,-1200.35 553,-1200.35 553,-1224.35"/>
<text text-anchor="middle" x="464.5" y="-1209.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~global_coordinator~~CallsGraph_edge36" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#0078ff" d="M226.41,-932.52C230.34,-975.68 249.81,-1122.59 336,-1191.35 344.88,-1198.44 355.24,-1203.55 366.15,-1207.17"/>
<polygon fill="#0078ff" stroke="#0078ff" points="365.27,-1210.56 375.85,-1210 367.23,-1203.84 365.27,-1210.56"/>
</g>
<!-- proc~print_mbe_energy_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_node35" class="node">
<title>proc~print_mbe_energy_breakdown</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node35"><a xlink:href="../proc/print_mbe_energy_breakdown.html" xlink:title="print_mbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="551,-576.35 378,-576.35 378,-552.35 551,-552.35 551,-576.35"/>
<text text-anchor="middle" x="464.5" y="-561.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown -->
<g id="proc~~global_coordinator~~CallsGraph_edge37" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown</title>
<path fill="none" stroke="#0078ff" d="M226.73,-908.18C231.79,-864.15 254.72,-711.17 336,-623.35 354.94,-602.89 382.39,-588.94 406.98,-579.76"/>
<polygon fill="#0078ff" stroke="#0078ff" points="408.33,-582.99 416.59,-576.35 405.99,-576.39 408.33,-582.99"/>
</g>
<!-- proc~print_mbe_gradient_info -->
<g id="proc~~global_coordinator~~CallsGraph_node36" class="node">
<title>proc~print_mbe_gradient_info</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node36"><a xlink:href="../proc/print_mbe_gradient_info.html" xlink:title="print_mbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="535.5,-534.35 393.5,-534.35 393.5,-510.35 535.5,-510.35 535.5,-534.35"/>
<text text-anchor="middle" x="464.5" y="-519.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info -->
<g id="proc~~global_coordinator~~CallsGraph_edge38" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info</title>
<path fill="none" stroke="#0078ff" d="M227.32,-908.14C236.35,-849.14 278.28,-594.43 336,-543.35 349.06,-531.79 365.95,-525.32 383.13,-521.91"/>
<polygon fill="#0078ff" stroke="#0078ff" points="383.96,-525.32 393.26,-520.23 382.82,-518.41 383.96,-525.32"/>
</g>
<!-- proc~print_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_node37" class="node">
<title>proc~print_vibrational_analysis</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node37"><a xlink:href="../proc/print_vibrational_analysis.html" xlink:title="print_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="538.5,-892.35 390.5,-892.35 390.5,-868.35 538.5,-868.35 538.5,-892.35"/>
<text text-anchor="middle" x="464.5" y="-877.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~global_coordinator~~CallsGraph_edge39" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#0078ff" d="M269.15,-913.02C300.69,-907.72 344.22,-900.4 382.09,-894.03"/>
<polygon fill="#0078ff" stroke="#0078ff" points="382.81,-897.46 392.09,-892.35 381.65,-890.56 382.81,-897.46"/>
</g>
<!-- reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_node39" class="node">
<title>reduced_masses</title>
<polygon fill="#777777" stroke="#777777" points="515,-656.35 414,-656.35 414,-632.35 515,-632.35 515,-656.35"/>
<text text-anchor="middle" x="464.5" y="-641.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduced_masses</text>
</g>
<!-- proc~compute_mbe&#45;&gt;reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_edge40" class="edge">
<title>proc~compute_mbe&#45;&gt;reduced_masses</title>
<path fill="none" stroke="#0078ff" d="M226.98,-908.09C232.61,-867.18 256.53,-734.34 336,-670.35 354.93,-655.11 380.47,-648.09 403.71,-645.07"/>
<polygon fill="#0078ff" stroke="#0078ff" points="404.29,-648.53 413.85,-643.98 403.54,-641.57 404.29,-648.53"/>
</g>
<!-- proc~result_irecv&#45;&gt;irecv -->
<g id="proc~~global_coordinator~~CallsGraph_edge42" class="edge">
<title>proc~result_irecv&#45;&gt;irecv</title>
<path fill="none" stroke="#001dff" d="M261.13,-379.06C305.88,-371.17 382.25,-357.69 427.28,-349.74"/>
<polygon fill="#001dff" stroke="#001dff" points="427.96,-353.18 437.2,-347.99 426.75,-346.28 427.96,-353.18"/>
</g>
<!-- recv -->
<g id="proc~~global_coordinator~~CallsGraph_node38" class="node">
<title>recv</title>
<polygon fill="#777777" stroke="#777777" points="491.5,-313.35 437.5,-313.35 437.5,-289.35 491.5,-289.35 491.5,-313.35"/>
<text text-anchor="middle" x="464.5" y="-298.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">recv</text>
</g>
<!-- proc~result_irecv&#45;&gt;recv -->
<g id="proc~~global_coordinator~~CallsGraph_edge43" class="edge">
<title>proc~result_irecv&#45;&gt;recv</title>
<path fill="none" stroke="#001dff" d="M261.02,-379.8C274,-376.66 288.34,-371.8 300,-364.35 320.72,-351.12 314.58,-334.41 336,-322.35 363.96,-306.61 400.47,-301.91 427.25,-300.82"/>
<polygon fill="#001dff" stroke="#001dff" points="427.46,-304.31 437.36,-300.56 427.28,-297.31 427.46,-304.31"/>
</g>
<!-- proc~send_fragment_to_node&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge44" class="edge">
<title>proc~send_fragment_to_node&#45;&gt;isend</title>
<path fill="none" stroke="#3c00ff" d="M295.3,-107.35C338.56,-107.35 392.34,-107.35 427.27,-107.35"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="427.48,-110.85 437.48,-107.35 427.48,-103.85 427.48,-110.85"/>
</g>
<!-- proc~send_fragment_to_worker&#45;&gt;isend -->
<g id="proc~~global_coordinator~~CallsGraph_edge45" class="edge">
<title>proc~send_fragment_to_worker&#45;&gt;isend</title>
<path fill="none" stroke="#9500ff" d="M293.7,-77.39C337.33,-85.09 392.18,-94.77 427.54,-101.01"/>
<polygon fill="#9500ff" stroke="#9500ff" points="426.95,-104.46 437.41,-102.75 428.17,-97.56 426.95,-104.46"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge46" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;debug</title>
<path fill="none" stroke="#91ff00" d="M535.61,-426.49C655.55,-431.87 896.02,-442.64 987.26,-446.73"/>
<polygon fill="#91ff00" stroke="#91ff00" points="987.24,-450.23 997.38,-447.18 987.55,-443.24 987.24,-450.23"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time -->
<g id="proc~~global_coordinator~~CallsGraph_edge47" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#91ff00" d="M535.73,-418.21C555.35,-414.41 575.96,-408.02 593,-397.35 615.31,-383.39 606.74,-364.39 629,-350.35 647.09,-338.94 669.34,-332.46 689.93,-328.8"/>
<polygon fill="#91ff00" stroke="#91ff00" points="690.55,-332.25 699.88,-327.22 689.45,-325.33 690.55,-332.25"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;start -->
<g id="proc~~global_coordinator~~CallsGraph_edge50" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;start</title>
<path fill="none" stroke="#91ff00" d="M535.58,-421.62C555.99,-418.01 577.06,-410.86 593,-397.35 627.13,-368.43 594.41,-331.73 629,-303.35 653.1,-283.58 688.97,-279.4 715.76,-279.53"/>
<polygon fill="#91ff00" stroke="#91ff00" points="715.82,-283.03 725.9,-279.79 715.99,-276.04 715.82,-283.03"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge51" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;to_char</title>
<path fill="none" stroke="#91ff00" d="M535.51,-411.3C554.33,-407.46 574.58,-402.77 593,-397.35 609.47,-392.51 612.16,-386.68 629,-383.35 983.09,-313.29 1424.93,-348.11 1553.11,-360.55"/>
<polygon fill="#91ff00" stroke="#91ff00" points="1552.87,-364.04 1563.16,-361.54 1553.56,-357.08 1552.87,-364.04"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~global_coordinator~~CallsGraph_node52" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node52"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="870.5,-416.35 635.5,-416.35 635.5,-392.35 870.5,-392.35 870.5,-416.35"/>
<text text-anchor="middle" x="753" y="-401.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~global_coordinator~~CallsGraph_edge48" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#91ff00" d="M535.59,-418.7C562.6,-416.91 594.36,-414.81 625.1,-412.77"/>
<polygon fill="#91ff00" stroke="#91ff00" points="625.73,-416.23 635.48,-412.08 625.27,-409.25 625.73,-416.23"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~global_coordinator~~CallsGraph_node53" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node53"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="877,-944.35 629,-944.35 629,-920.35 877,-920.35 877,-944.35"/>
<text text-anchor="middle" x="753" y="-929.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~global_coordinator~~CallsGraph_edge49" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#91ff00" d="M502.43,-435.38C532.25,-447.17 572.5,-468.26 593,-501.35 641.17,-579.1 567.02,-844.1 629,-911.35 629.77,-912.19 630.56,-913 631.37,-913.79"/>
<polygon fill="#91ff00" stroke="#91ff00" points="629.2,-916.53 639.14,-920.21 633.66,-911.14 629.2,-916.53"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;abort_comm -->
<g id="proc~~global_coordinator~~CallsGraph_edge52" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;abort_comm</title>
<path fill="none" stroke="#48ff00" d="M525.03,-1048.1C548.91,-1046.46 574.98,-1040.21 593,-1023.35 644.32,-975.33 579.3,-919.06 629,-869.35 709.04,-789.31 785.54,-878.05 877,-811.35 902.13,-793.03 887.49,-769.14 913,-751.35 930.74,-738.98 953.82,-733.38 974.3,-731.01"/>
<polygon fill="#48ff00" stroke="#48ff00" points="974.78,-734.48 984.41,-730.07 974.13,-727.51 974.78,-734.48"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge53" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;error</title>
<path fill="none" stroke="#48ff00" d="M525.23,-1044.9C547.79,-1047.41 572.86,-1053.14 593,-1065.35 615.8,-1079.18 605.39,-1100.96 629,-1113.35 649.85,-1124.3 1380.99,-1145.49 1553.36,-1150.35"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1553.35,-1153.85 1563.44,-1150.63 1553.54,-1146.85 1553.35,-1153.85"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_node51" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node51"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="872,-986.35 634,-986.35 634,-962.35 872,-962.35 872,-986.35"/>
<text text-anchor="middle" x="753" y="-971.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge54" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#48ff00" d="M525.19,-1036.24C546.69,-1032.86 571.05,-1028.52 593,-1023.35 632.33,-1014.1 676.14,-1000.33 707.8,-989.74"/>
<polygon fill="#48ff00" stroke="#48ff00" points="709.28,-992.94 717.63,-986.43 707.04,-986.31 709.28,-992.94"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_node56" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node56"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="818,-1104.35 688,-1104.35 688,-1080.35 818,-1080.35 818,-1104.35"/>
<text text-anchor="middle" x="753" y="-1089.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge55" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#48ff00" d="M525.19,-1054.12C546.58,-1057.64 570.87,-1061.65 593,-1065.35 620.67,-1069.98 651.04,-1075.12 677.75,-1079.67"/>
<polygon fill="#48ff00" stroke="#48ff00" points="677.35,-1083.15 687.8,-1081.38 678.53,-1076.25 677.35,-1083.15"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;abort_comm -->
<g id="proc~~global_coordinator~~CallsGraph_edge56" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff00" d="M507.87,-948.3C534.75,-938.96 568.89,-923.78 593,-901.35 617.18,-878.86 603.28,-857.06 629,-836.35 731.62,-753.72 785,-782.58 913,-751.35 932.94,-746.49 955.13,-742.08 974.37,-738.57"/>
<polygon fill="#00ff00" stroke="#00ff00" points="975.2,-741.98 984.42,-736.77 973.96,-735.09 975.2,-741.98"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge57" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;error</title>
<path fill="none" stroke="#00ff00" d="M534.22,-968.99C553.42,-972.13 574.17,-976.2 593,-981.35 609.56,-985.88 612.44,-990.84 629,-995.35 810.07,-1044.68 1400.26,-1125.88 1553.09,-1146.48"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1552.95,-1150 1563.33,-1147.86 1553.89,-1143.06 1552.95,-1150"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~global_coordinator~~CallsGraph_edge60" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#00ff00" d="M515.86,-948.34C542.4,-939.53 573.43,-924.89 593,-901.35 634.35,-851.62 594.41,-815 629,-760.35 652.29,-723.55 693.28,-693.52 721.5,-675.8"/>
<polygon fill="#00ff00" stroke="#00ff00" points="723.47,-678.7 730.17,-670.49 719.81,-672.73 723.47,-678.7"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge58" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff00" d="M534.12,-963.71C561.09,-965.02 592.94,-966.58 623.85,-968.09"/>
<polygon fill="#00ff00" stroke="#00ff00" points="623.69,-971.59 633.85,-968.58 624.03,-964.59 623.69,-971.59"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge59" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff00" d="M534.14,-959.27C554.84,-962.02 576.43,-968.31 593,-981.35 625.24,-1006.72 597.34,-1040.26 629,-1066.35 642.73,-1077.67 660.18,-1084.41 677.6,-1088.35"/>
<polygon fill="#00ff00" stroke="#00ff00" points="677.33,-1091.86 687.82,-1090.36 678.68,-1084.99 677.33,-1091.86"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge63" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#00ff48" d="M532.26,-1002.86C553.31,-1000.15 575.59,-994.03 593,-981.35 621.28,-960.76 600.78,-932.03 629,-911.35 634.1,-907.61 639.64,-904.45 645.45,-901.79"/>
<polygon fill="#00ff48" stroke="#00ff48" points="646.83,-905.01 654.78,-898 644.2,-898.52 646.83,-905.01"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~global_coordinator~~CallsGraph_edge61" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff48" d="M532.31,-995.82C559.61,-993.15 592.16,-989.97 623.72,-986.89"/>
<polygon fill="#00ff48" stroke="#00ff48" points="624.31,-990.35 633.93,-985.89 623.63,-983.38 624.31,-990.35"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination -->
<g id="proc~~global_coordinator~~CallsGraph_edge62" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff48" d="M532.05,-1004.38C552.63,-1007.29 574.68,-1012.9 593,-1023.35 614.65,-1035.7 607.64,-1053.52 629,-1066.35 643.7,-1075.19 660.97,-1081.05 677.84,-1084.93"/>
<polygon fill="#00ff48" stroke="#00ff48" points="677.19,-1088.37 687.7,-1086.99 678.63,-1081.52 677.19,-1088.37"/>
</g>
<!-- proc~compute_cartesian_displacements -->
<g id="proc~~global_coordinator~~CallsGraph_node43" class="node">
<title>proc~compute_cartesian_displacements</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node43"><a xlink:href="../proc/compute_cartesian_displacements.html" xlink:title="compute_cartesian_displacements">
<polygon fill="#d9534f" stroke="#d9534f" points="1123,-1630.35 926,-1630.35 926,-1606.35 1123,-1606.35 1123,-1630.35"/>
<text text-anchor="middle" x="1024.5" y="-1615.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_cartesian_displacements</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements -->
<g id="proc~~global_coordinator~~CallsGraph_edge64" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements</title>
<path fill="none" stroke="#00ff91" d="M507.91,-1670.4C584.63,-1689.94 750.26,-1721.65 877,-1672.35 897.23,-1664.48 893.6,-1649.08 913,-1639.35 917.09,-1637.3 921.35,-1635.45 925.72,-1633.78"/>
<polygon fill="#00ff91" stroke="#00ff91" points="927.15,-1636.99 935.45,-1630.4 924.86,-1630.38 927.15,-1636.99"/>
</g>
<!-- proc~compute_force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_node44" class="node">
<title>proc~compute_force_constants</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node44"><a xlink:href="../proc/compute_force_constants.html" xlink:title="compute_force_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="827,-1630.35 679,-1630.35 679,-1606.35 827,-1606.35 827,-1630.35"/>
<text text-anchor="middle" x="753" y="-1615.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_force_constants</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants -->
<g id="proc~~global_coordinator~~CallsGraph_edge65" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants</title>
<path fill="none" stroke="#00ff91" d="M549.52,-1646.62C586.95,-1641.4 630.93,-1635.26 668.32,-1630.04"/>
<polygon fill="#00ff91" stroke="#00ff91" points="669.26,-1633.44 678.68,-1628.59 668.29,-1626.51 669.26,-1633.44"/>
</g>
<!-- proc~compute_reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_node45" class="node">
<title>proc~compute_reduced_masses</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node45"><a xlink:href="../proc/compute_reduced_masses.html" xlink:title="compute_reduced_masses">
<polygon fill="#d9534f" stroke="#d9534f" points="1101.5,-1588.35 947.5,-1588.35 947.5,-1564.35 1101.5,-1564.35 1101.5,-1588.35"/>
<text text-anchor="middle" x="1024.5" y="-1573.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_reduced_masses</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses -->
<g id="proc~~global_coordinator~~CallsGraph_edge66" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses</title>
<path fill="none" stroke="#00ff91" d="M549.69,-1662.21C653.03,-1665.63 821.41,-1666.49 877,-1639.35 899.09,-1628.57 891.73,-1609.67 913,-1597.35 920.61,-1592.94 928.97,-1589.44 937.57,-1586.65"/>
<polygon fill="#00ff91" stroke="#00ff91" points="938.73,-1589.96 947.35,-1583.8 936.77,-1583.23 938.73,-1589.96"/>
</g>
<!-- proc~compute_vibrational_frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_node46" class="node">
<title>proc~compute_vibrational_frequencies</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node46"><a xlink:href="../proc/compute_vibrational_frequencies.html" xlink:title="compute_vibrational_frequencies">
<polygon fill="#d9534f" stroke="#d9534f" points="848,-1748.35 658,-1748.35 658,-1724.35 848,-1724.35 848,-1748.35"/>
<text text-anchor="middle" x="753" y="-1733.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_frequencies</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies -->
<g id="proc~~global_coordinator~~CallsGraph_edge67" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies</title>
<path fill="none" stroke="#00ff91" d="M499.97,-1670.42C532.86,-1681.67 583.93,-1698.45 629,-1710.35 645.08,-1714.6 662.48,-1718.62 678.99,-1722.17"/>
<polygon fill="#00ff91" stroke="#00ff91" points="678.63,-1725.67 689.14,-1724.32 680.09,-1718.83 678.63,-1725.67"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~global_coordinator~~CallsGraph_node58" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node58"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="828.5,-1588.35 677.5,-1588.35 677.5,-1564.35 828.5,-1564.35 828.5,-1588.35"/>
<text text-anchor="middle" x="753" y="-1573.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~global_coordinator~~CallsGraph_edge68" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#00ffda" d="M532.67,-1576.35C572.86,-1576.35 624.31,-1576.35 667.28,-1576.35"/>
<polygon fill="#00ffda" stroke="#00ffda" points="667.44,-1579.85 677.44,-1576.35 667.44,-1572.85 667.44,-1579.85"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;abort_comm -->
<g id="proc~~global_coordinator~~CallsGraph_edge69" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#0091ff" d="M828.52,-670.37C844.76,-674.02 861.67,-678.62 877,-684.35 894.14,-690.76 895.93,-697.75 913,-704.35 932.57,-711.92 954.96,-717.69 974.46,-721.85"/>
<polygon fill="#0091ff" stroke="#0091ff" points="973.86,-725.3 984.36,-723.88 975.26,-718.44 973.86,-725.3"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;debug -->
<g id="proc~~global_coordinator~~CallsGraph_edge71" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;debug</title>
<path fill="none" stroke="#0091ff" d="M789.65,-646.3C816.71,-635.58 853.18,-617.52 877,-591.35 904.34,-561.32 885.53,-537.27 913,-507.35 933.29,-485.24 963.81,-469.83 987.64,-460.31"/>
<polygon fill="#0091ff" stroke="#0091ff" points="988.97,-463.55 997.06,-456.71 986.47,-457.01 988.97,-463.55"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge72" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;error</title>
<path fill="none" stroke="#0091ff" d="M853.29,-666.52C958.9,-676 1113.82,-692.51 1136,-709.35 1168.35,-733.91 1139.76,-768.65 1172,-793.35 1266.79,-866 1341.87,-760.49 1438,-831.35 1490.37,-869.96 1559.74,-1063.57 1582.17,-1129.4"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1578.95,-1130.81 1585.47,-1139.16 1585.58,-1128.57 1578.95,-1130.81"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;configuration -->
<g id="proc~~global_coordinator~~CallsGraph_edge70" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;configuration</title>
<path fill="none" stroke="#0091ff" d="M852.82,-646.33C861.51,-642.72 869.75,-638.14 877,-632.35 906.85,-608.54 883.43,-578.5 913,-554.35 929.59,-540.81 952,-534.08 972.3,-530.82"/>
<polygon fill="#0091ff" stroke="#0091ff" points="972.93,-534.26 982.37,-529.45 971.99,-527.33 972.93,-534.26"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_node42" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node42"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="1107.5,-864.35 941.5,-864.35 941.5,-840.35 1107.5,-840.35 1107.5,-864.35"/>
<text text-anchor="middle" x="1024.5" y="-849.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_edge73" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#0091ff" d="M766.44,-670.55C792.29,-695.51 854.31,-753.44 913,-793.35 936.92,-809.62 965.81,-824.91 988.05,-835.84"/>
<polygon fill="#0091ff" stroke="#0091ff" points="986.62,-839.04 997.14,-840.26 989.67,-832.74 986.62,-839.04"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~global_coordinator~~CallsGraph_node48" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node48"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1105,-662.35 944,-662.35 944,-638.35 1105,-638.35 1105,-662.35"/>
<text text-anchor="middle" x="1024.5" y="-647.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~global_coordinator~~CallsGraph_edge74" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#0091ff" d="M853.2,-655.41C879.57,-654.62 907.89,-653.78 933.72,-653.02"/>
<polygon fill="#0091ff" stroke="#0091ff" points="933.98,-656.51 943.87,-652.72 933.77,-649.51 933.98,-656.51"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_node49" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node49"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1374.5,-662.35 1235.5,-662.35 1235.5,-638.35 1374.5,-638.35 1374.5,-662.35"/>
<text text-anchor="middle" x="1305" y="-647.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge75" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#0091ff" d="M846.07,-646.27C856.94,-642.74 867.52,-638.19 877,-632.35 898.81,-618.92 889.92,-598.45 913,-587.35 1002.33,-544.42 1038.48,-569.67 1136,-587.35 1184.82,-596.2 1237.92,-618.43 1271.08,-633.96"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1269.76,-637.21 1280.3,-638.34 1272.77,-630.89 1269.76,-637.21"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node50" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node50"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1136,-784.35 913,-784.35 913,-760.35 1136,-760.35 1136,-784.35"/>
<text text-anchor="middle" x="1024.5" y="-769.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge76" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#0091ff" d="M770.22,-670.41C797.97,-690.42 857,-730.37 913,-751.35 919.33,-753.72 925.96,-755.84 932.71,-757.72"/>
<polygon fill="#0091ff" stroke="#0091ff" points="932.08,-761.17 942.64,-760.32 933.85,-754.4 932.08,-761.17"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~global_coordinator~~CallsGraph_node59" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node59"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="1101.5,-620.35 947.5,-620.35 947.5,-596.35 1101.5,-596.35 1101.5,-620.35"/>
<text text-anchor="middle" x="1024.5" y="-605.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~global_coordinator~~CallsGraph_edge77" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#0091ff" d="M818.89,-646.31C858.03,-639.05 908.04,-629.77 948.81,-622.21"/>
<polygon fill="#0091ff" stroke="#0091ff" points="949.51,-625.64 958.7,-620.37 948.23,-618.76 949.51,-625.64"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~global_coordinator~~CallsGraph_edge78" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#0048ff" d="M839.27,-878.33C868.5,-874.21 901.35,-869.58 931.12,-865.38"/>
<polygon fill="#0048ff" stroke="#0048ff" points="931.67,-868.83 941.08,-863.97 930.69,-861.9 931.67,-868.83"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge79" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#0048ff" d="M840.07,-878.32C852.84,-874.8 865.55,-870.24 877,-864.35 896.3,-854.42 895.29,-843.9 913,-831.35 936.45,-814.75 965.13,-799.57 987.39,-788.76"/>
<polygon fill="#0048ff" stroke="#0048ff" points="988.99,-791.88 996.51,-784.41 985.97,-785.56 988.99,-791.88"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node60" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node60"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="1096.5,-906.35 952.5,-906.35 952.5,-882.35 1096.5,-882.35 1096.5,-906.35"/>
<text text-anchor="middle" x="1024.5" y="-891.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge80" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#0048ff" d="M851.3,-891.8C880.97,-892.24 913.28,-892.72 941.81,-893.14"/>
<polygon fill="#0048ff" stroke="#0048ff" points="942.09,-896.64 952.14,-893.29 942.19,-889.64 942.09,-896.64"/>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~global_coordinator~~CallsGraph_edge84" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#0000ff" d="M539.65,-1389.92C595.99,-1385.79 671.06,-1380.28 715.2,-1377.05"/>
<polygon fill="#0000ff" stroke="#0000ff" points="715.48,-1380.54 725.19,-1376.32 714.96,-1373.56 715.48,-1380.54"/>
</g>
<!-- header -->
<g id="proc~~global_coordinator~~CallsGraph_node40" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="780,-1428.35 726,-1428.35 726,-1404.35 780,-1404.35 780,-1428.35"/>
<text text-anchor="middle" x="753" y="-1413.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~global_coordinator~~CallsGraph_edge81" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#0000ff" d="M539.65,-1400.79C596.17,-1404.93 671.56,-1410.46 715.64,-1413.69"/>
<polygon fill="#0000ff" stroke="#0000ff" points="715.65,-1417.2 725.88,-1414.44 716.16,-1410.22 715.65,-1417.2"/>
</g>
<!-- level_name -->
<g id="proc~~global_coordinator~~CallsGraph_node41" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="790,-1470.35 716,-1470.35 716,-1446.35 790,-1446.35 790,-1470.35"/>
<text text-anchor="middle" x="753" y="-1455.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge82" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#0000ff" d="M508.3,-1407.38C541.15,-1416.36 587.73,-1428.54 629,-1437.35 654.28,-1442.75 682.72,-1447.68 705.88,-1451.4"/>
<polygon fill="#0000ff" stroke="#0000ff" points="705.37,-1454.86 715.79,-1452.97 706.46,-1447.95 705.37,-1454.86"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_node55" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node55"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="815,-1344.35 691,-1344.35 691,-1320.35 815,-1320.35 815,-1344.35"/>
<text text-anchor="middle" x="753" y="-1329.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge83" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#0000ff" d="M508.3,-1383.33C541.15,-1374.35 587.73,-1362.16 629,-1353.35 645.74,-1349.78 663.86,-1346.41 680.91,-1343.46"/>
<polygon fill="#0000ff" stroke="#0000ff" points="681.54,-1346.91 690.81,-1341.78 680.37,-1340.01 681.54,-1346.91"/>
</g>
<!-- warning -->
<g id="proc~~global_coordinator~~CallsGraph_node61" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="1052,-1406.35 997,-1406.35 997,-1382.35 1052,-1382.35 1052,-1406.35"/>
<text text-anchor="middle" x="1024.5" y="-1391.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge85" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#0000ff" d="M482.55,-1407.63C511.14,-1427.38 571.31,-1465.4 629,-1479.35 736.13,-1505.26 770.56,-1507.99 877,-1479.35 924.91,-1466.46 973.31,-1433.63 1000.74,-1412.75"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1003.13,-1415.33 1008.88,-1406.43 998.84,-1409.8 1003.13,-1415.33"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge86" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#4800ff" d="M539.79,-1200.3C567.7,-1196.19 599.74,-1191.98 629,-1189.35 988.35,-1157.05 1425.79,-1152.21 1553.13,-1151.48"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1553.48,-1154.98 1563.46,-1151.43 1553.44,-1147.98 1553.48,-1154.98"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge87" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#4800ff" d="M553.24,-1213.55C568.35,-1209.73 582.53,-1202.91 593,-1191.35 675.84,-1099.93 562.59,-741.32 629,-637.35 648.61,-606.65 687.4,-588.93 716.2,-579.52"/>
<polygon fill="#4800ff" stroke="#4800ff" points="717.4,-582.82 725.93,-576.53 715.34,-576.13 717.4,-582.82"/>
</g>
<!-- proc~get_basename -->
<g id="proc~~global_coordinator~~CallsGraph_node54" class="node">
<title>proc~get_basename</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node54"><a xlink:href="../proc/get_basename.html" xlink:title="get_basename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="798.5,-1264.35 707.5,-1264.35 707.5,-1240.35 798.5,-1240.35 798.5,-1264.35"/>
<text text-anchor="middle" x="753" y="-1249.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_basename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename -->
<g id="proc~~global_coordinator~~CallsGraph_edge88" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#4800ff" d="M551.46,-1224.35C598.72,-1230.95 655.93,-1238.94 697.13,-1244.69"/>
<polygon fill="#4800ff" stroke="#4800ff" points="696.86,-1248.19 707.25,-1246.1 697.83,-1241.25 696.86,-1248.19"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~global_coordinator~~CallsGraph_edge89" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#4800ff" d="M553.28,-1215.56C567.52,-1219.13 581.38,-1224.73 593,-1233.35 622.06,-1254.9 600.43,-1284.16 629,-1306.35 643.83,-1317.87 662.58,-1324.59 680.95,-1328.42"/>
<polygon fill="#4800ff" stroke="#4800ff" points="680.32,-1331.87 690.79,-1330.22 681.58,-1324.98 680.32,-1331.87"/>
</g>
<!-- proc~get_output_json_filename -->
<g id="proc~~global_coordinator~~CallsGraph_node57" class="node">
<title>proc~get_output_json_filename</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node57"><a xlink:href="../proc/get_output_json_filename.html" xlink:title="get_output_json_filename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="827.5,-1222.35 678.5,-1222.35 678.5,-1198.35 827.5,-1198.35 827.5,-1222.35"/>
<text text-anchor="middle" x="753" y="-1207.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_output_json_filename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~global_coordinator~~CallsGraph_edge90" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#4800ff" d="M553.02,-1211.74C589.57,-1211.49 631.85,-1211.19 668.02,-1210.94"/>
<polygon fill="#4800ff" stroke="#4800ff" points="668.08,-1214.44 678.05,-1210.87 668.03,-1207.44 668.08,-1214.44"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge91" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#4800ff" d="M553.16,-1218.75C567.03,-1222 580.8,-1226.68 593,-1233.35 613.98,-1244.83 607.95,-1261.99 629,-1273.35 727.12,-1326.32 771.64,-1274.82 877,-1311.35 922.61,-1327.17 970.33,-1357.11 998.47,-1376.38"/>
<polygon fill="#4800ff" stroke="#4800ff" points="996.68,-1379.4 1006.89,-1382.23 1000.67,-1373.65 996.68,-1379.4"/>
</g>
<!-- proc~print_mbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge92" class="edge">
<title>proc~print_mbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#9100ff" d="M551.07,-566.14C605.98,-567.29 674.46,-568.73 715.63,-569.59"/>
<polygon fill="#9100ff" stroke="#9100ff" points="715.67,-573.09 725.74,-569.8 715.81,-566.09 715.67,-573.09"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge93" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#da00ff" d="M535.66,-533.84C554.3,-536.91 574.41,-540.24 593,-543.35 635.24,-550.42 683.76,-558.68 715.98,-564.18"/>
<polygon fill="#da00ff" stroke="#da00ff" points="715.39,-567.63 725.84,-565.87 716.57,-560.73 715.39,-567.63"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge94" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#da00ff" d="M535.88,-520.23C658.45,-515.77 918.76,-502.9 1136,-469.35 1293.14,-445.09 1476.6,-396.1 1553.12,-374.72"/>
<polygon fill="#da00ff" stroke="#da00ff" points="1554.51,-377.97 1563.19,-371.9 1552.61,-371.23 1554.51,-377.97"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;info -->
<g id="proc~~global_coordinator~~CallsGraph_edge95" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;info</title>
<path fill="none" stroke="#ff00da" d="M480.7,-868.19C507.13,-846.3 561.71,-797.63 593,-745.35 618.98,-701.94 596.53,-676.15 629,-637.35 651.87,-610.03 688.84,-592.04 716.29,-581.64"/>
<polygon fill="#ff00da" stroke="#ff00da" points="717.72,-584.85 725.93,-578.16 715.34,-578.27 717.72,-584.85"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_node47" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node47"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1672,-745.35 1509,-745.35 1509,-721.35 1672,-721.35 1672,-745.35"/>
<text text-anchor="middle" x="1590.5" y="-730.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_edge96" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#ff00da" d="M538.62,-872.29C707.04,-853.52 1109.91,-807.46 1136,-793.35 1157.63,-781.66 1149.89,-762.1 1172,-751.35 1227.41,-724.41 1393.07,-725.29 1498.29,-728.94"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1498.48,-732.45 1508.6,-729.31 1498.73,-725.45 1498.48,-732.45"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge97" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;warning</title>
<path fill="none" stroke="#ff00da" d="M505.91,-892.42C532.8,-901.94 567.71,-917.33 593,-939.35 615.31,-958.78 605.42,-977.48 629,-995.35 720.88,-1064.97 790.42,-995.24 877,-1071.35 972.58,-1155.38 1009.32,-1314.26 1019.92,-1372.36"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1016.49,-1373.04 1021.66,-1382.29 1023.39,-1371.84 1016.49,-1373.04"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge103" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#ff8b00" d="M1064.33,-840.32C1088.18,-831.05 1117.59,-815.94 1136,-793.35 1171.71,-749.52 1129.53,-708.66 1172,-671.35 1186.7,-658.44 1206.03,-651.76 1225.35,-648.6"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1225.98,-652.04 1235.43,-647.25 1225.05,-645.11 1225.98,-652.04"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_node64" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node64"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1364,-1032.35 1246,-1032.35 1246,-1008.35 1364,-1008.35 1364,-1032.35"/>
<text text-anchor="middle" x="1305" y="-1017.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_edge98" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#ff8b00" d="M1107.67,-857.27C1118.1,-860.82 1127.93,-865.98 1136,-873.35 1179,-912.63 1128.41,-960.72 1172,-999.35 1189.24,-1014.63 1212.97,-1021.22 1235.55,-1023.56"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1235.58,-1027.07 1245.82,-1024.35 1236.12,-1020.09 1235.58,-1027.07"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~global_coordinator~~CallsGraph_node67" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node67"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1389.5,-864.35 1220.5,-864.35 1220.5,-840.35 1389.5,-840.35 1389.5,-864.35"/>
<text text-anchor="middle" x="1305" y="-849.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~global_coordinator~~CallsGraph_edge99" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#ff8b00" d="M1107.55,-852.35C1139.69,-852.35 1176.74,-852.35 1209.95,-852.35"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1210.12,-855.85 1220.12,-852.35 1210.12,-848.85 1210.12,-855.85"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~global_coordinator~~CallsGraph_node68" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node68"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="1373.5,-784.35 1236.5,-784.35 1236.5,-760.35 1373.5,-760.35 1373.5,-784.35"/>
<text text-anchor="middle" x="1305" y="-769.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~global_coordinator~~CallsGraph_edge100" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#ff8b00" d="M1080.52,-840.32C1098.3,-836.19 1118.06,-831.34 1136,-826.35 1178.31,-814.59 1225.92,-799.07 1259.62,-787.69"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1260.83,-790.97 1269.17,-784.45 1258.58,-784.34 1260.83,-790.97"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_node69" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node69"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1369,-990.35 1241,-990.35 1241,-966.35 1369,-966.35 1369,-990.35"/>
<text text-anchor="middle" x="1305" y="-975.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~global_coordinator~~CallsGraph_edge101" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#ff8b00" d="M1107.69,-858.51C1117.93,-861.91 1127.7,-866.69 1136,-873.35 1167.66,-898.79 1139.96,-932.39 1172,-957.35 1188.6,-970.28 1209.99,-976.69 1230.71,-979.57"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1230.47,-983.06 1240.8,-980.71 1231.26,-976.11 1230.47,-983.06"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~global_coordinator~~CallsGraph_node71" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node71"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="1382,-948.35 1228,-948.35 1228,-924.35 1382,-924.35 1382,-948.35"/>
<text text-anchor="middle" x="1305" y="-933.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~global_coordinator~~CallsGraph_edge102" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#ff8b00" d="M1107.72,-861.5C1117.62,-864.45 1127.3,-868.31 1136,-873.35 1157.27,-885.67 1150.54,-903.35 1172,-915.35 1185.92,-923.14 1201.88,-928.26 1217.78,-931.58"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1217.19,-935.03 1227.66,-933.42 1218.47,-928.15 1217.19,-935.03"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~global_coordinator~~CallsGraph_node72" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node72"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="1438,-906.35 1172,-906.35 1172,-882.35 1438,-882.35 1438,-906.35"/>
<text text-anchor="middle" x="1305" y="-891.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~global_coordinator~~CallsGraph_edge104" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#ff8b00" d="M1105.31,-864.39C1139.25,-869.51 1178.99,-875.5 1213.97,-880.78"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1213.77,-884.28 1224.18,-882.31 1214.82,-877.36 1213.77,-884.28"/>
</g>
<!-- proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_node70" class="node">
<title>proc~element_mass</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node70"><a xlink:href="../proc/element_mass.html" xlink:title="element_mass">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1350,-1651.35 1260,-1651.35 1260,-1627.35 1350,-1627.35 1350,-1651.35"/>
<text text-anchor="middle" x="1305" y="-1636.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_mass</text>
</a>
</g>
</g>
<!-- proc~compute_cartesian_displacements&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge105" class="edge">
<title>proc~compute_cartesian_displacements&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ffd000" d="M1123.3,-1625.73C1165.66,-1628.92 1213.66,-1632.54 1249.54,-1635.25"/>
<polygon fill="#ffd000" stroke="#ffd000" points="1249.56,-1638.76 1259.79,-1636.02 1250.08,-1631.78 1249.56,-1638.76"/>
</g>
<!-- proc~compute_reduced_masses&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge106" class="edge">
<title>proc~compute_reduced_masses&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#a2ff00" d="M1092.24,-1588.4C1106.7,-1591.19 1121.89,-1594.25 1136,-1597.35 1174.32,-1605.78 1217.23,-1616.53 1250.09,-1625.04"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="1249.39,-1628.48 1259.95,-1627.61 1251.15,-1621.7 1249.39,-1628.48"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge107" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;error</title>
<path fill="none" stroke="#5cff00" d="M848.32,-1740.75C1025.15,-1748.1 1392.8,-1758.83 1438,-1723.35 1528.17,-1652.58 1576.26,-1270.52 1587.11,-1173.68"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1590.61,-1173.87 1588.23,-1163.55 1583.65,-1173.11 1590.61,-1173.87"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;warning -->
<g id="proc~~global_coordinator~~CallsGraph_edge111" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;warning</title>
<path fill="none" stroke="#5cff00" d="M775.38,-1724.15C802.27,-1707.86 848.38,-1676.69 877,-1639.35 901.71,-1607.11 893.41,-1590.93 913,-1555.35 942.31,-1502.1 984.77,-1444.46 1007.58,-1414.71"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1010.39,-1416.8 1013.73,-1406.74 1004.85,-1412.52 1010.39,-1416.8"/>
</g>
<!-- pic_syev -->
<g id="proc~~global_coordinator~~CallsGraph_node63" class="node">
<title>pic_syev</title>
<polygon fill="#777777" stroke="#777777" points="1053.5,-1794.35 995.5,-1794.35 995.5,-1770.35 1053.5,-1770.35 1053.5,-1794.35"/>
<text text-anchor="middle" x="1024.5" y="-1779.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_syev</text>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;pic_syev -->
<g id="proc~~global_coordinator~~CallsGraph_edge108" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;pic_syev</title>
<path fill="none" stroke="#5cff00" d="M824.46,-1748.38C875.93,-1757.16 943.74,-1768.74 985.45,-1775.86"/>
<polygon fill="#5cff00" stroke="#5cff00" points="985.02,-1779.33 995.46,-1777.57 986.2,-1772.43 985.02,-1779.33"/>
</g>
<!-- proc~mass_weight_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_node73" class="node">
<title>proc~mass_weight_hessian</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node73"><a xlink:href="../proc/mass_weight_hessian.html" xlink:title="mass_weight_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="1088,-1672.35 961,-1672.35 961,-1648.35 1088,-1648.35 1088,-1672.35"/>
<text text-anchor="middle" x="1024.5" y="-1657.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mass_weight_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian -->
<g id="proc~~global_coordinator~~CallsGraph_edge109" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian</title>
<path fill="none" stroke="#5cff00" d="M837.46,-1724.27C851.04,-1720.75 864.68,-1716.2 877,-1710.35 895.56,-1701.54 894.35,-1689.97 913,-1681.35 924.79,-1675.9 937.92,-1671.86 950.89,-1668.88"/>
<polygon fill="#5cff00" stroke="#5cff00" points="951.7,-1672.28 960.76,-1666.79 950.25,-1665.43 951.7,-1672.28"/>
</g>
<!-- proc~project_translation_rotation -->
<g id="proc~~global_coordinator~~CallsGraph_node75" class="node">
<title>proc~project_translation_rotation</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node75"><a xlink:href="../proc/project_translation_rotation.html" xlink:title="project_translation_rotation">
<polygon fill="#d9534f" stroke="#d9534f" points="1103.5,-1714.35 945.5,-1714.35 945.5,-1690.35 1103.5,-1690.35 1103.5,-1714.35"/>
<text text-anchor="middle" x="1024.5" y="-1699.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">project_translation_rotation</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation -->
<g id="proc~~global_coordinator~~CallsGraph_edge110" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation</title>
<path fill="none" stroke="#5cff00" d="M848.26,-1724.46C876.51,-1720.9 907.38,-1717 935.24,-1713.49"/>
<polygon fill="#5cff00" stroke="#5cff00" points="935.87,-1716.94 945.35,-1712.21 934.99,-1709.99 935.87,-1716.94"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~global_coordinator~~CallsGraph_edge112" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#00ff2e" d="M1105.31,-650.35C1142.77,-650.35 1187.3,-650.35 1224.7,-650.35"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1225.05,-653.85 1235.05,-650.35 1225.05,-646.85 1225.05,-653.85"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node66" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node66"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1419.5,-704.35 1190.5,-704.35 1190.5,-680.35 1419.5,-680.35 1419.5,-704.35"/>
<text text-anchor="middle" x="1305" y="-689.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge113" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#00ffb9" d="M1113.55,-760.3C1121.33,-757.85 1128.93,-754.9 1136,-751.35 1155.4,-741.62 1152.63,-728.15 1172,-718.35 1180.75,-713.93 1190.19,-710.25 1199.85,-707.2"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1200.95,-710.53 1209.56,-704.36 1198.98,-703.81 1200.95,-710.53"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_node62" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="1064,-990.35 985,-990.35 985,-966.35 1064,-966.35 1064,-990.35"/>
<text text-anchor="middle" x="1024.5" y="-975.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_edge114" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ffff" d="M872.21,-976.11C908.23,-976.64 945.86,-977.2 974.57,-977.63"/>
<polygon fill="#00ffff" stroke="#00ffff" points="974.68,-981.13 984.73,-977.78 974.79,-974.13 974.68,-981.13"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~global_coordinator~~CallsGraph_node65" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node65"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1088.5,-1032.35 960.5,-1032.35 960.5,-1008.35 1088.5,-1008.35 1088.5,-1032.35"/>
<text text-anchor="middle" x="1024.5" y="-1017.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~global_coordinator~~CallsGraph_edge115" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#00ffff" d="M824.46,-986.38C863.11,-992.98 910.98,-1001.15 950.09,-1007.82"/>
<polygon fill="#00ffff" stroke="#00ffff" points="949.91,-1011.34 960.36,-1009.57 951.09,-1004.44 949.91,-1011.34"/>
</g>
<!-- sort -->
<g id="proc~~global_coordinator~~CallsGraph_node76" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="1051.5,-948.35 997.5,-948.35 997.5,-924.35 1051.5,-924.35 1051.5,-948.35"/>
<text text-anchor="middle" x="1024.5" y="-933.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~global_coordinator~~CallsGraph_edge116" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#00ffff" d="M839.27,-962.33C889.17,-955.29 949.58,-946.77 987.29,-941.46"/>
<polygon fill="#00ffff" stroke="#00ffff" points="987.88,-944.91 997.29,-940.05 986.9,-937.98 987.88,-944.91"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~global_coordinator~~CallsGraph_node74" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node74"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1083.5,-416.35 965.5,-416.35 965.5,-392.35 1083.5,-392.35 1083.5,-416.35"/>
<text text-anchor="middle" x="1024.5" y="-401.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~global_coordinator~~CallsGraph_edge117" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#00b9ff" d="M870.64,-404.35C899.4,-404.35 929.27,-404.35 954.9,-404.35"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="955.24,-407.85 965.24,-404.35 955.24,-400.85 955.24,-407.85"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~global_coordinator~~CallsGraph_edge118" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#0073ff" d="M824.46,-944.38C871.71,-952.44 932.75,-962.86 974.71,-970.02"/>
<polygon fill="#0073ff" stroke="#0073ff" points="974.23,-973.49 984.68,-971.73 975.41,-966.59 974.23,-973.49"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~global_coordinator~~CallsGraph_edge119" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#0073ff" d="M877.31,-934.18C917.26,-934.78 958.55,-935.39 987.02,-935.81"/>
<polygon fill="#0073ff" stroke="#0073ff" points="987.22,-939.31 997.27,-935.96 987.32,-932.31 987.22,-939.31"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_node78" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node78"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1707,-703.35 1474,-703.35 1474,-679.35 1707,-679.35 1707,-703.35"/>
<text text-anchor="middle" x="1590.5" y="-688.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~global_coordinator~~CallsGraph_edge120" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#65ff00" d="M1419.68,-691.95C1434.2,-691.9 1449.12,-691.85 1463.82,-691.8"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1463.96,-695.3 1473.95,-691.76 1463.93,-688.3 1463.96,-695.3"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~global_coordinator~~CallsGraph_node80" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node80"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1630,-864.35 1551,-864.35 1551,-840.35 1630,-840.35 1630,-864.35"/>
<text text-anchor="middle" x="1590.5" y="-849.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~global_coordinator~~CallsGraph_edge121" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#00ff00" d="M1389.53,-852.35C1438.76,-852.35 1499.34,-852.35 1540.84,-852.35"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1540.96,-855.85 1550.96,-852.35 1540.96,-848.85 1540.96,-855.85"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~global_coordinator~~CallsGraph_edge122" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#00ff66" d="M1373.76,-773.29C1396.2,-776.63 1420.02,-783.81 1438,-798.35 1445.03,-804.03 1548.81,-1053.27 1580.43,-1129.46"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1577.33,-1131.12 1584.39,-1139.02 1583.79,-1128.44 1577.33,-1131.12"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~global_coordinator~~CallsGraph_edge125" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#00ff66" d="M1354.09,-760.3C1381.63,-751.29 1415.14,-736.46 1438,-713.35 1487.5,-663.32 1559.57,-454.75 1582.33,-386.25"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1585.74,-387.1 1585.55,-376.51 1579.09,-384.91 1585.74,-387.1"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~global_coordinator~~CallsGraph_edge123" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#00ff66" d="M1373.55,-763.06C1411.07,-757.9 1458.25,-751.41 1498.94,-745.81"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1499.43,-749.28 1508.86,-744.45 1498.48,-742.34 1499.43,-749.28"/>
</g>
<!-- proc~error_set -->
<g id="proc~~global_coordinator~~CallsGraph_node79" class="node">
<title>proc~error_set</title>
<g id="a_proc~~global_coordinator~~CallsGraph_node79"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1643,-787.35 1538,-787.35 1538,-763.35 1643,-763.35 1643,-787.35"/>
<text text-anchor="middle" x="1590.5" y="-772.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~global_coordinator~~CallsGraph_edge124" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#00ff66" d="M1373.55,-773.07C1420.44,-773.56 1482.43,-774.22 1527.96,-774.7"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1527.96,-778.2 1537.99,-774.81 1528.03,-771.2 1527.96,-778.2"/>
</g>
<!-- proc~mass_weight_hessian&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge126" class="edge">
<title>proc~mass_weight_hessian&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#6500ff" d="M1088,-1655.64C1136.61,-1651.97 1203.35,-1646.94 1249.74,-1643.44"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1250.18,-1646.92 1259.89,-1642.68 1249.66,-1639.94 1250.18,-1646.92"/>
</g>
<!-- proc~project_translation_rotation&#45;&gt;proc~element_mass -->
<g id="proc~~global_coordinator~~CallsGraph_edge128" class="edge">
<title>proc~project_translation_rotation&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ff00cb" d="M1092.24,-1690.31C1106.7,-1687.52 1121.89,-1684.45 1136,-1681.35 1174.32,-1672.93 1217.23,-1662.18 1250.09,-1653.66"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1251.15,-1657 1259.95,-1651.1 1249.39,-1650.23 1251.15,-1657"/>
</g>
<!-- pic_gesvd -->
<g id="proc~~global_coordinator~~CallsGraph_node77" class="node">
<title>pic_gesvd</title>
<polygon fill="#777777" stroke="#777777" points="1337.5,-1714.35 1272.5,-1714.35 1272.5,-1690.35 1337.5,-1690.35 1337.5,-1714.35"/>
<text text-anchor="middle" x="1305" y="-1699.95" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_gesvd</text>
</g>
<!-- proc~project_translation_rotation&#45;&gt;pic_gesvd -->
<g id="proc~~global_coordinator~~CallsGraph_edge127" class="edge">
<title>proc~project_translation_rotation&#45;&gt;pic_gesvd</title>
<path fill="none" stroke="#ff00cb" d="M1103.82,-1702.35C1155.28,-1702.35 1220.58,-1702.35 1262.34,-1702.35"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1262.42,-1705.85 1272.42,-1702.35 1262.42,-1698.85 1262.42,-1705.85"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocglobal_coordinatorCallsGraph = svgPanZoom('#procglobal_coordinatorCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~global_coordinator~~CalledByGraph Pages: 1 -->
<svg id="procglobal_coordinatorCalledByGraph" width="641pt" height="79pt"
 viewBox="0.00 0.00 641.00 78.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~global_coordinator~~CalledByGraph" class="graph" transform="scale(0.7 0.7) rotate(0) translate(4 108)">
<title>proc~~global_coordinator~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-108 908,-108 908,4 -4,4"/>
<!-- proc~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_node1" class="node">
<title>proc~global_coordinator</title>
<polygon fill="none" stroke="black" points="904,-64 791,-64 791,-40 904,-40 904,-64"/>
<text text-anchor="middle" x="847.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50">global_coordinator</text>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_node2" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node2"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="755,-64 642,-64 642,-40 755,-40 755,-64"/>
<text text-anchor="middle" x="698.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_edge1" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.07,-52C763.49,-52 772.24,-52 780.84,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="780.85,-55.5 790.85,-52 780.85,-48.5 780.85,-55.5"/>
</g>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_node3" class="node">
<title>proc~run_fragmented_calculation</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node3"><a xlink:href="../proc/run_fragmented_calculation.html" xlink:title="run_fragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="606,-64 443,-64 443,-40 606,-40 606,-64"/>
<text text-anchor="middle" x="524.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_fragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator -->
<g id="proc~~global_coordinator~~CalledByGraph_edge2" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M606.21,-52C614.78,-52 623.41,-52 631.77,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="631.81,-55.5 641.81,-52 631.81,-48.5 631.81,-55.5"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_node4" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node4"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="407,-64 313,-64 313,-40 407,-40 407,-64"/>
<text text-anchor="middle" x="360" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge3" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M407.13,-52C415.24,-52 423.94,-52 432.78,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="432.8,-55.5 442.8,-52 432.8,-48.5 432.8,-55.5"/>
</g>
<!-- proc~compute_energy_and_forces -->
<g id="proc~~global_coordinator~~CalledByGraph_node5" class="node">
<title>proc~compute_energy_and_forces</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node5"><a xlink:href="../proc/compute_energy_and_forces.html" xlink:title="compute_energy_and_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="266.5,-104 100.5,-104 100.5,-80 266.5,-80 266.5,-104"/>
<text text-anchor="middle" x="183.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energy_and_forces</text>
</a>
</g>
</g>
<!-- proc~compute_energy_and_forces&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge4" class="edge">
<title>proc~compute_energy_and_forces&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M236.86,-80C257.74,-75.21 281.82,-69.69 303.05,-64.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="303.94,-68.21 312.9,-62.57 302.37,-61.39 303.94,-68.21"/>
</g>
<!-- proc~run_multi_molecule_calculations -->
<g id="proc~~global_coordinator~~CalledByGraph_node6" class="node">
<title>proc~run_multi_molecule_calculations</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node6"><a xlink:href="../proc/run_multi_molecule_calculations.html" xlink:title="run_multi_molecule_calculations">
<polygon fill="#d9534f" stroke="#d9534f" points="277,-24 90,-24 90,0 277,0 277,-24"/>
<text text-anchor="middle" x="183.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_multi_molecule_calculations</text>
</a>
</g>
</g>
<!-- proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge5" class="edge">
<title>proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M236.86,-24C257.74,-28.79 281.82,-34.31 303.05,-39.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.37,-42.61 312.9,-41.43 303.94,-35.79 302.37,-42.61"/>
</g>
<!-- program~main -->
<g id="proc~~global_coordinator~~CalledByGraph_node7" class="node">
<title>program~main</title>
<g id="a_proc~~global_coordinator~~CalledByGraph_node7"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-44 0,-44 0,-20 54,-20 54,-44"/>
<text text-anchor="middle" x="27" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~global_coordinator~~CalledByGraph_edge6" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M54.25,-33.59C107.66,-36.81 230.05,-44.21 302.43,-48.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.54,-52.09 312.73,-49.2 302.96,-45.11 302.54,-52.09"/>
</g>
<!-- program~main&#45;&gt;proc~run_multi_molecule_calculations -->
<g id="proc~~global_coordinator~~CalledByGraph_edge7" class="edge">
<title>program~main&#45;&gt;proc~run_multi_molecule_calculations</title>
<path fill="none" stroke="#00ff00" d="M54.21,-28.61C61.81,-27.62 70.61,-26.48 79.96,-25.27"/>
<polygon fill="#00ff00" stroke="#00ff00" points="80.42,-28.74 89.89,-23.99 79.52,-21.8 80.42,-28.74"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocglobal_coordinatorCalledByGraph = svgPanZoom('#procglobal_coordinatorCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-calc_type_local~2"></span>
              integer(kind=int32),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>calc_type_local</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-coord_timer"></span>
              type(timer_type),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>coord_timer</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_fragment"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_fragment</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dummy_msg"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dummy_msg</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-finished_nodes"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>finished_nodes</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_idx~3"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_idx</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-handling_local_workers"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>handling_local_workers</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-has_pending"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>has_pending</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_dummy"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_dummy</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_finished_workers"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_finished_workers</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-local_status"></span>
              type(MPI_Status),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>local_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-req~3"></span>
              type(request_t),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>req</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-request_source"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>request_source</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>results</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results_received"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>results_received</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-status~3"></span>
              type(MPI_Status),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-worker_fragment_map"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>worker_fragment_map</strong>(node_comm%size())</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-worker_source"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>worker_source</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">module subroutine </span><span class="n">global_coordinator</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                        </span><span class="n">node_leader_ranks</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">calc_type</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Global coordinator for distributing fragments to node coordinators</span>
<span class="w">      </span><span class="c">!! will act as a node coordinator for a single node calculation</span>
<span class="w">      </span><span class="c">!! Uses int64 for total_fragments to handle large fragment counts that overflow int32.</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">node_comm</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_fragments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">node_leader_ranks</span><span class="p">(:)</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">calc_type</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span>

<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">timer_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coord_timer</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">results_received</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">finished_nodes</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">request_source</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_msg</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_idx</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">MPI_Status</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">handling_local_workers</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">has_pending</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">calc_type_local</span>

<span class="w">      </span><span class="c">! For local workers</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="p">,</span><span class="w"> </span><span class="n">local_dummy</span>

<span class="w">      </span><span class="c">! Storage for results</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">results</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">())</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">worker_source</span>

<span class="w">      </span><span class="c">! MPI request handles for non-blocking operations</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">request_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">req</span>

<span class="w">      </span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calc_type</span>

<span class="w">      </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_fragments</span>
<span class="w">      </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">handling_local_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0_int64</span>

<span class="w">      </span><span class="c">! Allocate storage for results</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">))</span>
<span class="w">      </span><span class="n">worker_fragment_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator starting with &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="s2">&quot; fragments for &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; nodes&quot;</span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="n">start</span><span class="p">()</span>
<span class="w">      </span><span class="k">do while</span><span class="w"> </span><span class="p">(</span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">)</span>

<span class="w">         </span><span class="c">! PRIORITY 1: Check for incoming results from local workers</span>
<span class="w">         </span><span class="c">! This MUST be checked before sending new work to avoid race conditions</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! Keep checking for results until there are none pending</span>
<span class="w">            </span><span class="k">do</span>
<span class="k">               call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="k">               </span><span class="n">worker_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span>

<span class="w">               </span><span class="c">! Safety check: worker should have a fragment assigned</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Received result from worker &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="s2">&quot; but no fragment was assigned!&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="k">call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="w">               </span><span class="c">! Receive result and store it using the fragment index for this worker</span>
<span class="w">               </span><span class="k">call </span><span class="n">result_irecv</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)),</span><span class="w"> </span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">worker_source</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">TAG_WORKER_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="c">! Clear the mapping since we&#39;ve received the result</span>
<span class="w">               </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">worker_source</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">               </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">results_received</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">results_received</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Processed &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">results_received</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; fragments [&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s]&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! PRIORITY 1b: Check for incoming results from remote node coordinators</span>
<span class="w">         </span><span class="k">do</span>
<span class="k">            call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>

<span class="w">            </span><span class="c">! Receive fragment index and result from node coordinator</span>
<span class="w">            </span><span class="c">! TODO: serialize the data for better performance</span>
<span class="w">            </span><span class="k">call </span><span class="n">irecv</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_idx</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">result_irecv</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">fragment_idx</span><span class="p">),</span><span class="w"> </span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_SCALAR_RESULT</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="n">results_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">results_received</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">results_received</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Processed &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">results_received</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">to_char</span><span class="p">(</span><span class="n">total_fragments</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; fragments [&quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s]&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>

<span class="w">         </span><span class="c">! PRIORITY 2: Remote node coordinator requests</span>
<span class="w">         </span><span class="k">call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">irecv</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_msg</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">            </span><span class="n">request_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">%</span><span class="n">MPI_SOURCE</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current_fragment</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">send_fragment_to_node</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">request_source</span><span class="p">)</span>
<span class="w">               </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               call </span><span class="n">isend</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">request_source</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_NODE_FINISH</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! PRIORITY 3: Local workers (shared memory) - send new work</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">iprobe</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_ANY_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">has_pending</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">has_pending</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! Only process work request if this worker doesn&#39;t have pending results</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">irecv</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">local_dummy</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_REQUEST</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">                  </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current_fragment</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     call </span><span class="n">send_fragment_to_worker</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="n">current_fragment</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span>
<span class="w">                     </span><span class="c">! Track which fragment was sent to this worker</span>
<span class="w">                     </span><span class="n">worker_fragment_map</span><span class="p">(</span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span>
<span class="w">                     </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_fragment</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="k">else</span>
<span class="k">                     call </span><span class="n">isend</span><span class="p">(</span><span class="n">node_comm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">local_status</span><span class="p">%</span><span class="n">MPI_SOURCE</span><span class="p">,</span><span class="w"> </span><span class="n">TAG_WORKER_FINISH</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">wait</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="w">                     </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">               end if</span>
<span class="w">               </span><span class="c">! If worker still has pending results, skip the work request</span>
<span class="w">               </span><span class="c">! It will be processed on the next iteration after results are received</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>

<span class="w">         </span><span class="c">! Finalize local worker completion</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handling_local_workers</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">local_finished_workers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">node_comm</span><span class="p">%</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">             </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">results_received</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">handling_local_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Manually incremented finished_nodes for self&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finished_nodes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">               </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator finished local workers&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">      end do</span>

<span class="k">      call </span><span class="n">logger</span><span class="p">%</span><span class="n">verbose</span><span class="p">(</span><span class="s2">&quot;Global coordinator finished all fragments&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="k">stop</span><span class="p">()</span>
<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time to evaluate all fragments &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="k">block</span>
<span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_energy</span>
<span class="w">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">         </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">         </span><span class="c">! Compute the many-body expansion</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Computing Many-Body Expansion (MBE)...&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">coord_timer</span><span class="p">%</span><span class="n">start</span><span class="p">()</span>

<span class="w">         </span><span class="c">! Use combined function if computing gradients or Hessians (more efficient)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">CALC_TYPE_HESSIAN</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;sys_geom required for Hessian calculation in global_coordinator&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_hessian</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_hessian</span><span class="p">)</span>
<span class="w">         </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_type_local</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">CALC_TYPE_GRADIENT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;sys_geom required for gradient calculation in global_coordinator&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="o">=</span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="o">=</span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_total_gradient</span><span class="p">)</span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            call </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">total_fragments</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">world_comm</span><span class="o">=</span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">         </span><span class="k">end if</span>

<span class="k">         call </span><span class="n">coord_timer</span><span class="p">%</span><span class="k">stop</span><span class="p">()</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time to compute MBE &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">coord_timer</span><span class="p">%</span><span class="n">get_elapsed_time</span><span class="p">())</span><span class="o">//</span><span class="s2">&quot; s&quot;</span><span class="p">)</span>

<span class="w">      </span><span class="k">end block</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="w">   </span><span class="k">end subroutine </span><span class="n">global_coordinator</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-09 10:11 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>