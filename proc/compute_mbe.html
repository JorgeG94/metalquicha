<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>compute_mbe &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>compute_mbe
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 2.7% of total for procedures.">246 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe.f90.html'>mqc_mbe.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe.html'>mqc_mbe</a></li>
            <li class="breadcrumb-item active" aria-current="page">compute_mbe</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_dipole">compute_dipole</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_dipole_derivs">compute_dipole_derivs</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_grad">compute_grad</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_hess">compute_hess</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-current_log_level~3">current_log_level</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_e~2">delta_E</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_dipole_derivs~2">delta_dipole_derivs</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_dipoles~2">delta_dipoles</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_energies~2">delta_energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_gradients~2">delta_gradients</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_hessians~2">delta_hessians</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-do_detailed_print">do_detailed_print</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-energies~2">energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-fragment_size~4">fragment_size</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-hess_dim~2">hess_dim</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-i~43">i</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-ir_intensities">ir_intensities</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-lookup~7">lookup</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-nlevel~3">nlevel</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-sum_by_level~2">sum_by_level</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/compute_mbe.html#src">compute_mbe</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine compute_mbe(polymers, fragment_count, max_level, results, mbe_result, sys_geom, bonds, world_comm)  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/mqc_error.html'>mqc_error</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_result_types.html'>mqc_result_types</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_config_parser.html'>mqc_config_parser</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~UsesGraph Pages: 1 -->
<svg id="proccompute_mbeUsesGraph" width="497pt" height="265pt"
 viewBox="0.00 0.00 497.00 265.03" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 261.03)">
<title>proc~~compute_mbe~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-261.03 493,-261.03 493,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~UsesGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="489,-188 400,-188 400,-164 489,-164 489,-188"/>
<text text-anchor="middle" x="444.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_node2" class="node">
<title>module~mqc_config_parser</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node2"><a xlink:href="../module/mqc_config_parser.html" xlink:title="mqc_config_parser">
<polygon fill="#337ab7" stroke="#337ab7" points="364,-125 250,-125 250,-101 364,-101 364,-125"/>
<text text-anchor="middle" x="307" y="-110.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_config_parser</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_config_parser</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M417.37,-163.85C396.29,-154.05 366.41,-140.16 343.21,-129.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="344.59,-126.15 334.05,-125.11 341.64,-132.5 344.59,-126.15"/>
</g>
<!-- module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_node3" class="node">
<title>module~mqc_error</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node3"><a xlink:href="../module/mqc_error.html" xlink:title="mqc_error">
<polygon fill="#337ab7" stroke="#337ab7" points="189.5,-188 122.5,-188 122.5,-164 189.5,-164 189.5,-188"/>
<text text-anchor="middle" x="156" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_error</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.99,-176C345.83,-176 253.93,-176 200.01,-176"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.76,-172.5 189.76,-176 199.76,-179.5 199.76,-172.5"/>
</g>
<!-- module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_node4" class="node">
<title>module~mqc_result_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node4"><a xlink:href="../module/mqc_result_types.html" xlink:title="mqc_result_types">
<polygon fill="#337ab7" stroke="#337ab7" points="359,-229 255,-229 255,-205 359,-205 359,-229"/>
<text text-anchor="middle" x="307" y="-214.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_result_types</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge3" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_result_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M403.58,-188.08C389.23,-192.42 372.88,-197.37 357.8,-201.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="356.66,-198.62 348.1,-204.87 358.69,-205.32 356.66,-198.62"/>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge5" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.84,-125.11C262.48,-133.79 236.89,-145.57 214,-155 209.25,-156.96 204.24,-158.93 199.24,-160.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.84,-157.63 189.72,-164.43 200.31,-164.18 197.84,-157.63"/>
</g>
<!-- module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_node5" class="node">
<title>module~mqc_calc_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node5"><a xlink:href="../module/mqc_calc_types.html" xlink:title="mqc_calc_types">
<polygon fill="#337ab7" stroke="#337ab7" points="204.5,-24 107.5,-24 107.5,0 204.5,0 204.5,-24"/>
<text text-anchor="middle" x="156" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_calc_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge4" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_calc_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M293.4,-100.94C276.38,-85.09 244.63,-57.03 214,-38 208.54,-34.61 202.57,-31.4 196.61,-28.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.87,-25.19 187.33,-24.1 194.89,-31.53 197.87,-25.19"/>
</g>
<!-- module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_node6" class="node">
<title>module~mqc_geometry</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node6"><a xlink:href="../module/mqc_geometry.html" xlink:title="mqc_geometry">
<polygon fill="#337ab7" stroke="#337ab7" points="202.5,-146 109.5,-146 109.5,-122 202.5,-122 202.5,-146"/>
<text text-anchor="middle" x="156" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_geometry</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_edge6" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_geometry</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-120.94C237.57,-122.65 224.78,-124.45 212.7,-126.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.16,-122.69 202.75,-127.55 213.14,-129.62 212.16,-122.69"/>
</g>
<!-- module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_node7" class="node">
<title>module~mqc_method_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node7"><a xlink:href="../module/mqc_method_types.html" xlink:title="mqc_method_types">
<polygon fill="#337ab7" stroke="#337ab7" points="214,-104 98,-104 98,-80 214,-80 214,-104"/>
<text text-anchor="middle" x="156" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_method_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge7" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_method_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-105.06C241.47,-103.9 232.95,-102.7 224.56,-101.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="224.79,-98.02 214.4,-100.09 223.81,-104.95 224.79,-98.02"/>
</g>
<!-- pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_node9" class="node">
<title>pic_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="62,-104 0,-104 0,-80 62,-80 62,-104"/>
<text text-anchor="middle" x="31" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_types</text>
</g>
<!-- module~mqc_config_parser&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge8" class="edge">
<title>module~mqc_config_parser&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.05,-100.85C267.98,-90.6 240.25,-76.71 214,-71 163.62,-60.04 148.95,-63.09 98,-71 89.37,-72.34 80.33,-74.61 71.81,-77.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="70.55,-73.9 62.09,-80.28 72.68,-80.57 70.55,-73.9"/>
</g>
<!-- module~mqc_result_types&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge9" class="edge">
<title>module~mqc_result_types&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M262.1,-204.92C242.36,-199.49 219.16,-193.1 199.58,-187.72"/>
<polygon fill="#0000ff" stroke="#0000ff" points="200.28,-184.28 189.71,-185 198.42,-191.03 200.28,-184.28"/>
</g>
<!-- pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_node8" class="node">
<title>pic_mpi_lib</title>
<polygon fill="#337ab7" stroke="#337ab7" points="192,-230 120,-230 120,-206 192,-206 192,-230"/>
<text text-anchor="middle" x="156" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_mpi_lib</text>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_edge10" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_mpi_lib</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M254.72,-217.34C237.87,-217.46 219.26,-217.58 202.84,-217.69"/>
<polygon fill="#0000ff" stroke="#0000ff" points="202.39,-214.2 192.41,-217.76 202.43,-221.2 202.39,-214.2"/>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge11" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M280.9,-229.12C239.26,-247.3 154.85,-275.8 98,-239 55.17,-211.28 39.87,-148.44 34.61,-114.6"/>
<polygon fill="#0000ff" stroke="#0000ff" points="38.02,-113.75 33.18,-104.33 31.09,-114.71 38.02,-113.75"/>
</g>
<!-- module~mqc_calc_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge12" class="edge">
<title>module~mqc_calc_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M124.66,-24.09C115.82,-28.08 106.31,-32.83 98,-38 81.71,-48.14 65,-61.86 52.47,-72.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.97,-70.46 44.88,-79.75 54.65,-75.66 49.97,-70.46"/>
</g>
<!-- module~mqc_geometry&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge13" class="edge">
<title>module~mqc_geometry&#45;&gt;pic_types</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M119.75,-121.96C104.85,-116.87 87.4,-110.92 72.02,-105.66"/>
<polygon fill="#cbff00" stroke="#cbff00" points="72.84,-102.25 62.25,-102.33 70.58,-108.87 72.84,-102.25"/>
</g>
<!-- module~mqc_method_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge14" class="edge">
<title>module~mqc_method_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M97.82,-92C89.18,-92 80.42,-92 72.23,-92"/>
<polygon fill="#00ff66" stroke="#00ff66" points="72.22,-88.5 62.22,-92 72.22,-95.5 72.22,-88.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


    <p>Compute many-body expansion (MBE) energy with optional gradient, hessian, and dipole</p>
<p>This is the core routine that handles all MBE computations.
The caller pre-allocates desired components in mbe_result before calling:
  - mbe_result%gradient allocated: compute gradient (requires sys_geom)
  - mbe_result%hessian allocated: compute hessian (requires sys_geom)
  - mbe_result%dipole allocated: compute total dipole moment</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~9"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_count~2"></span>
              integer(kind=int64),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_count</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~10"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results~5"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>results</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mbe_result"></span>
              type(<a href='../type/mbe_result_t.html'>mbe_result_t</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mbe_result</strong></td>
            <td>
                <p>Pre-allocated by caller</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~38"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                <p>Required for gradient/hessian</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~19"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                <p>Bond info for H-cap handling</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~10"></span>
              type(comm_t),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                <p>MPI communicator for abort</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CallsGraph Pages: 1 -->
<svg id="proccompute_mbeCallsGraph" width="641pt" height="850pt"
 viewBox="0.00 0.00 641.00 849.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CallsGraph" class="graph" transform="scale(0.37 0.37) rotate(0) translate(4 2264.24)">
<title>proc~~compute_mbe~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2264.24 1707,-2264.24 1707,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="89,-1356.76 0,-1356.76 0,-1332.76 89,-1332.76 89,-1356.76"/>
<text text-anchor="middle" x="44.5" y="-1342.36" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_node2" class="node">
<title>abort_comm</title>
<polygon fill="#777777" stroke="#777777" points="870,-1871.76 790,-1871.76 790,-1847.76 870,-1847.76 870,-1871.76"/>
<text text-anchor="middle" x="830" y="-1857.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abort_comm</text>
</g>
<!-- proc~compute_mbe&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;abort_comm</title>
<path fill="none" stroke="#ff0000" d="M45.28,-1357.02C44.25,-1430.16 43.01,-1808.07 125,-1878.76 174.28,-1921.25 628.33,-1879.95 779.96,-1864.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="780.32,-1868.3 789.92,-1863.82 779.62,-1861.34 780.32,-1868.3"/>
</g>
<!-- cart_disp -->
<g id="proc~~compute_mbe~~CallsGraph_node3" class="node">
<title>cart_disp</title>
<polygon fill="#777777" stroke="#777777" points="284,-1949.76 223,-1949.76 223,-1925.76 284,-1925.76 284,-1949.76"/>
<text text-anchor="middle" x="253.5" y="-1935.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cart_disp</text>
</g>
<!-- proc~compute_mbe&#45;&gt;cart_disp -->
<g id="proc~~compute_mbe~~CallsGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;cart_disp</title>
<path fill="none" stroke="#ff0000" d="M45.38,-1357.05C44.91,-1432.05 46.2,-1827.93 125,-1911.76 147.12,-1935.29 184.29,-1940.65 212.8,-1940.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.93,-1944.3 222.88,-1940.64 212.82,-1937.3 212.93,-1944.3"/>
</g>
<!-- configuration -->
<g id="proc~~compute_mbe~~CallsGraph_node4" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="872,-1475.76 788,-1475.76 788,-1451.76 872,-1451.76 872,-1475.76"/>
<text text-anchor="middle" x="830" y="-1461.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge3" class="edge">
<title>proc~compute_mbe&#45;&gt;configuration</title>
<path fill="none" stroke="#ff0000" d="M81.2,-1356.86C94.78,-1361.11 110.49,-1365.61 125,-1368.76 366.3,-1421.12 660.76,-1449.69 777.64,-1459.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="777.48,-1463.15 787.74,-1460.51 778.07,-1456.18 777.48,-1463.15"/>
</g>
<!-- error -->
<g id="proc~~compute_mbe~~CallsGraph_node5" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1435.5,-1307.76 1381.5,-1307.76 1381.5,-1283.76 1435.5,-1283.76 1435.5,-1307.76"/>
<text text-anchor="middle" x="1408.5" y="-1293.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~compute_mbe&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge4" class="edge">
<title>proc~compute_mbe&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M85.05,-1332.76C168.72,-1308.47 370.15,-1255.76 543,-1255.76 543,-1255.76 543,-1255.76 831,-1255.76 1020.08,-1255.76 1067.71,-1257.54 1256,-1274.76 1295.5,-1278.38 1340.49,-1284.92 1371.11,-1289.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1370.88,-1293.26 1381.31,-1291.38 1371.99,-1286.35 1370.88,-1293.26"/>
</g>
<!-- fc_mdyne -->
<g id="proc~~compute_mbe~~CallsGraph_node6" class="node">
<title>fc_mdyne</title>
<polygon fill="#777777" stroke="#777777" points="285.5,-1827.76 221.5,-1827.76 221.5,-1803.76 285.5,-1803.76 285.5,-1827.76"/>
<text text-anchor="middle" x="253.5" y="-1813.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fc_mdyne</text>
</g>
<!-- proc~compute_mbe&#45;&gt;fc_mdyne -->
<g id="proc~~compute_mbe~~CallsGraph_edge5" class="edge">
<title>proc~compute_mbe&#45;&gt;fc_mdyne</title>
<path fill="none" stroke="#ff0000" d="M45.82,-1357.02C47.81,-1422.56 60.54,-1731.04 125,-1794.76 147.21,-1816.72 182.97,-1821.01 210.97,-1820.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.45,-1823.83 221.28,-1819.88 211.13,-1816.84 211.45,-1823.83"/>
</g>
<!-- force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node7" class="node">
<title>force_constants</title>
<polygon fill="#777777" stroke="#777777" points="301.5,-1785.76 205.5,-1785.76 205.5,-1761.76 301.5,-1761.76 301.5,-1785.76"/>
<text text-anchor="middle" x="253.5" y="-1771.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">force_constants</text>
</g>
<!-- proc~compute_mbe&#45;&gt;force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge6" class="edge">
<title>proc~compute_mbe&#45;&gt;force_constants</title>
<path fill="none" stroke="#ff0000" d="M46.07,-1357.09C49.18,-1419.04 66.24,-1695.7 125,-1752.76 143.39,-1770.62 170.76,-1776.72 195.43,-1778"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.36,-1781.5 205.45,-1778.28 195.55,-1774.5 195.36,-1781.5"/>
</g>
<!-- frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_node8" class="node">
<title>frequencies</title>
<polygon fill="#777777" stroke="#777777" points="291,-1743.76 216,-1743.76 216,-1719.76 291,-1719.76 291,-1743.76"/>
<text text-anchor="middle" x="253.5" y="-1729.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">frequencies</text>
</g>
<!-- proc~compute_mbe&#45;&gt;frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_edge7" class="edge">
<title>proc~compute_mbe&#45;&gt;frequencies</title>
<path fill="none" stroke="#ff0000" d="M46.35,-1356.96C50.65,-1414.74 71.86,-1660.25 125,-1710.76 146.19,-1730.91 178.86,-1735.99 205.82,-1736.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.9,-1739.61 215.84,-1735.94 205.78,-1732.61 205.9,-1739.61"/>
</g>
<!-- get_message -->
<g id="proc~~compute_mbe~~CallsGraph_node9" class="node">
<title>get_message</title>
<polygon fill="#777777" stroke="#777777" points="295,-1701.76 212,-1701.76 212,-1677.76 295,-1677.76 295,-1701.76"/>
<text text-anchor="middle" x="253.5" y="-1687.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_message</text>
</g>
<!-- proc~compute_mbe&#45;&gt;get_message -->
<g id="proc~~compute_mbe~~CallsGraph_edge8" class="edge">
<title>proc~compute_mbe&#45;&gt;get_message</title>
<path fill="none" stroke="#ff0000" d="M46.72,-1356.98C52.34,-1410.64 77.5,-1624.8 125,-1668.76 145.35,-1687.6 175.77,-1693.14 201.79,-1693.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="201.87,-1697.34 211.89,-1693.88 201.9,-1690.34 201.87,-1697.34"/>
</g>
<!-- has_error -->
<g id="proc~~compute_mbe~~CallsGraph_node10" class="node">
<title>has_error</title>
<polygon fill="#777777" stroke="#777777" points="285,-1659.76 222,-1659.76 222,-1635.76 285,-1635.76 285,-1659.76"/>
<text text-anchor="middle" x="253.5" y="-1645.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">has_error</text>
</g>
<!-- proc~compute_mbe&#45;&gt;has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge9" class="edge">
<title>proc~compute_mbe&#45;&gt;has_error</title>
<path fill="none" stroke="#ff0000" d="M47.2,-1357.03C54.3,-1406.36 83.1,-1589.3 125,-1626.76 148.28,-1647.58 183.95,-1651.97 211.64,-1651.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.94,-1655.13 221.82,-1651.3 211.71,-1648.13 211.94,-1655.13"/>
</g>
<!-- info -->
<g id="proc~~compute_mbe~~CallsGraph_node11" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="857,-213.76 803,-213.76 803,-189.76 857,-189.76 857,-213.76"/>
<text text-anchor="middle" x="830" y="-199.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~compute_mbe&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge10" class="edge">
<title>proc~compute_mbe&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M45.47,-1332.62C45.27,-1217.64 46.28,-322.96 125,-238.76 215.95,-141.48 661.05,-182.86 792.43,-197.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="792.42,-200.97 802.75,-198.62 793.2,-194.02 792.42,-200.97"/>
</g>
<!-- proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_node12" class="node">
<title>proc~build_mbe_lookup_table</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node12"><a xlink:href="../proc/build_mbe_lookup_table.html" xlink:title="build_mbe_lookup_table">
<polygon fill="#d9534f" stroke="#d9534f" points="615,-2031.76 473,-2031.76 473,-2007.76 615,-2007.76 615,-2031.76"/>
<text text-anchor="middle" x="544" y="-2017.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_mbe_lookup_table</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_edge11" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table</title>
<path fill="none" stroke="#ff0000" d="M46.2,-1356.86C51.06,-1439.07 80.94,-1913.99 125,-1958.76 214.08,-2049.3 373.94,-2045.25 468.05,-2033.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.62,-2036.62 478.06,-2031.81 467.69,-2029.68 468.62,-2036.62"/>
</g>
<!-- proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_node13" class="node">
<title>proc~compute_mbe_delta</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node13"><a xlink:href="../proc/compute_mbe_delta.html" xlink:title="compute_mbe_delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="314,-1617.76 193,-1617.76 193,-1593.76 314,-1593.76 314,-1617.76"/>
<text text-anchor="middle" x="253.5" y="-1603.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_delta</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_edge12" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_delta</title>
<path fill="none" stroke="#ff0000" d="M45.45,-1356.82C45.98,-1396.44 53.42,-1523.6 125,-1584.76 140.9,-1598.35 162.14,-1604.83 182.71,-1607.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.41,-1611.06 192.72,-1608.63 183.15,-1604.1 182.41,-1611.06"/>
</g>
<!-- proc~compute_mbe_dipole -->
<g id="proc~~compute_mbe~~CallsGraph_node14" class="node">
<title>proc~compute_mbe_dipole</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node14"><a xlink:href="../proc/compute_mbe_dipole.html" xlink:title="compute_mbe_dipole">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-1869.76 190,-1869.76 190,-1845.76 317,-1845.76 317,-1869.76"/>
<text text-anchor="middle" x="253.5" y="-1855.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_dipole</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole -->
<g id="proc~~compute_mbe~~CallsGraph_edge13" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole</title>
<path fill="none" stroke="#ff0000" d="M45.62,-1356.78C46.56,-1425.31 54.75,-1766.3 125,-1836.76 139.36,-1851.17 159.55,-1858.01 179.63,-1860.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.45,-1864.33 189.77,-1861.93 180.21,-1857.37 179.45,-1864.33"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_node15" class="node">
<title>proc~compute_mbe_dipole_derivatives</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node15"><a xlink:href="../proc/compute_mbe_dipole_derivatives.html" xlink:title="compute_mbe_dipole_derivatives">
<polygon fill="#d9534f" stroke="#d9534f" points="349,-1533.76 158,-1533.76 158,-1509.76 349,-1509.76 349,-1533.76"/>
<text text-anchor="middle" x="253.5" y="-1519.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_dipole_derivatives</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge14" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_dipole_derivatives</title>
<path fill="none" stroke="#ff0000" d="M47.81,-1356.93C54.18,-1386.83 74.94,-1464.16 125,-1500.76 132.1,-1505.96 140.03,-1510.05 148.35,-1513.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="147.3,-1516.61 157.89,-1516.53 149.56,-1509.98 147.3,-1516.61"/>
</g>
<!-- proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node16" class="node">
<title>proc~compute_mbe_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node16"><a xlink:href="../proc/compute_mbe_gradient.html" xlink:title="compute_mbe_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="323,-1575.76 184,-1575.76 184,-1551.76 323,-1551.76 323,-1575.76"/>
<text text-anchor="middle" x="253.5" y="-1561.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge15" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient</title>
<path fill="none" stroke="#ff0000" d="M46.4,-1356.93C49.7,-1392.03 64.32,-1494.09 125,-1542.76 138.75,-1553.79 156.07,-1560.03 173.48,-1563.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.28,-1566.89 183.71,-1565.03 174.39,-1559.98 173.28,-1566.89"/>
</g>
<!-- proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node17" class="node">
<title>proc~compute_mbe_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node17"><a xlink:href="../proc/compute_mbe_hessian.html" xlink:title="compute_mbe_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="321,-1491.76 186,-1491.76 186,-1467.76 321,-1467.76 321,-1491.76"/>
<text text-anchor="middle" x="253.5" y="-1477.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge16" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian</title>
<path fill="none" stroke="#ff0000" d="M50.66,-1356.88C61.09,-1379.79 86.96,-1429.34 125,-1453.76 140.02,-1463.41 157.91,-1469.58 175.46,-1473.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.25,-1477.02 185.74,-1475.55 176.62,-1470.16 175.25,-1477.02"/>
</g>
<!-- proc~compute_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_node18" class="node">
<title>proc~compute_thermochemistry</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node18"><a xlink:href="../proc/compute_thermochemistry.html" xlink:title="compute_thermochemistry">
<polygon fill="#d9534f" stroke="#d9534f" points="622.5,-600.76 465.5,-600.76 465.5,-576.76 622.5,-576.76 622.5,-600.76"/>
<text text-anchor="middle" x="544" y="-586.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_thermochemistry</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_edge17" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff0000" d="M45.33,-1332.65C44.45,-1254.13 43.31,-817.38 125,-719.76 206.31,-622.6 358.83,-596.42 455.43,-589.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="455.7,-593.47 465.47,-589.37 455.28,-586.49 455.7,-593.47"/>
</g>
<!-- proc~compute_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_node19" class="node">
<title>proc~compute_vibrational_analysis</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node19"><a xlink:href="../proc/compute_vibrational_analysis.html" xlink:title="compute_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="629,-1190.76 459,-1190.76 459,-1166.76 629,-1166.76 629,-1190.76"/>
<text text-anchor="middle" x="544" y="-1176.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_edge18" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M51.08,-1332.44C61.86,-1310.2 87.81,-1263.63 125,-1241.76 138.85,-1233.62 329.41,-1207.13 448.39,-1191.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="449.16,-1194.64 458.61,-1189.85 448.23,-1187.7 449.16,-1194.64"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_node20" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node20"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="321.5,-1147.76 185.5,-1147.76 185.5,-1123.76 321.5,-1123.76 321.5,-1147.76"/>
<text text-anchor="middle" x="253.5" y="-1133.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge19" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#ff0000" d="M46.67,-1332.71C50.64,-1298.89 66.81,-1202.58 125,-1156.76 139.28,-1145.52 157.28,-1139.29 175.23,-1136.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.82,-1139.48 185.17,-1134.51 174.76,-1132.56 175.82,-1139.48"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node21" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node21"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-1189.76 125,-1189.76 125,-1165.76 382,-1165.76 382,-1189.76"/>
<text text-anchor="middle" x="253.5" y="-1175.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge20" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#ff0000" d="M48.61,-1332.64C56.37,-1304.97 79.33,-1237.01 125,-1203.76 130.21,-1199.97 135.85,-1196.7 141.75,-1193.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.41,-1196.97 151.22,-1189.81 140.65,-1190.54 143.41,-1196.97"/>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_node22" class="node">
<title>proc~map_fragment_to_system_dipole_derivatives</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node22"><a xlink:href="../proc/map_fragment_to_system_dipole_derivatives.html" xlink:title="map_fragment_to_system_dipole_derivatives">
<polygon fill="#d9534f" stroke="#d9534f" points="670,-1379.76 418,-1379.76 418,-1355.76 670,-1355.76 670,-1379.76"/>
<text text-anchor="middle" x="544" y="-1365.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_dipole_derivatives</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge21" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_dipole_derivatives</title>
<path fill="none" stroke="#ff0000" d="M89.23,-1347.67C100.85,-1348.4 113.4,-1349.15 125,-1349.76 219.35,-1354.76 325.74,-1359.33 407.57,-1362.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="407.54,-1366.11 417.68,-1363.01 407.82,-1359.12 407.54,-1366.11"/>
</g>
<!-- proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node23" class="node">
<title>proc~map_fragment_to_system_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node23"><a xlink:href="../proc/map_fragment_to_system_gradient.html" xlink:title="map_fragment_to_system_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="644,-1553.76 444,-1553.76 444,-1529.76 644,-1529.76 644,-1553.76"/>
<text text-anchor="middle" x="544" y="-1539.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge22" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#ff0000" d="M55.1,-1356.83C68.77,-1373.08 95.47,-1401.59 125,-1415.76 229.41,-1465.86 272.1,-1422.24 382,-1458.76 431.43,-1475.19 484.3,-1505.11 515.46,-1524.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="513.69,-1527.2 524.03,-1529.49 517.38,-1521.25 513.69,-1527.2"/>
</g>
<!-- proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node24" class="node">
<title>proc~map_fragment_to_system_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node24"><a xlink:href="../proc/map_fragment_to_system_hessian.html" xlink:title="map_fragment_to_system_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="642,-1337.76 446,-1337.76 446,-1313.76 642,-1313.76 642,-1337.76"/>
<text text-anchor="middle" x="544" y="-1323.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge23" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#ff0000" d="M89.21,-1343.09C166.05,-1340.16 327.4,-1334 435.5,-1329.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="435.94,-1333.36 445.79,-1329.48 435.67,-1326.36 435.94,-1333.36"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node25" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node25"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="619,-966.76 469,-966.76 469,-942.76 619,-942.76 619,-966.76"/>
<text text-anchor="middle" x="544" y="-952.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge24" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#ff0000" d="M46.2,-1332.69C49,-1295.17 62.57,-1179.28 125,-1114.76 215.07,-1021.69 365.05,-981.99 458.74,-965.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="459.48,-969.04 468.75,-963.92 458.31,-962.14 459.48,-969.04"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_node26" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node26"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="632.5,-415.76 455.5,-415.76 455.5,-391.76 632.5,-391.76 632.5,-415.76"/>
<text text-anchor="middle" x="544" y="-401.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_edge25" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#ff0000" d="M46.07,-1332.6C50.45,-1240.71 79.92,-657.4 125,-594.76 202.74,-486.77 356.58,-438.42 454.39,-417.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="455.17,-421.25 464.26,-415.82 453.76,-414.4 455.17,-421.25"/>
</g>
<!-- proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node27" class="node">
<title>proc~print_mbe_energy_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node27"><a xlink:href="../proc/print_mbe_energy_breakdown.html" xlink:title="print_mbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="630.5,-331.76 457.5,-331.76 457.5,-307.76 630.5,-307.76 630.5,-331.76"/>
<text text-anchor="middle" x="544" y="-317.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge26" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown</title>
<path fill="none" stroke="#ff0000" d="M45.57,-1332.69C46.31,-1225.46 54.14,-438.68 125,-365.76 218.55,-269.5 393.33,-287.78 484.41,-305.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="483.8,-309.18 494.29,-307.74 485.19,-302.32 483.8,-309.18"/>
</g>
<!-- proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_node28" class="node">
<title>proc~print_mbe_gradient_info</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node28"><a xlink:href="../proc/print_mbe_gradient_info.html" xlink:title="print_mbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="615,-95.76 473,-95.76 473,-71.76 615,-71.76 615,-95.76"/>
<text text-anchor="middle" x="544" y="-81.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_edge27" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info</title>
<path fill="none" stroke="#ff0000" d="M45.82,-1332.54C49.15,-1206.51 78.51,-147.3 125,-101.76 171.13,-56.59 354.75,-65.47 462.67,-75.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="462.59,-78.63 472.87,-76.06 463.23,-71.66 462.59,-78.63"/>
</g>
<!-- proc~print_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_node29" class="node">
<title>proc~print_vibrational_analysis</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node29"><a xlink:href="../proc/print_vibrational_analysis.html" xlink:title="print_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="327.5,-271.76 179.5,-271.76 179.5,-247.76 327.5,-247.76 327.5,-271.76"/>
<text text-anchor="middle" x="253.5" y="-257.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_edge28" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M45.78,-1332.47C48.31,-1223.27 68.77,-421.54 125,-332.76 142.46,-305.2 174.3,-286.96 201.8,-275.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.28,-278.78 211.31,-271.87 200.73,-272.26 203.28,-278.78"/>
</g>
<!-- proc~print_vibrational_json_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_node30" class="node">
<title>proc~print_vibrational_json_mbe</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node30"><a xlink:href="../proc/print_vibrational_json_mbe.html" xlink:title="print_vibrational_json_mbe">
<polygon fill="#d9534f" stroke="#d9534f" points="622,-373.76 466,-373.76 466,-349.76 622,-349.76 622,-373.76"/>
<text text-anchor="middle" x="544" y="-359.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_json_mbe</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_json_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_edge29" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_json_mbe</title>
<path fill="none" stroke="#ff0000" d="M45.68,-1332.59C47.33,-1229.42 61.18,-503.27 125,-433.76 168.41,-386.49 346.49,-370.21 455.73,-364.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="455.94,-368.13 465.75,-364.15 455.59,-361.14 455.94,-368.13"/>
</g>
<!-- reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_node31" class="node">
<title>reduced_masses</title>
<polygon fill="#777777" stroke="#777777" points="304,-134.76 203,-134.76 203,-110.76 304,-110.76 304,-134.76"/>
<text text-anchor="middle" x="253.5" y="-120.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduced_masses</text>
</g>
<!-- proc~compute_mbe&#45;&gt;reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_edge30" class="edge">
<title>proc~compute_mbe&#45;&gt;reduced_masses</title>
<path fill="none" stroke="#ff0000" d="M45.43,-1332.43C44.86,-1211.69 42.86,-242.8 125,-148.76 141.65,-129.7 168.16,-122.34 192.7,-120.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="192.95,-123.59 202.7,-119.44 192.49,-116.6 192.95,-123.59"/>
</g>
<!-- to_char -->
<g id="proc~~compute_mbe~~CallsGraph_node32" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1435.5,-678.76 1381.5,-678.76 1381.5,-654.76 1435.5,-654.76 1435.5,-678.76"/>
<text text-anchor="middle" x="1408.5" y="-664.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~compute_mbe&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge31" class="edge">
<title>proc~compute_mbe&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M45.79,-1332.57C48.94,-1204.57 77.2,-110.89 125,-63.76 257.44,66.82 357.01,-43.76 543,-43.76 543,-43.76 543,-43.76 831,-43.76 1020.6,-43.76 1111.27,41.72 1256,-80.76 1345.59,-156.58 1394.19,-546.3 1405.11,-644.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1401.64,-644.79 1406.21,-654.35 1408.6,-644.03 1401.64,-644.79"/>
</g>
<!-- warning -->
<g id="proc~~compute_mbe~~CallsGraph_node33" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="1150.5,-745.76 1095.5,-745.76 1095.5,-721.76 1150.5,-721.76 1150.5,-745.76"/>
<text text-anchor="middle" x="1123" y="-731.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~compute_mbe&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge32" class="edge">
<title>proc~compute_mbe&#45;&gt;warning</title>
<path fill="none" stroke="#ff0000" d="M46.63,-1332.44C52.12,-1275.16 77.64,-1035.27 125,-979.76 380.43,-680.41 936.57,-714.39 1084.98,-729.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1085.03,-732.96 1095.34,-730.53 1085.76,-726 1085.03,-732.96"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge40" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;to_char</title>
<path fill="none" stroke="#1fff00" d="M594.87,-2031.85C731.5,-2061.62 1111.26,-2121.23 1256,-1904.76 1327.49,-1797.85 1230.89,-860.93 1292,-747.76 1309.18,-715.96 1344.94,-693.9 1372.15,-680.93"/>
<polygon fill="#1fff00" stroke="#1fff00" points="1373.73,-684.05 1381.37,-676.71 1370.82,-677.68 1373.73,-684.05"/>
</g>
<!-- debug -->
<g id="proc~~compute_mbe~~CallsGraph_node34" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="857,-1913.76 803,-1913.76 803,-1889.76 857,-1889.76 857,-1913.76"/>
<text text-anchor="middle" x="830" y="-1899.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge33" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;debug</title>
<path fill="none" stroke="#1fff00" d="M561.98,-2007.67C590.41,-1987.98 650.04,-1949.07 706,-1927.76 734.2,-1917.03 767.81,-1910.31 792.77,-1906.39"/>
<polygon fill="#1fff00" stroke="#1fff00" points="793.52,-1909.82 802.89,-1904.88 792.49,-1902.9 793.52,-1909.82"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_node35" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="883,-2153.76 777,-2153.76 777,-2129.76 883,-2129.76 883,-2153.76"/>
<text text-anchor="middle" x="830" y="-2139.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_edge34" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#1fff00" d="M559.91,-2031.98C587.11,-2053.6 647.43,-2098.4 706,-2120.76 725.22,-2128.1 747.1,-2132.88 767.03,-2136"/>
<polygon fill="#1fff00" stroke="#1fff00" points="766.54,-2139.46 776.94,-2137.44 767.55,-2132.54 766.54,-2139.46"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_node53" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node53"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="1200,-1626.76 1046,-1626.76 1046,-1602.76 1200,-1602.76 1200,-1626.76"/>
<text text-anchor="middle" x="1123" y="-1612.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_edge35" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#1fff00" d="M615.41,-2009.78C730.75,-1993.29 947.89,-1961.58 954,-1955.76 1010.9,-1901.63 956.86,-1853.97 990,-1782.76 1018.3,-1721.95 1072.49,-1663.22 1101.87,-1633.98"/>
<polygon fill="#1fff00" stroke="#1fff00" points="1104.43,-1636.37 1109.11,-1626.86 1099.52,-1631.37 1104.43,-1636.37"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_node55" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node55"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1192.5,-1565.76 1053.5,-1565.76 1053.5,-1541.76 1192.5,-1541.76 1192.5,-1565.76"/>
<text text-anchor="middle" x="1123" y="-1551.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge36" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#1fff00" d="M569.73,-2007.71C600.79,-1993.09 656.09,-1968.79 706,-1955.76 759.79,-1941.72 915.15,-1962.53 954,-1922.76 1056.79,-1817.55 896.05,-1706.95 990,-1593.76 1003.47,-1577.53 1023.3,-1567.74 1043.52,-1561.87"/>
<polygon fill="#1fff00" stroke="#1fff00" points="1044.65,-1565.19 1053.45,-1559.29 1042.89,-1558.41 1044.65,-1565.19"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_node58" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node58"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="947.5,-2111.76 712.5,-2111.76 712.5,-2087.76 947.5,-2087.76 947.5,-2111.76"/>
<text text-anchor="middle" x="830" y="-2097.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_edge37" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#1fff00" d="M577.35,-2031.84C609.62,-2043.6 660.77,-2061.44 706,-2073.76 721.78,-2078.06 738.87,-2082.07 755.14,-2085.6"/>
<polygon fill="#1fff00" stroke="#1fff00" points="754.63,-2089.07 765.14,-2087.72 756.09,-2082.22 754.63,-2089.07"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_node59" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node59"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="954,-2031.76 706,-2031.76 706,-2007.76 954,-2007.76 954,-2031.76"/>
<text text-anchor="middle" x="830" y="-2017.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_edge38" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#1fff00" d="M615.2,-2019.76C639.63,-2019.76 667.91,-2019.76 695.74,-2019.76"/>
<polygon fill="#1fff00" stroke="#1fff00" points="695.97,-2023.26 705.97,-2019.76 695.97,-2016.26 695.97,-2023.26"/>
</g>
<!-- start -->
<g id="proc~~compute_mbe~~CallsGraph_node69" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="857,-2195.76 803,-2195.76 803,-2171.76 857,-2171.76 857,-2195.76"/>
<text text-anchor="middle" x="830" y="-2181.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;start -->
<g id="proc~~compute_mbe~~CallsGraph_edge39" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;start</title>
<path fill="none" stroke="#1fff00" d="M554.38,-2031.8C577.04,-2059.94 637.92,-2130.07 706,-2162.76 733.17,-2175.81 767.13,-2180.88 792.49,-2182.79"/>
<polygon fill="#1fff00" stroke="#1fff00" points="792.58,-2186.3 802.78,-2183.43 793.01,-2179.31 792.58,-2186.3"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge41" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff0f" d="M314.2,-1601.83C338.11,-1603.44 364.16,-1609.72 382,-1626.76 437.84,-1680.12 361.87,-1743.72 418,-1796.76 469.32,-1845.26 682.2,-1856.43 779.76,-1859"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="779.87,-1862.5 789.95,-1859.24 780.04,-1855.5 779.87,-1862.5"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge42" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;error</title>
<path fill="none" stroke="#00ff0f" d="M314.07,-1604.02C337.26,-1606.11 362.81,-1612.15 382,-1626.76 412.38,-1649.89 386.57,-1683.08 418,-1704.76 571.55,-1810.69 1132.16,-1795.27 1256,-1655.76 1356.59,-1542.45 1188.9,-1427.79 1292,-1316.76 1311.75,-1295.5 1345.26,-1291.39 1371.11,-1291.94"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="1371.16,-1295.44 1381.31,-1292.39 1371.47,-1288.45 1371.16,-1295.44"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_node57" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node57"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="663,-1695.76 425,-1695.76 425,-1671.76 663,-1671.76 663,-1695.76"/>
<text text-anchor="middle" x="544" y="-1681.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge43" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff0f" d="M314.15,-1609.83C336.1,-1612.8 360.77,-1617.93 382,-1626.76 400.22,-1634.35 400.1,-1644.46 418,-1652.76 432.53,-1659.5 448.71,-1664.9 464.49,-1669.17"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="463.69,-1672.58 474.24,-1671.69 465.44,-1665.8 463.69,-1672.58"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_node62" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node62"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="609,-1643.76 479,-1643.76 479,-1619.76 609,-1619.76 609,-1643.76"/>
<text text-anchor="middle" x="544" y="-1629.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge44" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff0f" d="M314.28,-1611.15C359.12,-1615.19 420.77,-1620.75 468.77,-1625.07"/>
<polygon fill="#00ff0f" stroke="#00ff0f" points="468.52,-1628.57 478.79,-1625.98 469.15,-1621.59 468.52,-1628.57"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge45" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff3f" d="M317.08,-1857.98C432.21,-1858.38 675.38,-1859.23 779.73,-1859.59"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="779.97,-1863.09 789.98,-1859.63 779.99,-1856.09 779.97,-1863.09"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge46" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;error</title>
<path fill="none" stroke="#00ff3f" d="M303.93,-1869.82C330.52,-1878.68 361.89,-1893.36 382,-1916.76 419.41,-1960.28 382.46,-1995.71 418,-2040.76 509.22,-2156.42 563.61,-2167.06 706,-2204.76 945.04,-2268.05 1102.03,-2314.26 1256,-2120.76 1311.68,-2050.79 1233.18,-1384.12 1292,-1316.76 1311.21,-1294.77 1345.09,-1290.82 1371.2,-1291.6"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1371.32,-1295.11 1381.5,-1292.16 1371.7,-1288.12 1371.32,-1295.11"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge47" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff3f" d="M317.11,-1854.92C338.54,-1852.04 362.11,-1846.65 382,-1836.76 446.65,-1804.6 502.87,-1737.62 528.4,-1703.97"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="531.32,-1705.91 534.49,-1695.8 525.71,-1701.73 531.32,-1705.91"/>
</g>
<!-- proc~compute_mbe_dipole&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge48" class="edge">
<title>proc~compute_mbe_dipole&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff3f" d="M317.18,-1861.52C340.27,-1859.6 364.93,-1853.15 382,-1836.76 438.97,-1782.07 363.26,-1719.68 418,-1662.76 431.46,-1648.77 450.18,-1640.7 469.03,-1636.15"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="469.82,-1639.56 478.88,-1634.08 468.37,-1632.71 469.82,-1639.56"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives&#45;&gt;proc~map_fragment_to_system_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge51" class="edge">
<title>proc~compute_mbe_dipole_derivatives&#45;&gt;proc~map_fragment_to_system_dipole_derivatives</title>
<path fill="none" stroke="#00ff6f" d="M349.14,-1511.96C360.48,-1509.11 371.69,-1505.45 382,-1500.76 442.03,-1473.46 498.04,-1417.81 525.43,-1387.88"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="528.29,-1389.94 532.38,-1380.17 523.08,-1385.25 528.29,-1389.94"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge49" class="edge">
<title>proc~compute_mbe_dipole_derivatives&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff6f" d="M349.23,-1525.32C361.2,-1529.08 372.55,-1534.66 382,-1542.76 421.05,-1576.25 380.32,-1617.74 418,-1652.76 424.43,-1658.74 431.82,-1663.6 439.73,-1667.57"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="438.3,-1670.77 448.86,-1671.67 441.17,-1664.38 438.3,-1670.77"/>
</g>
<!-- proc~compute_mbe_dipole_derivatives&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge50" class="edge">
<title>proc~compute_mbe_dipole_derivatives&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff6f" d="M349.07,-1533.58C360.31,-1536.09 371.51,-1539.11 382,-1542.76 399.28,-1548.78 401.99,-1553.9 418,-1562.76 450.06,-1580.52 486.78,-1600.78 512.09,-1614.73"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="510.41,-1617.8 520.86,-1619.57 513.79,-1611.67 510.41,-1617.8"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge52" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff9f" d="M323.04,-1561.49C344.08,-1564.1 365.91,-1570.62 382,-1584.76 423.81,-1621.53 379.8,-1664.25 418,-1704.76 499.8,-1791.51 559.46,-1752.08 670,-1796.76 686.23,-1803.33 689.82,-1806.08 706,-1812.76 732.56,-1823.73 762.68,-1835.26 786.48,-1844.15"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="785.33,-1847.46 795.92,-1847.67 787.77,-1840.9 785.33,-1847.46"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge53" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;error</title>
<path fill="none" stroke="#00ff9f" d="M323.14,-1566.28C424.85,-1570.89 610,-1582.9 670,-1610.76 689.96,-1620.03 685.55,-1636.63 706,-1644.76 746.24,-1660.76 1251.43,-1639.97 1256,-1635.76 1308.48,-1587.44 1243.29,-1368.88 1292,-1316.76 1311.82,-1295.56 1345.32,-1291.45 1371.15,-1291.97"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="1371.19,-1295.48 1381.34,-1292.42 1371.5,-1288.49 1371.19,-1295.48"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge56" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#00ff9f" d="M323.24,-1558.52C356.22,-1556.01 396.54,-1552.93 433.59,-1550.11"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="434.24,-1553.57 443.95,-1549.32 433.71,-1546.59 434.24,-1553.57"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge54" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff9f" d="M323.15,-1563.65C343.61,-1566.48 365.06,-1572.58 382,-1584.76 409.76,-1604.73 391.06,-1631.7 418,-1652.76 426.08,-1659.08 435.27,-1664.12 444.92,-1668.15"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="443.7,-1671.43 454.29,-1671.72 446.19,-1664.89 443.7,-1671.43"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge55" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff9f" d="M323.16,-1570.38C342.56,-1573.5 363.43,-1578.07 382,-1584.76 399.43,-1591.04 400.71,-1599.12 418,-1605.76 434.09,-1611.94 451.93,-1616.76 468.98,-1620.48"/>
<polygon fill="#00ff9f" stroke="#00ff9f" points="468.41,-1623.94 478.91,-1622.55 469.83,-1617.09 468.41,-1623.94"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge59" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#00ffcf" d="M265.34,-1467.38C289.66,-1440.49 351.65,-1376.77 418,-1346.76 423.79,-1344.15 429.86,-1341.85 436.08,-1339.84"/>
<polygon fill="#00ffcf" stroke="#00ffcf" points="437.37,-1343.11 445.96,-1336.91 435.38,-1336.4 437.37,-1343.11"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge57" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ffcf" d="M321.22,-1476.68C343.01,-1479.04 365.76,-1485.61 382,-1500.76 432.76,-1548.12 369.17,-1603.42 418,-1652.76 423.69,-1658.52 430.28,-1663.27 437.39,-1667.18"/>
<polygon fill="#00ffcf" stroke="#00ffcf" points="436.12,-1670.45 446.65,-1671.69 439.19,-1664.16 436.12,-1670.45"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge58" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ffcf" d="M321.21,-1479.83C342.15,-1482.58 364.37,-1488.6 382,-1500.76 408.23,-1518.86 395.23,-1540.48 418,-1562.76 441.83,-1586.08 475.12,-1603.94 501.35,-1615.64"/>
<polygon fill="#00ffcf" stroke="#00ffcf" points="500.1,-1618.91 510.67,-1619.67 502.88,-1612.49 500.1,-1618.91"/>
</g>
<!-- proc~compute_electronic_entropy -->
<g id="proc~~compute_mbe~~CallsGraph_node40" class="node">
<title>proc~compute_electronic_entropy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node40"><a xlink:href="../proc/compute_electronic_entropy.html" xlink:title="compute_electronic_entropy">
<polygon fill="#d9534f" stroke="#d9534f" points="911.5,-537.76 748.5,-537.76 748.5,-513.76 911.5,-513.76 911.5,-537.76"/>
<text text-anchor="middle" x="830" y="-523.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_electronic_entropy</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_electronic_entropy -->
<g id="proc~~compute_mbe~~CallsGraph_edge60" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_electronic_entropy</title>
<path fill="none" stroke="#00ffff" d="M587.13,-576.71C619.48,-567.72 665.34,-555.52 706,-546.76 717.66,-544.25 730,-541.85 742.19,-539.62"/>
<polygon fill="#00ffff" stroke="#00ffff" points="743.14,-543.01 752.36,-537.8 741.9,-536.12 743.14,-543.01"/>
</g>
<!-- proc~compute_moments_of_inertia -->
<g id="proc~~compute_mbe~~CallsGraph_node43" class="node">
<title>proc~compute_moments_of_inertia</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node43"><a xlink:href="../proc/compute_moments_of_inertia.html" xlink:title="compute_moments_of_inertia">
<polygon fill="#d9534f" stroke="#d9534f" points="915.5,-785.76 744.5,-785.76 744.5,-761.76 915.5,-761.76 915.5,-785.76"/>
<text text-anchor="middle" x="830" y="-771.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_moments_of_inertia</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_moments_of_inertia -->
<g id="proc~~compute_mbe~~CallsGraph_edge61" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_moments_of_inertia</title>
<path fill="none" stroke="#00ffff" d="M558.46,-600.96C585.21,-624.81 647.5,-678.44 706,-714.76 732.91,-731.47 765.28,-746.83 790.05,-757.68"/>
<polygon fill="#00ffff" stroke="#00ffff" points="788.92,-761 799.48,-761.76 791.69,-754.58 788.92,-761"/>
</g>
<!-- proc~compute_partition_functions -->
<g id="proc~~compute_mbe~~CallsGraph_node44" class="node">
<title>proc~compute_partition_functions</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node44"><a xlink:href="../proc/compute_partition_functions.html" xlink:title="compute_partition_functions">
<polygon fill="#d9534f" stroke="#d9534f" points="912,-495.76 748,-495.76 748,-471.76 912,-471.76 912,-495.76"/>
<text text-anchor="middle" x="830" y="-481.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_partition_functions</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_partition_functions -->
<g id="proc~~compute_mbe~~CallsGraph_edge62" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_partition_functions</title>
<path fill="none" stroke="#00ffff" d="M563.47,-576.66C592.55,-558.19 651.33,-523.19 706,-504.76 716.14,-501.35 726.94,-498.47 737.78,-496.05"/>
<polygon fill="#00ffff" stroke="#00ffff" points="738.66,-499.44 747.72,-493.95 737.21,-492.59 738.66,-499.44"/>
</g>
<!-- proc~compute_rotational_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node46" class="node">
<title>proc~compute_rotational_constants</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node46"><a xlink:href="../proc/compute_rotational_constants.html" xlink:title="compute_rotational_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="916,-705.76 744,-705.76 744,-681.76 916,-681.76 916,-705.76"/>
<text text-anchor="middle" x="830" y="-691.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_rotational_constants</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge63" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_constants</title>
<path fill="none" stroke="#00ffff" d="M563.47,-600.87C592.55,-619.33 651.33,-654.34 706,-672.76 714.91,-675.77 724.34,-678.36 733.85,-680.58"/>
<polygon fill="#00ffff" stroke="#00ffff" points="733.26,-684.04 743.78,-682.78 734.77,-677.2 733.26,-684.04"/>
</g>
<!-- proc~compute_rotational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_node47" class="node">
<title>proc~compute_rotational_thermo</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node47"><a xlink:href="../proc/compute_rotational_thermo.html" xlink:title="compute_rotational_thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="910,-663.76 750,-663.76 750,-639.76 910,-639.76 910,-663.76"/>
<text text-anchor="middle" x="830" y="-649.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_rotational_thermo</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_edge64" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_rotational_thermo</title>
<path fill="none" stroke="#00ffff" d="M587.13,-600.82C619.48,-609.81 665.34,-622.01 706,-630.76 717.66,-633.28 730,-635.68 742.19,-637.9"/>
<polygon fill="#00ffff" stroke="#00ffff" points="741.9,-641.41 752.36,-639.73 743.14,-634.52 741.9,-641.41"/>
</g>
<!-- proc~compute_translational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_node48" class="node">
<title>proc~compute_translational_thermo</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node48"><a xlink:href="../proc/compute_translational_thermo.html" xlink:title="compute_translational_thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="918,-621.76 742,-621.76 742,-597.76 918,-597.76 918,-621.76"/>
<text text-anchor="middle" x="830" y="-607.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_translational_thermo</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_translational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_edge65" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_translational_thermo</title>
<path fill="none" stroke="#00ffff" d="M622.6,-594.5C656.24,-596.99 695.98,-599.93 731.57,-602.56"/>
<polygon fill="#00ffff" stroke="#00ffff" points="731.75,-606.08 741.98,-603.33 732.27,-599.1 731.75,-606.08"/>
</g>
<!-- proc~compute_vibrational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_node50" class="node">
<title>proc~compute_vibrational_thermo</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node50"><a xlink:href="../proc/compute_vibrational_thermo.html" xlink:title="compute_vibrational_thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="913,-579.76 747,-579.76 747,-555.76 913,-555.76 913,-579.76"/>
<text text-anchor="middle" x="830" y="-565.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_thermo</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_vibrational_thermo -->
<g id="proc~~compute_mbe~~CallsGraph_edge66" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_vibrational_thermo</title>
<path fill="none" stroke="#00ffff" d="M622.6,-583.03C657.81,-580.42 699.71,-577.32 736.53,-574.6"/>
<polygon fill="#00ffff" stroke="#00ffff" points="737.06,-578.07 746.77,-573.84 736.54,-571.09 737.06,-578.07"/>
</g>
<!-- proc~compute_zpe -->
<g id="proc~~compute_mbe~~CallsGraph_node51" class="node">
<title>proc~compute_zpe</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node51"><a xlink:href="../proc/compute_zpe.html" xlink:title="compute_zpe">
<polygon fill="#d9534f" stroke="#d9534f" points="872,-453.76 788,-453.76 788,-429.76 872,-429.76 872,-453.76"/>
<text text-anchor="middle" x="830" y="-439.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_zpe</text>
</a>
</g>
</g>
<!-- proc~compute_thermochemistry&#45;&gt;proc~compute_zpe -->
<g id="proc~~compute_mbe~~CallsGraph_edge67" class="edge">
<title>proc~compute_thermochemistry&#45;&gt;proc~compute_zpe</title>
<path fill="none" stroke="#00ffff" d="M556.15,-576.67C580.57,-551.02 641.73,-491.2 706,-462.76 728.42,-452.84 755.05,-447.59 777.8,-444.82"/>
<polygon fill="#00ffff" stroke="#00ffff" points="778.38,-448.27 787.94,-443.71 777.62,-441.31 778.38,-448.27"/>
</g>
<!-- proc~compute_cartesian_displacements -->
<g id="proc~~compute_mbe~~CallsGraph_node39" class="node">
<title>proc~compute_cartesian_displacements</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node39"><a xlink:href="../proc/compute_cartesian_displacements.html" xlink:title="compute_cartesian_displacements">
<polygon fill="#d9534f" stroke="#d9534f" points="1221.5,-1105.76 1024.5,-1105.76 1024.5,-1081.76 1221.5,-1081.76 1221.5,-1105.76"/>
<text text-anchor="middle" x="1123" y="-1091.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_cartesian_displacements</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements -->
<g id="proc~~compute_mbe~~CallsGraph_edge68" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements</title>
<path fill="none" stroke="#00cfff" d="M629.11,-1181.58C731.84,-1183.73 898.77,-1182.66 954,-1155.76 975.8,-1145.15 968.77,-1126.47 990,-1114.76 997.68,-1110.53 1005.96,-1107.09 1014.51,-1104.3"/>
<polygon fill="#00cfff" stroke="#00cfff" points="1015.66,-1107.61 1024.26,-1101.41 1013.67,-1100.9 1015.66,-1107.61"/>
</g>
<!-- proc~compute_force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node41" class="node">
<title>proc~compute_force_constants</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node41"><a xlink:href="../proc/compute_force_constants.html" xlink:title="compute_force_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="904,-1113.76 756,-1113.76 756,-1089.76 904,-1089.76 904,-1113.76"/>
<text text-anchor="middle" x="830" y="-1099.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_force_constants</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge69" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants</title>
<path fill="none" stroke="#00cfff" d="M629.13,-1169.96C643.15,-1166.82 657.26,-1162.55 670,-1156.76 688.71,-1148.27 687.44,-1136.57 706,-1127.76 718.45,-1121.85 732.25,-1117.27 745.97,-1113.73"/>
<polygon fill="#00cfff" stroke="#00cfff" points="747.03,-1117.08 755.93,-1111.33 745.38,-1110.27 747.03,-1117.08"/>
</g>
<!-- proc~compute_ir_intensities -->
<g id="proc~~compute_mbe~~CallsGraph_node42" class="node">
<title>proc~compute_ir_intensities</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node42"><a xlink:href="../proc/compute_ir_intensities.html" xlink:title="compute_ir_intensities">
<polygon fill="#d9534f" stroke="#d9534f" points="1189,-1063.76 1057,-1063.76 1057,-1039.76 1189,-1039.76 1189,-1063.76"/>
<text text-anchor="middle" x="1123" y="-1049.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_ir_intensities</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_ir_intensities -->
<g id="proc~~compute_mbe~~CallsGraph_edge70" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_ir_intensities</title>
<path fill="none" stroke="#00cfff" d="M628.13,-1166.73C653.15,-1163.15 680.69,-1159.26 706,-1155.76 816.15,-1140.57 858.6,-1179.89 954,-1122.76 977.49,-1108.7 966.69,-1087.13 990,-1072.76 1006.82,-1062.4 1027.06,-1056.6 1046.58,-1053.49"/>
<polygon fill="#00cfff" stroke="#00cfff" points="1047.27,-1056.93 1056.7,-1052.09 1046.31,-1049.99 1047.27,-1056.93"/>
</g>
<!-- proc~compute_reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_node45" class="node">
<title>proc~compute_reduced_masses</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node45"><a xlink:href="../proc/compute_reduced_masses.html" xlink:title="compute_reduced_masses">
<polygon fill="#d9534f" stroke="#d9534f" points="1200,-1147.76 1046,-1147.76 1046,-1123.76 1200,-1123.76 1200,-1147.76"/>
<text text-anchor="middle" x="1123" y="-1133.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_reduced_masses</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_edge71" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses</title>
<path fill="none" stroke="#00cfff" d="M629.29,-1188.1C653.98,-1190.44 681.04,-1192.6 706,-1193.76 816.1,-1198.88 852.46,-1236.64 954,-1193.76 975.14,-1184.84 969.63,-1167.33 990,-1156.76 1003.94,-1149.53 1019.74,-1144.66 1035.43,-1141.4"/>
<polygon fill="#00cfff" stroke="#00cfff" points="1036.52,-1144.76 1045.71,-1139.48 1035.24,-1137.87 1036.52,-1144.76"/>
</g>
<!-- proc~compute_vibrational_frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_node49" class="node">
<title>proc~compute_vibrational_frequencies</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node49"><a xlink:href="../proc/compute_vibrational_frequencies.html" xlink:title="compute_vibrational_frequencies">
<polygon fill="#d9534f" stroke="#d9534f" points="925,-1071.76 735,-1071.76 735,-1047.76 925,-1047.76 925,-1071.76"/>
<text text-anchor="middle" x="830" y="-1057.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_frequencies</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_edge72" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies</title>
<path fill="none" stroke="#00cfff" d="M629.27,-1175.21C643.89,-1171.57 658.17,-1165.78 670,-1156.76 699.72,-1134.11 676.22,-1103.35 706,-1080.76 711.87,-1076.31 718.36,-1072.67 725.19,-1069.7"/>
<polygon fill="#00cfff" stroke="#00cfff" points="726.61,-1072.91 734.7,-1066.06 724.11,-1066.37 726.61,-1072.91"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_node64" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node64"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="619.5,-1147.76 468.5,-1147.76 468.5,-1123.76 619.5,-1123.76 619.5,-1147.76"/>
<text text-anchor="middle" x="544" y="-1133.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge73" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#009fff" d="M321.78,-1135.76C362.39,-1135.76 414.53,-1135.76 457.98,-1135.76"/>
<polygon fill="#009fff" stroke="#009fff" points="458.25,-1139.26 468.25,-1135.76 458.25,-1132.26 458.25,-1139.26"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_node38" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node38"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="913,-1391.76 747,-1391.76 747,-1367.76 913,-1367.76 913,-1391.76"/>
<text text-anchor="middle" x="830" y="-1377.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge74" class="edge">
<title>proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#003fff" d="M670.39,-1373.06C692.61,-1374 715.38,-1374.96 736.48,-1375.85"/>
<polygon fill="#003fff" stroke="#003fff" points="736.56,-1379.36 746.7,-1376.29 736.86,-1372.37 736.56,-1379.36"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node56" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node56"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="941.5,-1349.76 718.5,-1349.76 718.5,-1325.76 941.5,-1325.76 941.5,-1349.76"/>
<text text-anchor="middle" x="830" y="-1335.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge75" class="edge">
<title>proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#003fff" d="M658.88,-1355.73C675.11,-1354.02 691.85,-1352.25 708.2,-1350.52"/>
<polygon fill="#003fff" stroke="#003fff" points="708.75,-1353.99 718.33,-1349.45 708.02,-1347.02 708.75,-1353.99"/>
</g>
<!-- proc~redistribute_cap_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_node66" class="node">
<title>proc~redistribute_cap_dipole_derivatives</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node66"><a xlink:href="../proc/redistribute_cap_dipole_derivatives.html" xlink:title="redistribute_cap_dipole_derivatives">
<polygon fill="#d9534f" stroke="#d9534f" points="930,-1433.76 730,-1433.76 730,-1409.76 930,-1409.76 930,-1433.76"/>
<text text-anchor="middle" x="830" y="-1419.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_dipole_derivatives</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~redistribute_cap_dipole_derivatives -->
<g id="proc~~compute_mbe~~CallsGraph_edge76" class="edge">
<title>proc~map_fragment_to_system_dipole_derivatives&#45;&gt;proc~redistribute_cap_dipole_derivatives</title>
<path fill="none" stroke="#003fff" d="M602.53,-1379.76C640.39,-1387.62 686.44,-1397.09 706,-1400.76 718.89,-1403.19 732.57,-1405.64 745.94,-1407.97"/>
<polygon fill="#003fff" stroke="#003fff" points="745.63,-1411.47 756.08,-1409.72 746.83,-1404.57 745.63,-1411.47"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge77" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#000fff" d="M582.57,-1553.86C610.41,-1564.64 647.31,-1583.05 670,-1610.76 703.66,-1651.87 679.49,-1678.72 706,-1724.76 733.1,-1771.83 779,-1816.35 806.41,-1840.66"/>
<polygon fill="#000fff" stroke="#000fff" points="804.45,-1843.59 814.28,-1847.53 809.05,-1838.32 804.45,-1843.59"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge78" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;configuration</title>
<path fill="none" stroke="#000fff" d="M578.93,-1529.67C611.3,-1518.4 661.58,-1501.6 706,-1489.76 729.41,-1483.53 755.64,-1477.81 777.85,-1473.34"/>
<polygon fill="#000fff" stroke="#000fff" points="778.62,-1476.75 787.75,-1471.37 777.26,-1469.89 778.62,-1476.75"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge80" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;error</title>
<path fill="none" stroke="#000fff" d="M644.11,-1540.28C828.79,-1536.58 1211.02,-1524.21 1256,-1484.76 1313.42,-1434.42 1237.17,-1369.91 1292,-1316.76 1312.71,-1296.69 1345.81,-1292.39 1371.28,-1292.56"/>
<polygon fill="#000fff" stroke="#000fff" points="1371.22,-1296.06 1381.32,-1292.86 1371.43,-1289.07 1371.22,-1296.06"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge79" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;debug</title>
<path fill="none" stroke="#000fff" d="M586.68,-1553.78C614.87,-1564.16 650.42,-1582.11 670,-1610.76 738.31,-1710.72 621.97,-1793.61 706,-1880.76 728,-1903.58 765.03,-1907.18 792.72,-1906.07"/>
<polygon fill="#000fff" stroke="#000fff" points="793.06,-1909.55 802.83,-1905.44 792.63,-1902.57 793.06,-1909.55"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge81" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#000fff" d="M554.76,-1529.48C577.77,-1501.48 638.57,-1432.86 706,-1400.76 715.73,-1396.13 726.33,-1392.51 737.09,-1389.67"/>
<polygon fill="#000fff" stroke="#000fff" points="738.09,-1393.03 747,-1387.28 736.45,-1386.22 738.09,-1393.03"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_node54" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node54"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="910.5,-1635.76 749.5,-1635.76 749.5,-1611.76 910.5,-1611.76 910.5,-1635.76"/>
<text text-anchor="middle" x="830" y="-1621.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_edge82" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#000fff" d="M601.19,-1553.77C623.23,-1559.55 648.38,-1567.49 670,-1577.76 687.59,-1586.13 687.97,-1595.39 706,-1602.76 716.55,-1607.07 727.95,-1610.5 739.42,-1613.22"/>
<polygon fill="#000fff" stroke="#000fff" points="738.97,-1616.71 749.49,-1615.44 740.47,-1609.87 738.97,-1616.71"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge83" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#000fff" d="M644.19,-1543.83C757.23,-1546.18 939.69,-1549.97 1043.36,-1552.13"/>
<polygon fill="#000fff" stroke="#000fff" points="1043.38,-1555.63 1053.45,-1552.34 1043.53,-1548.63 1043.38,-1555.63"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge84" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#000fff" d="M553.97,-1529.61C581.72,-1492.3 666.74,-1380.68 706,-1358.76 709.32,-1356.91 712.75,-1355.22 716.28,-1353.66"/>
<polygon fill="#000fff" stroke="#000fff" points="717.81,-1356.82 725.81,-1349.87 715.23,-1350.32 717.81,-1356.82"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_node67" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node67"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="907,-1593.76 753,-1593.76 753,-1569.76 907,-1569.76 907,-1593.76"/>
<text text-anchor="middle" x="830" y="-1579.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_edge85" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#000fff" d="M630.21,-1553.76C665.75,-1558.77 706.98,-1564.58 742.65,-1569.6"/>
<polygon fill="#000fff" stroke="#000fff" points="742.16,-1573.07 752.55,-1571 743.13,-1566.14 742.16,-1573.07"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge86" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#1f00ff" d="M627.74,-1337.8C641.92,-1340.39 656.44,-1343.39 670,-1346.76 686.37,-1350.84 689.64,-1354.67 706,-1358.76 716.3,-1361.34 727.16,-1363.7 737.99,-1365.84"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="737.44,-1369.29 747.91,-1367.73 738.75,-1362.42 737.44,-1369.29"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge87" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#1f00ff" d="M642.34,-1329.88C663.5,-1330.77 686.14,-1331.73 708.09,-1332.65"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="707.99,-1336.15 718.12,-1333.08 708.28,-1329.16 707.99,-1336.15"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node68" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node68"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="902,-1307.76 758,-1307.76 758,-1283.76 902,-1283.76 902,-1307.76"/>
<text text-anchor="middle" x="830" y="-1293.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge88" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#1f00ff" d="M642.34,-1315.48C676.68,-1311.85 714.9,-1307.82 747.77,-1304.34"/>
<polygon fill="#1f00ff" stroke="#1f00ff" points="748.21,-1307.82 757.79,-1303.29 747.48,-1300.86 748.21,-1307.82"/>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge93" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#4f00ff" d="M586.42,-942.7C618.78,-933.58 664.98,-921.23 706,-912.76 815.21,-890.22 852.42,-920.76 954,-874.76 1018,-845.79 1077.02,-785.33 1104.99,-753.83"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="1107.78,-755.95 1111.72,-746.12 1102.51,-751.35 1107.78,-755.95"/>
</g>
<!-- header -->
<g id="proc~~compute_mbe~~CallsGraph_node36" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="857,-1029.76 803,-1029.76 803,-1005.76 857,-1005.76 857,-1029.76"/>
<text text-anchor="middle" x="830" y="-1015.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~compute_mbe~~CallsGraph_edge89" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#4f00ff" d="M587.13,-966.82C619.48,-975.81 665.34,-988.01 706,-996.76 735.09,-1003.03 768.38,-1008.62 792.98,-1012.45"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="792.54,-1015.92 802.96,-1013.98 793.61,-1009.01 792.54,-1015.92"/>
</g>
<!-- level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node37" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="867,-987.76 793,-987.76 793,-963.76 867,-963.76 867,-987.76"/>
<text text-anchor="middle" x="830" y="-973.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge90" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#4f00ff" d="M619.25,-960.25C670.98,-964.08 738.38,-969.06 782.63,-972.33"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="782.58,-975.84 792.81,-973.09 783.09,-968.86 782.58,-975.84"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node61" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node61"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="892,-865.76 768,-865.76 768,-841.76 892,-841.76 892,-865.76"/>
<text text-anchor="middle" x="830" y="-851.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge91" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#4f00ff" d="M566.74,-942.68C597.08,-926.28 654.23,-897.04 706,-879.76 722.53,-874.25 740.71,-869.64 757.9,-865.92"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="758.82,-869.3 767.9,-863.83 757.39,-862.45 758.82,-869.3"/>
</g>
<!-- verbose -->
<g id="proc~~compute_mbe~~CallsGraph_node70" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="857.5,-945.76 802.5,-945.76 802.5,-921.76 857.5,-921.76 857.5,-945.76"/>
<text text-anchor="middle" x="830" y="-931.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~compute_mbe~~CallsGraph_edge92" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#4f00ff" d="M619.25,-949.27C674.82,-945.16 748.47,-939.72 792.08,-936.49"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="792.52,-939.97 802.23,-935.74 792,-932.99 792.52,-939.97"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge94" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#7f00ff" d="M557.83,-415.94C583.79,-441.39 642.4,-503.25 670,-567.76 710.18,-661.68 633.58,-722.72 706,-794.76 785.05,-873.41 872.47,-756.69 954,-832.76 1007.29,-882.49 936.45,-943.31 990,-992.76 1077.73,-1073.79 1168.69,-949.29 1256,-1030.76 1311.83,-1082.86 1252.63,-1133.33 1292,-1198.76 1312.86,-1233.44 1350.62,-1261.59 1377.28,-1278.47"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1375.51,-1281.49 1385.85,-1283.75 1379.18,-1275.53 1375.51,-1281.49"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge95" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#7f00ff" d="M632.75,-400.48C646.2,-396.86 659.19,-391.26 670,-382.76 701.93,-357.66 681.29,-331 706,-298.76 731.71,-265.21 771.55,-236.65 798.87,-219.38"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="800.96,-222.2 807.62,-213.97 797.28,-216.25 800.96,-222.2"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge99" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#7f00ff" d="M632.84,-397.49C736.84,-391.76 902.44,-388.45 954,-420.76 1062.48,-488.75 1105.49,-652.28 1117.89,-711.7"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1114.46,-712.42 1119.85,-721.54 1121.32,-711.05 1114.46,-712.42"/>
</g>
<!-- proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_node60" class="node">
<title>proc~get_basename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node60"><a xlink:href="../proc/get_basename.html" xlink:title="get_basename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="875.5,-331.76 784.5,-331.76 784.5,-307.76 875.5,-307.76 875.5,-331.76"/>
<text text-anchor="middle" x="830" y="-317.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_basename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_edge96" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#7f00ff" d="M632.73,-397.02C645.75,-393.79 658.6,-389.2 670,-382.76 691.4,-370.67 684.61,-352.89 706,-340.76 726.59,-329.09 752.01,-323.56 774.39,-321.05"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="774.8,-324.53 784.43,-320.1 774.14,-317.56 774.8,-324.53"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge97" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#7f00ff" d="M557.94,-415.89C584.09,-441.26 643.04,-502.98 670,-567.76 714.83,-675.46 626.48,-742.41 706,-827.76 719.37,-842.11 738.5,-849.59 757.71,-853.25"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="757.3,-856.73 767.73,-854.84 758.4,-849.82 757.3,-856.73"/>
</g>
<!-- proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_node63" class="node">
<title>proc~get_output_json_filename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node63"><a xlink:href="../proc/get_output_json_filename.html" xlink:title="get_output_json_filename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="904.5,-373.76 755.5,-373.76 755.5,-349.76 904.5,-349.76 904.5,-373.76"/>
<text text-anchor="middle" x="830" y="-359.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_output_json_filename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_edge98" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#7f00ff" d="M626.38,-391.73C663.7,-386.21 707.89,-379.67 745.46,-374.12"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="745.99,-377.58 755.37,-372.65 744.96,-370.65 745.99,-377.58"/>
</g>
<!-- proc~print_mbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge100" class="edge">
<title>proc~print_mbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#af00ff" d="M574.06,-307.69C626.45,-285.92 736.55,-240.18 793.38,-216.56"/>
<polygon fill="#af00ff" stroke="#af00ff" points="794.79,-219.77 802.68,-212.7 792.11,-213.3 794.79,-219.77"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge101" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#df00ff" d="M615.23,-94.28C633.4,-98.1 652.71,-103.16 670,-109.76 720.44,-129.03 773.7,-163.04 803.99,-183.88"/>
<polygon fill="#df00ff" stroke="#df00ff" points="802.06,-186.8 812.27,-189.64 806.06,-181.05 802.06,-186.8"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge102" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#df00ff" d="M615.14,-80.43C774.92,-74.33 1159.62,-68.5 1256,-147.76 1336.21,-213.73 1390.94,-553.4 1404.32,-644.34"/>
<polygon fill="#df00ff" stroke="#df00ff" points="1400.88,-644.99 1405.78,-654.39 1407.81,-643.99 1400.88,-644.99"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge103" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;info</title>
<path fill="none" stroke="#ff00ef" d="M293.04,-247.73C325.89,-238.04 374.55,-225.04 418,-218.76 555.15,-198.94 720.51,-199.4 792.53,-200.79"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="792.79,-204.29 802.86,-201 792.94,-197.29 792.79,-204.29"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~compute_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_edge104" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~compute_thermochemistry</title>
<path fill="none" stroke="#ff00ef" d="M265.11,-271.86C308.32,-321.13 471.27,-506.97 525.4,-568.7"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="523.07,-571.34 532.29,-576.55 528.33,-566.73 523.07,-571.34"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge107" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;warning</title>
<path fill="none" stroke="#ff00ef" d="M327.53,-261.71C501.72,-266.65 928.98,-280.56 954,-298.76 1094.44,-400.94 1117.48,-637.33 1121.26,-711.25"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="1117.78,-711.84 1121.71,-721.68 1124.77,-711.53 1117.78,-711.84"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_node52" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node52"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1490,-780.76 1327,-780.76 1327,-756.76 1490,-756.76 1490,-780.76"/>
<text text-anchor="middle" x="1408.5" y="-766.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_edge105" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#ff00ef" d="M279.27,-247.65C310.69,-232.92 366.94,-208.68 418,-197.76 651.07,-147.91 721.04,-130.39 954,-180.76 1098.06,-211.91 1170.25,-197.89 1256,-317.76 1352.13,-452.14 1208.75,-545.05 1292,-687.76 1309.33,-717.47 1342.41,-738.96 1368.74,-752.31"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="1367.21,-755.46 1377.73,-756.69 1370.28,-749.17 1367.21,-755.46"/>
</g>
<!-- proc~print_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_node65" class="node">
<title>proc~print_thermochemistry</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node65"><a xlink:href="../proc/print_thermochemistry.html" xlink:title="print_thermochemistry">
<polygon fill="#d9534f" stroke="#d9534f" points="611,-251.76 477,-251.76 477,-227.76 611,-227.76 611,-251.76"/>
<text text-anchor="middle" x="544" y="-237.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_thermochemistry</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~print_thermochemistry -->
<g id="proc~~compute_mbe~~CallsGraph_edge106" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~print_thermochemistry</title>
<path fill="none" stroke="#ff00ef" d="M327.67,-254.69C370.17,-251.74 423.65,-248.04 466.67,-245.05"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="467.08,-248.54 476.81,-244.35 466.59,-241.55 467.08,-248.54"/>
</g>
<!-- proc~print_vibrational_json_mbe&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge108" class="edge">
<title>proc~print_vibrational_json_mbe&#45;&gt;error</title>
<path fill="none" stroke="#ff00bf" d="M622.22,-357.36C638.73,-354.12 655.54,-348.94 670,-340.76 691.4,-328.67 683.66,-309.04 706,-298.76 806.14,-252.71 855.74,-248.82 954,-298.76 1157.03,-401.97 1177.46,-498.98 1256,-712.76 1293.35,-814.42 1242.66,-1102.36 1292,-1198.76 1310.22,-1234.37 1347.81,-1262.01 1375.18,-1278.53"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1373.62,-1281.67 1384.02,-1283.69 1377.15,-1275.63 1373.62,-1281.67"/>
</g>
<!-- proc~print_vibrational_json_mbe&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge109" class="edge">
<title>proc~print_vibrational_json_mbe&#45;&gt;info</title>
<path fill="none" stroke="#ff00bf" d="M622.04,-360.45C639.1,-357.14 656.19,-351.15 670,-340.76 699.55,-318.54 680.28,-292.33 706,-265.76 730.31,-240.66 766.6,-223.45 793.47,-213.25"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="794.71,-216.52 802.9,-209.81 792.31,-209.94 794.71,-216.52"/>
</g>
<!-- proc~print_vibrational_json_mbe&#45;&gt;proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_edge110" class="edge">
<title>proc~print_vibrational_json_mbe&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#ff00bf" d="M622.23,-350.34C670.28,-343.24 730.93,-334.27 774.09,-327.88"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="774.73,-331.33 784.11,-326.4 773.71,-324.4 774.73,-331.33"/>
</g>
<!-- proc~print_vibrational_json_mbe&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_edge111" class="edge">
<title>proc~print_vibrational_json_mbe&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#ff00bf" d="M622.23,-361.76C660.23,-361.76 706.1,-361.76 744.97,-361.76"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="745.21,-365.26 755.21,-361.76 745.21,-358.26 745.21,-365.26"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_edge116" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#ffa500" d="M913.21,-1380C928.34,-1383.62 942.86,-1390 954,-1400.76 1010.81,-1455.62 936.73,-1516.46 990,-1574.76 1002.27,-1588.19 1018.87,-1597.17 1036.16,-1603.16"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1035.22,-1606.53 1045.81,-1606.19 1037.32,-1599.85 1035.22,-1606.53"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge117" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#ffa500" d="M913.22,-1382.2C927.91,-1385.72 942.26,-1391.51 954,-1400.76 985.9,-1425.91 962.4,-1454.96 990,-1484.76 1012.87,-1509.46 1046.6,-1526.88 1074.24,-1538.04"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1073.15,-1541.37 1083.74,-1541.72 1075.69,-1534.84 1073.15,-1541.37"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node73" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node73"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1182,-1433.76 1064,-1433.76 1064,-1409.76 1182,-1409.76 1182,-1433.76"/>
<text text-anchor="middle" x="1123" y="-1419.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge112" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#ffa500" d="M913.22,-1391.63C957.63,-1398.04 1011.8,-1405.86 1053.84,-1411.93"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1053.58,-1415.42 1063.97,-1413.39 1054.58,-1408.5 1053.58,-1415.42"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_node76" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node76"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1207.5,-1349.76 1038.5,-1349.76 1038.5,-1325.76 1207.5,-1325.76 1207.5,-1349.76"/>
<text text-anchor="middle" x="1123" y="-1335.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_edge113" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#ffa500" d="M913.22,-1367.9C949.09,-1362.72 991.34,-1356.62 1028.41,-1351.27"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1029.32,-1354.68 1038.72,-1349.78 1028.32,-1347.75 1029.32,-1354.68"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_node77" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node77"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="1191.5,-1307.76 1054.5,-1307.76 1054.5,-1283.76 1191.5,-1283.76 1191.5,-1307.76"/>
<text text-anchor="middle" x="1123" y="-1293.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_edge114" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#ffa500" d="M913.13,-1373.88C927.36,-1370.62 941.56,-1365.81 954,-1358.76 975.39,-1346.64 968.54,-1328.76 990,-1316.76 1006.39,-1307.59 1025.62,-1302.12 1044.25,-1298.93"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1044.85,-1302.38 1054.21,-1297.42 1043.8,-1295.46 1044.85,-1302.38"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node78" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node78"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1187,-1391.76 1059,-1391.76 1059,-1367.76 1187,-1367.76 1187,-1391.76"/>
<text text-anchor="middle" x="1123" y="-1377.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge115" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#ffa500" d="M913.22,-1379.76C955.83,-1379.76 1007.43,-1379.76 1048.67,-1379.76"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1048.92,-1383.26 1058.92,-1379.76 1048.92,-1376.26 1048.92,-1383.26"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_node81" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node81"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="1256,-1475.76 990,-1475.76 990,-1451.76 1256,-1451.76 1256,-1475.76"/>
<text text-anchor="middle" x="1123" y="-1461.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_edge118" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#ffa500" d="M913.13,-1385.65C927.36,-1388.9 941.56,-1393.71 954,-1400.76 975.39,-1412.89 968.54,-1430.76 990,-1442.76 993.34,-1444.63 996.79,-1446.34 1000.33,-1447.91"/>
<polygon fill="#ffa500" stroke="#ffa500" points="999.3,-1451.27 1009.89,-1451.75 1001.91,-1444.78 999.3,-1451.27"/>
</g>
<!-- proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_node79" class="node">
<title>proc~element_mass</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node79"><a xlink:href="../proc/element_mass.html" xlink:title="element_mass">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1453.5,-1023.76 1363.5,-1023.76 1363.5,-999.76 1453.5,-999.76 1453.5,-1023.76"/>
<text text-anchor="middle" x="1408.5" y="-1009.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_mass</text>
</a>
</g>
</g>
<!-- proc~compute_cartesian_displacements&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge119" class="edge">
<title>proc~compute_cartesian_displacements&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ffce00" d="M1216.53,-1081.76C1229.88,-1079.24 1243.37,-1076.26 1256,-1072.76 1297.55,-1061.25 1343.18,-1041.9 1373.4,-1028.08"/>
<polygon fill="#ffce00" stroke="#ffce00" points="1375.03,-1031.18 1382.64,-1023.8 1372.09,-1024.82 1375.03,-1031.18"/>
</g>
<!-- proc~compute_ir_intensities&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge120" class="edge">
<title>proc~compute_ir_intensities&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#b3ff00" d="M1189.04,-1042.59C1238.84,-1035.56 1306.72,-1025.98 1353.53,-1019.38"/>
<polygon fill="#b3ff00" stroke="#b3ff00" points="1354.07,-1022.84 1363.48,-1017.97 1353.09,-1015.91 1354.07,-1022.84"/>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge123" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;to_char</title>
<path fill="none" stroke="#89ff00" d="M915.6,-781.66C1002.79,-787.13 1141.72,-788.3 1256,-754.76 1305.46,-740.25 1355.83,-706.39 1384.23,-685.15"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1386.47,-687.85 1392.31,-679.01 1382.23,-682.27 1386.47,-687.85"/>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge124" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;warning</title>
<path fill="none" stroke="#89ff00" d="M915.56,-762.14C971.72,-754.42 1042.65,-744.67 1085.06,-738.84"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1085.77,-742.28 1095.2,-737.45 1084.82,-735.34 1085.77,-742.28"/>
</g>
<!-- pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_node72" class="node">
<title>pic_syev</title>
<polygon fill="#777777" stroke="#777777" points="1152,-890.76 1094,-890.76 1094,-866.76 1152,-866.76 1152,-890.76"/>
<text text-anchor="middle" x="1123" y="-876.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_syev</text>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_edge121" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;pic_syev</title>
<path fill="none" stroke="#89ff00" d="M915.6,-785.05C928.9,-788.67 942.16,-793.45 954,-799.76 973.69,-810.26 970.94,-823.17 990,-834.76 1019.19,-852.52 1056.41,-864.09 1083.89,-870.88"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1083.37,-874.36 1093.9,-873.26 1084.98,-867.54 1083.37,-874.36"/>
</g>
<!-- proc~compute_moments_of_inertia&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge122" class="edge">
<title>proc~compute_moments_of_inertia&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#89ff00" d="M915.65,-780.87C1024.47,-791.6 1205.45,-815.33 1256,-857.76 1289.95,-886.26 1262.54,-917.65 1292,-950.76 1310.28,-971.31 1337.17,-986.08 1360.4,-995.94"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1359.18,-999.22 1369.76,-999.73 1361.81,-992.73 1359.18,-999.22"/>
</g>
<!-- proc~compute_reduced_masses&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge125" class="edge">
<title>proc~compute_reduced_masses&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#37ff00" d="M1200.22,-1129.45C1218.9,-1126.34 1238.53,-1121.69 1256,-1114.76 1307.18,-1094.47 1358.41,-1054.53 1386.23,-1030.79"/>
<polygon fill="#37ff00" stroke="#37ff00" points="1388.82,-1033.18 1394.08,-1023.98 1384.23,-1027.89 1388.82,-1033.18"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge126" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;error</title>
<path fill="none" stroke="#00ff6e" d="M925.04,-1064.44C935.64,-1068.14 945.63,-1073.39 954,-1080.76 995.15,-1117 948.69,-1162.71 990,-1198.76 1080.23,-1277.5 1140.01,-1211.98 1256,-1241.76 1296.63,-1252.2 1341.75,-1268.98 1372.1,-1281.07"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="1370.82,-1284.33 1381.41,-1284.82 1373.44,-1277.84 1370.82,-1284.33"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge130" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;warning</title>
<path fill="none" stroke="#00ff6e" d="M925.15,-1056.09C935.87,-1052.26 945.85,-1046.7 954,-1038.76 1012.78,-981.56 950.21,-929.49 990,-857.76 1015.4,-811.97 1063.63,-773.27 1094.22,-751.83"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="1096.47,-754.53 1102.73,-745.99 1092.5,-748.76 1096.47,-754.53"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_edge127" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;pic_syev</title>
<path fill="none" stroke="#00ff6e" d="M925.22,-1055.29C935.8,-1051.56 945.72,-1046.24 954,-1038.76 998.48,-998.57 946.63,-950.16 990,-908.76 1014.83,-885.06 1054.3,-878.64 1083.62,-877.5"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="1083.98,-880.99 1093.91,-877.29 1083.84,-873.99 1083.98,-880.99"/>
</g>
<!-- proc~mass_weight_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node82" class="node">
<title>proc~mass_weight_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node82"><a xlink:href="../proc/mass_weight_hessian.html" xlink:title="mass_weight_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="1186.5,-983.76 1059.5,-983.76 1059.5,-959.76 1186.5,-959.76 1186.5,-983.76"/>
<text text-anchor="middle" x="1123" y="-969.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mass_weight_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge128" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian</title>
<path fill="none" stroke="#00ff6e" d="M915.55,-1047.75C928.53,-1045.21 941.7,-1042.23 954,-1038.76 1001.46,-1025.41 1053.89,-1003.24 1087.35,-988.08"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="1089.04,-991.16 1096.68,-983.81 1086.13,-984.79 1089.04,-991.16"/>
</g>
<!-- proc~project_translation_rotation -->
<g id="proc~~compute_mbe~~CallsGraph_node84" class="node">
<title>proc~project_translation_rotation</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node84"><a xlink:href="../proc/project_translation_rotation.html" xlink:title="project_translation_rotation">
<polygon fill="#d9534f" stroke="#d9534f" points="1202,-941.76 1044,-941.76 1044,-917.76 1202,-917.76 1202,-941.76"/>
<text text-anchor="middle" x="1123" y="-927.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">project_translation_rotation</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation -->
<g id="proc~~compute_mbe~~CallsGraph_edge129" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation</title>
<path fill="none" stroke="#00ff6e" d="M925.03,-1054.12C935.51,-1050.57 945.46,-1045.61 954,-1038.76 986.97,-1012.33 956.88,-977.01 990,-950.76 1002.65,-940.74 1018.17,-934.61 1034.07,-931"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="1034.85,-934.42 1044,-929.07 1033.51,-927.55 1034.85,-934.42"/>
</g>
<!-- proc~compute_zpe&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge131" class="edge">
<title>proc~compute_zpe&#45;&gt;to_char</title>
<path fill="none" stroke="#00ffc0" d="M872.04,-446.12C896.25,-449.35 927.27,-454.61 954,-462.76 1120.36,-513.48 1305.73,-610.71 1377.17,-649.83"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="1375.64,-652.99 1386.09,-654.74 1379.01,-646.86 1375.64,-652.99"/>
</g>
<!-- proc~compute_zpe&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge132" class="edge">
<title>proc~compute_zpe&#45;&gt;warning</title>
<path fill="none" stroke="#00ffc0" d="M872.06,-440.49C897.59,-441.6 930.01,-446.61 954,-462.76 966.12,-470.92 1072.59,-650.07 1109.48,-712.52"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="1106.68,-714.66 1114.78,-721.5 1112.71,-711.11 1106.68,-714.66"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge133" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#00c0ff" d="M909.68,-1611.71C924.46,-1609.06 939.75,-1606.05 954,-1602.76 976.56,-1597.56 1031.82,-1581.18 1072.84,-1568.78"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="1074.11,-1572.05 1082.67,-1565.8 1072.08,-1565.35 1074.11,-1572.05"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node75" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node75"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1237.5,-1189.76 1008.5,-1189.76 1008.5,-1165.76 1237.5,-1165.76 1237.5,-1189.76"/>
<text text-anchor="middle" x="1123" y="-1175.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge134" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#006eff" d="M934.24,-1325.74C941.12,-1323.25 947.78,-1320.29 954,-1316.76 975.39,-1304.64 971.98,-1291.49 990,-1274.76 1023.3,-1243.87 1066.43,-1213.77 1094.16,-1195.5"/>
<polygon fill="#006eff" stroke="#006eff" points="1096.13,-1198.39 1102.59,-1189.99 1092.3,-1192.53 1096.13,-1198.39"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_node71" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="1162.5,-1895.76 1083.5,-1895.76 1083.5,-1871.76 1162.5,-1871.76 1162.5,-1895.76"/>
<text text-anchor="middle" x="1123" y="-1881.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge135" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#0044ff" d="M566.59,-1695.86C597,-1712.54 654.47,-1742.8 706,-1762.76 774.26,-1789.21 979.24,-1845.4 1073.55,-1870.81"/>
<polygon fill="#0044ff" stroke="#0044ff" points="1072.84,-1874.24 1083.4,-1873.46 1074.66,-1867.48 1072.84,-1874.24"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node74" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node74"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="894,-1715.76 766,-1715.76 766,-1691.76 894,-1691.76 894,-1715.76"/>
<text text-anchor="middle" x="830" y="-1701.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge136" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#0044ff" d="M663.39,-1692.1C694.7,-1694.31 727.59,-1696.62 755.73,-1698.6"/>
<polygon fill="#0044ff" stroke="#0044ff" points="755.65,-1702.11 765.87,-1699.32 756.14,-1695.12 755.65,-1702.11"/>
</g>
<!-- sort -->
<g id="proc~~compute_mbe~~CallsGraph_node85" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="1150,-1815.76 1096,-1815.76 1096,-1791.76 1150,-1791.76 1150,-1815.76"/>
<text text-anchor="middle" x="1123" y="-1801.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge137" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#0044ff" d="M589.24,-1695.81C621.49,-1704.4 666.3,-1715.95 706,-1724.76 845.54,-1755.75 1013.09,-1785.24 1085.61,-1797.63"/>
<polygon fill="#0044ff" stroke="#0044ff" points="1085.16,-1801.1 1095.6,-1799.33 1086.33,-1794.2 1085.16,-1801.1"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node83" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node83"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1182,-2111.76 1064,-2111.76 1064,-2087.76 1182,-2087.76 1182,-2111.76"/>
<text text-anchor="middle" x="1123" y="-2097.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge138" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#001bff" d="M947.68,-2099.76C983.64,-2099.76 1022.04,-2099.76 1053.62,-2099.76"/>
<polygon fill="#001bff" stroke="#001bff" points="1053.63,-2103.26 1063.63,-2099.76 1053.63,-2096.26 1053.63,-2103.26"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge139" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#0d00ff" d="M928.15,-2007.67C937.38,-2004.09 946.19,-1999.54 954,-1993.76 980.55,-1974.13 964.67,-1949.96 990,-1928.76 1013.63,-1908.99 1046.38,-1897.76 1073.35,-1891.46"/>
<polygon fill="#0d00ff" stroke="#0d00ff" points="1074.34,-1894.82 1083.37,-1889.28 1072.85,-1887.98 1074.34,-1894.82"/>
</g>
<!-- proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_node80" class="node">
<title>proc~error_set</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node80"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1461,-1711.76 1356,-1711.76 1356,-1687.76 1461,-1687.76 1461,-1711.76"/>
<text text-anchor="middle" x="1408.5" y="-1697.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_edge140" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#0d00ff" d="M954.44,-2008.88C1044.75,-1995.86 1166.59,-1967.31 1256,-1904.76 1326.52,-1855.43 1377.32,-1762.75 1397.67,-1721.05"/>
<polygon fill="#0d00ff" stroke="#0d00ff" points="1400.92,-1722.36 1402.08,-1711.83 1394.61,-1719.34 1400.92,-1722.36"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge141" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#0d00ff" d="M933.54,-2007.68C941.01,-2004.02 947.96,-1999.45 954,-1993.76 997.95,-1952.37 950.67,-1908.58 990,-1862.76 1014.64,-1834.05 1056.03,-1818.7 1085.9,-1810.92"/>
<polygon fill="#0d00ff" stroke="#0d00ff" points="1087.05,-1814.25 1095.93,-1808.48 1085.39,-1807.45 1087.05,-1814.25"/>
</g>
<!-- proc~print_thermochemistry&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge142" class="edge">
<title>proc~print_thermochemistry&#45;&gt;info</title>
<path fill="none" stroke="#ff00f8" d="M611.23,-230.9C667.79,-223.33 747.05,-212.73 792.7,-206.62"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="793.29,-210.07 802.73,-205.28 792.36,-203.14 793.29,-210.07"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node87" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node87"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1525,-1189.76 1292,-1189.76 1292,-1165.76 1525,-1165.76 1525,-1189.76"/>
<text text-anchor="middle" x="1408.5" y="-1175.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge143" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#65ff00" d="M1237.68,-1177.76C1252.2,-1177.76 1267.12,-1177.76 1281.82,-1177.76"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1281.95,-1181.26 1291.95,-1177.76 1281.95,-1174.26 1281.95,-1181.26"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_node88" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node88"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1448,-1349.76 1369,-1349.76 1369,-1325.76 1448,-1325.76 1448,-1349.76"/>
<text text-anchor="middle" x="1408.5" y="-1335.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_edge144" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#00ff00" d="M1207.53,-1337.76C1256.76,-1337.76 1317.34,-1337.76 1358.84,-1337.76"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1358.96,-1341.26 1368.96,-1337.76 1358.96,-1334.26 1358.96,-1341.26"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge145" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#00ff66" d="M1191.55,-1295.76C1247.8,-1295.76 1325.76,-1295.76 1370.99,-1295.76"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1371.21,-1299.26 1381.21,-1295.76 1371.21,-1292.26 1371.21,-1299.26"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge148" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#00ff66" d="M1152.67,-1283.65C1184.05,-1268.72 1232.95,-1240.13 1256,-1198.76 1353.88,-1023.11 1192.19,-922.32 1292,-747.76 1309.84,-716.57 1345.16,-694.53 1372.07,-681.39"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1373.63,-684.53 1381.2,-677.12 1370.66,-678.19 1373.63,-684.53"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_edge146" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#00ff66" d="M1151.78,-1283.73C1182.83,-1268.7 1231.91,-1239.86 1256,-1198.76 1321.69,-1086.72 1240.63,-1028.05 1292,-908.76 1313.55,-858.72 1358.69,-812.4 1385.72,-787.61"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1388.06,-790.21 1393.15,-780.92 1383.38,-785.01 1388.06,-790.21"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_edge147" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#00ff66" d="M1191.82,-1293.55C1214.28,-1295.99 1238.08,-1302.39 1256,-1316.76 1316.09,-1364.95 1382.34,-1603.29 1401.82,-1677.6"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1398.54,-1678.9 1404.45,-1687.7 1405.32,-1677.14 1398.54,-1678.9"/>
</g>
<!-- proc~mass_weight_hessian&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge149" class="edge">
<title>proc~mass_weight_hessian&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#6500ff" d="M1186.57,-980.59C1236.39,-987.62 1305.44,-997.36 1353.02,-1004.08"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1352.74,-1007.57 1363.13,-1005.5 1353.72,-1000.64 1352.74,-1007.57"/>
</g>
<!-- proc~project_translation_rotation&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge151" class="edge">
<title>proc~project_translation_rotation&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ff00cb" d="M1202.1,-939.21C1219.98,-942.19 1238.78,-945.99 1256,-950.76 1297.55,-962.27 1343.18,-981.63 1373.4,-995.45"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1372.09,-998.7 1382.64,-999.73 1375.03,-992.35 1372.09,-998.7"/>
</g>
<!-- pic_gesvd -->
<g id="proc~~compute_mbe~~CallsGraph_node86" class="node">
<title>pic_gesvd</title>
<polygon fill="#777777" stroke="#777777" points="1441,-941.76 1376,-941.76 1376,-917.76 1441,-917.76 1441,-941.76"/>
<text text-anchor="middle" x="1408.5" y="-927.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_gesvd</text>
</g>
<!-- proc~project_translation_rotation&#45;&gt;pic_gesvd -->
<g id="proc~~compute_mbe~~CallsGraph_edge150" class="edge">
<title>proc~project_translation_rotation&#45;&gt;pic_gesvd</title>
<path fill="none" stroke="#ff00cb" d="M1202.22,-929.76C1255.06,-929.76 1322.75,-929.76 1365.64,-929.76"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1365.72,-933.26 1375.72,-929.76 1365.72,-926.26 1365.72,-933.26"/>
</g>
<!-- proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node89" class="node">
<title>proc~cgto_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node89"><a xlink:href="../proc/cgto_destroy.html" xlink:title="cgto_type%cgto_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1703,-1189.76 1561,-1189.76 1561,-1165.76 1703,-1165.76 1703,-1189.76"/>
<text text-anchor="middle" x="1632" y="-1175.36" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cgto_type%cgto_destroy</text>
</a>
</g>
</g>
<!-- proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge152" class="edge">
<title>proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy</title>
<path fill="none" stroke="#00ff00" d="M1525.12,-1177.76C1533.77,-1177.76 1542.38,-1177.76 1550.74,-1177.76"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1550.79,-1181.26 1560.79,-1177.76 1550.79,-1174.26 1550.79,-1181.26"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCallsGraph = svgPanZoom('#proccompute_mbeCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CalledByGraph Pages: 1 -->
<svg id="proccompute_mbeCalledByGraph" width="641pt" height="72pt"
 viewBox="0.00 0.00 641.00 72.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CalledByGraph" class="graph" transform="scale(0.62 0.62) rotate(0) translate(4 112)">
<title>proc~~compute_mbe~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 1025,-112 1025,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="1021,-66 932,-66 932,-42 1021,-42 1021,-66"/>
<text text-anchor="middle" x="976.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node2" class="node">
<title>proc~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node2"><a xlink:href="../proc/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="875.5,-87 762.5,-87 762.5,-63 875.5,-63 875.5,-87"/>
<text text-anchor="middle" x="819" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge1" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M875.7,-67.48C890.71,-65.45 906.92,-63.26 921.82,-61.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="922.45,-64.7 931.89,-59.89 921.51,-57.76 922.45,-64.7"/>
</g>
<!-- proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node3" class="node">
<title>proc~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node3"><a xlink:href="../proc/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#d9534f" stroke="#d9534f" points="896,-45 742,-45 742,-21 896,-21 896,-45"/>
<text text-anchor="middle" x="819" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge2" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M896.38,-43.32C904.92,-44.47 913.47,-45.62 921.64,-46.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="921.36,-50.22 931.74,-48.09 922.3,-43.28 921.36,-50.22"/>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node4" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node4"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="685.5,-87 572.5,-87 572.5,-63 685.5,-63 685.5,-87"/>
<text text-anchor="middle" x="629" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge3" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M685.64,-75C706.58,-75 730.58,-75 752.35,-75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="752.5,-78.5 762.5,-75 752.5,-71.5 752.5,-78.5"/>
</g>
<!-- interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node5" class="node">
<title>interface~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node5"><a xlink:href="../interface/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#a7506f" stroke="#a7506f" points="706,-45 552,-45 552,-21 706,-21 706,-45"/>
<text text-anchor="middle" x="629" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge4" class="edge">
<title>interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M706.2,-33C714.52,-33 723.03,-33 731.47,-33"/>
<polygon fill="#00ffff" stroke="#00ffff" points="731.7,-36.5 741.7,-33 731.7,-29.5 731.7,-36.5"/>
</g>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node6" class="node">
<title>proc~run_fragmented_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node6"><a xlink:href="../proc/run_fragmented_calculation.html" xlink:title="run_fragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="516,-66 353,-66 353,-42 516,-42 516,-66"/>
<text text-anchor="middle" x="434.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_fragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge5" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M516.02,-62.78C531.42,-64.46 547.38,-66.21 562.25,-67.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="562.03,-71.32 572.35,-68.93 562.79,-64.37 562.03,-71.32"/>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge6" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" d="M516.02,-45.22C524.54,-44.29 533.22,-43.34 541.8,-42.4"/>
<polygon fill="#00ffff" stroke="#00ffff" points="542.24,-45.88 551.8,-41.31 541.48,-38.92 542.24,-45.88"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node7" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node7"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-66 223,-66 223,-42 317,-42 317,-66"/>
<text text-anchor="middle" x="270" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge7" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M317.13,-54C325.24,-54 333.94,-54 342.78,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.8,-57.5 352.8,-54 342.8,-50.5 342.8,-57.5"/>
</g>
<!-- proc~compute_energy_and_forces -->
<g id="proc~~compute_mbe~~CalledByGraph_node8" class="node">
<title>proc~compute_energy_and_forces</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node8"><a xlink:href="../proc/compute_energy_and_forces.html" xlink:title="compute_energy_and_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="176.5,-108 10.5,-108 10.5,-84 176.5,-84 176.5,-108"/>
<text text-anchor="middle" x="93.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energy_and_forces</text>
</a>
</g>
</g>
<!-- proc~compute_energy_and_forces&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge8" class="edge">
<title>proc~compute_energy_and_forces&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M148.85,-83.92C161.39,-81.06 174.67,-77.98 187,-75 195.32,-72.99 204.09,-70.81 212.69,-68.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.82,-71.96 222.65,-66.11 212.1,-65.18 213.82,-71.96"/>
</g>
<!-- proc~run_multi_molecule_calculations -->
<g id="proc~~compute_mbe~~CalledByGraph_node9" class="node">
<title>proc~run_multi_molecule_calculations</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node9"><a xlink:href="../proc/run_multi_molecule_calculations.html" xlink:title="run_multi_molecule_calculations">
<polygon fill="#d9534f" stroke="#d9534f" points="187,-66 0,-66 0,-42 187,-42 187,-66"/>
<text text-anchor="middle" x="93.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_multi_molecule_calculations</text>
</a>
</g>
</g>
<!-- proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge9" class="edge">
<title>proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M187.11,-54C195.83,-54 204.48,-54 212.7,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.87,-57.5 222.87,-54 212.87,-50.5 212.87,-57.5"/>
</g>
<!-- program~main -->
<g id="proc~~compute_mbe~~CalledByGraph_node10" class="node">
<title>program~main</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node10"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="120.5,-24 66.5,-24 66.5,0 120.5,0 120.5,-24"/>
<text text-anchor="middle" x="93.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge10" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M120.86,-17.78C139.39,-21.9 164.75,-27.63 187,-33 195.32,-35.01 204.09,-37.19 212.69,-39.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.1,-42.82 222.65,-41.89 213.82,-36.04 212.1,-42.82"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCalledByGraph = svgPanZoom('#proccompute_mbeCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_dipole"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_dipole</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_dipole_derivs"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_dipole_derivs</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_grad"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_grad</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_hess"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_hess</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_log_level~3"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_log_level</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_e~2"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>delta_E</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_dipole_derivs~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_dipole_derivs</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                <p>(3, 3*total_atoms, fragment_count)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_dipoles~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_dipoles</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                <p>(3, fragment_count)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_gradients~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_gradients</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_hessians~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_hessians</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-do_detailed_print"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>do_detailed_print</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_size~4"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_size</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-hess_dim~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>hess_dim</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~43"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ir_intensities"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>ir_intensities</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                <p>IR intensities in km/mol</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lookup~7"></span>
              type(<a href='../type/fragment_lookup_t.html'>fragment_lookup_t</a>),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lookup</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nlevel~3"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nlevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sum_by_level~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>sum_by_level</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">subroutine </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Compute many-body expansion (MBE) energy with optional gradient, hessian, and dipole</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! This is the core routine that handles all MBE computations.</span>
<span class="w">      </span><span class="c">!! The caller pre-allocates desired components in mbe_result before calling:</span>
<span class="w">      </span><span class="c">!!   - mbe_result%gradient allocated: compute gradient (requires sys_geom)</span>
<span class="w">      </span><span class="c">!!   - mbe_result%hessian allocated: compute hessian (requires sys_geom)</span>
<span class="w">      </span><span class="c">!!   - mbe_result%dipole allocated: compute total dipole moment</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_result_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculation_result_t</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result_t</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_config_parser</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">bond_t</span>

<span class="w">      </span><span class="c">! Required arguments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">results</span><span class="p">(:)</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">mbe_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mbe_result</span><span class="w">  </span><span class="c">!! Pre-allocated by caller</span>

<span class="w">      </span><span class="c">! Optional arguments</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span><span class="w">  </span><span class="c">!! Required for gradient/hessian</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span><span class="w">             </span><span class="c">!! Bond info for H-cap handling</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span><span class="w">           </span><span class="c">!! MPI communicator for abort</span>

<span class="w">      </span><span class="c">! Local variables</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(:),</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(:),</span><span class="w"> </span><span class="n">energies</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_dipoles</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!! (3, fragment_count)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!! (3, 3*total_atoms, fragment_count)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ir_intensities</span><span class="p">(:)</span><span class="w">  </span><span class="c">!! IR intensities in km/mol</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">do_detailed_print</span><span class="p">,</span><span class="w"> </span><span class="n">compute_grad</span><span class="p">,</span><span class="w"> </span><span class="n">compute_hess</span><span class="p">,</span><span class="w"> </span><span class="n">compute_dipole</span><span class="p">,</span><span class="w"> </span><span class="n">compute_dipole_derivs</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">fragment_lookup_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lookup</span>

<span class="w">      </span><span class="c">! Determine what to compute based on allocated components in mbe_result</span>
<span class="w">      </span><span class="n">compute_grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_hess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">! Will be set true if all fragments have dipole_derivatives</span>

<span class="w">      </span><span class="c">! Validate inputs for gradient computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_gradient</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have gradient!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  error stop</span><span class="w"> </span><span class="s2">&quot;Missing gradient in compute_mbe_internal&quot;</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Validate inputs for hessian computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_hessian</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have Hessian!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  error stop</span><span class="w"> </span><span class="s2">&quot;Missing Hessian in compute_mbe_internal&quot;</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">hess_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Validate inputs for dipole computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have dipole - skipping dipole MBE&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="n">compute_dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">               </span><span class="k">exit</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Check if dipole derivatives are available (for IR intensities)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">compute_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_dipole_derivatives</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">compute_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">               </span><span class="k">exit</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Get logger configuration</span>
<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">configuration</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="n">do_detailed_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">current_log_level</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">verbose_level</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Allocate energy arrays (always needed)</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">max_level</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="n">sum_by_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="n">delta_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>

<span class="w">      </span><span class="c">! Extract total energies from results</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">         </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">energy</span><span class="p">%</span><span class="n">total</span><span class="p">()</span>
<span class="w">      </span><span class="k">end do</span>

<span class="w">      </span><span class="c">! Allocate gradient delta arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_gradients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate hessian delta arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">(</span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_hessians</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate dipole delta arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipoles</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_dipoles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate dipole derivative delta arrays if needed (for IR intensities)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipole_derivs</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_dipole_derivs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">))</span>
<span class="w">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Build hash table for fast fragment lookups</span>
<span class="w">      </span><span class="k">block</span>
<span class="k">         use </span><span class="n">mqc_error</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">error_t</span>
<span class="w">         </span><span class="k">type</span><span class="p">(</span><span class="n">error_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lookup_error</span>
<span class="w">         </span><span class="k">call </span><span class="n">build_mbe_lookup_table</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="n">lookup_error</span><span class="p">)</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lookup_error</span><span class="p">%</span><span class="n">has_error</span><span class="p">())</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to build lookup table: &quot;</span><span class="o">//</span><span class="n">lookup_error</span><span class="p">%</span><span class="n">get_message</span><span class="p">())</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               error stop</span><span class="w"> </span><span class="s2">&quot;Failed to build lookup table&quot;</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end if</span>
<span class="k">      end block</span>

<span class="w">      </span><span class="c">! Bottom-up computation: process fragments by size (1-body, then 2-body, etc.)</span>
<span class="w">      </span><span class="c">! This makes the algorithm independent of input fragment order</span>
<span class="w">      </span><span class="c">! We process by n-mer level to ensure all subsets are computed before they&#39;re needed</span>
<span class="w">      </span><span class="k">do </span><span class="n">nlevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Only process fragments of the current nlevel</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! 1-body: delta = value (no subsets to subtract)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_gradient</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">gradient</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                      </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_hessian</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                   </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! For 1-body, delta dipole is just the fragment dipole</span>
<span class="w">                  </span><span class="n">delta_dipoles</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">dipole</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! For 1-body, delta dipole derivatives are just the fragment values mapped to system</span>
<span class="w">                  </span><span class="k">call </span><span class="n">map_fragment_to_system_dipole_derivatives</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">dipole_derivatives</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">            else if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! n-body: delta = value - sum(all subset deltas)</span>
<span class="w">               </span><span class="n">delta_E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_mbe_delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_E</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_gradient</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_hessian</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_dipole</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                          </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dipoles</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_dipole_derivatives</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                      </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end do</span>

<span class="w">      </span><span class="c">! Clean up lookup table</span>
<span class="w">      </span><span class="k">call </span><span class="n">lookup</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>

<span class="w">      </span><span class="c">! Compute totals and set status flags</span>
<span class="w">      </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">)</span>
<span class="w">      </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_dipoles</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_dipole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_dipole_derivs</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">has_dipole_derivatives</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print energy breakdown (always)</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_mbe_energy_breakdown</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Print gradient info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_mbe_gradient_info</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">gradient</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print hessian info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MBE Hessian computation completed&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Total Hessian Frobenius norm: &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span>

<span class="w">         </span><span class="c">! Compute and print full vibrational analysis with thermochemistry</span>
<span class="w">         </span><span class="k">block</span>
<span class="k">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">frequencies</span><span class="p">(:),</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">(:),</span><span class="w"> </span><span class="n">force_constants</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">(:)</span>
<span class="w">            </span><span class="k">type</span><span class="p">(</span><span class="n">thermochemistry_result_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">thermo_result</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_at</span><span class="p">,</span><span class="w"> </span><span class="n">n_modes</span>

<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Computing vibrational analysis (projecting trans/rot modes)...&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole_derivs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">compute_vibrational_analysis</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">project_trans_rot</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">dipole_derivatives</span><span class="o">=</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole_derivatives</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">ir_intensities</span><span class="o">=</span><span class="n">ir_intensities</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">               call </span><span class="n">compute_vibrational_analysis</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">project_trans_rot</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                 </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">frequencies</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! Compute thermochemistry</span>
<span class="w">               </span><span class="n">n_at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">)</span>
<span class="w">               </span><span class="n">n_modes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="w">               </span><span class="k">call </span><span class="n">compute_thermochemistry</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">n_at</span><span class="p">,</span><span class="w"> </span><span class="n">n_modes</span><span class="p">,</span><span class="w"> </span><span class="n">thermo_result</span><span class="p">)</span>

<span class="w">               </span><span class="c">! Print vibrational analysis to log</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ir_intensities</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">print_vibrational_analysis</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">ir_intensities</span><span class="o">=</span><span class="n">ir_intensities</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">electronic_energy</span><span class="o">=</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="p">)</span>
<span class="w">                  </span><span class="c">! Write vibrational/thermochemistry JSON</span>
<span class="w">                  </span><span class="k">call </span><span class="n">print_vibrational_json_mbe</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">thermo_result</span><span class="p">,</span><span class="w"> </span><span class="n">ir_intensities</span><span class="p">)</span>
<span class="w">                  </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">ir_intensities</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  call </span><span class="n">print_vibrational_analysis</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">electronic_energy</span><span class="o">=</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">total_energy</span><span class="p">)</span>
<span class="w">                  </span><span class="c">! Write vibrational/thermochemistry JSON</span>
<span class="w">                  </span><span class="k">call </span><span class="n">print_vibrational_json_mbe</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                  </span><span class="n">thermo_result</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">               deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end block</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Print dipole info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_dipole</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         block</span>
<span class="k">            </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dipole_line</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dipole_magnitude</span>
<span class="w">            </span><span class="n">dipole_magnitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">norm2</span><span class="p">(</span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span><span class="p">)</span><span class="o">*</span><span class="mf">2.541746_dp</span><span class="w">  </span><span class="c">! Convert e*Bohr to Debye</span>
<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MBE Dipole moment:&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">dipole_line</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,3f15.8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;  Dipole (e*Bohr): &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">%</span><span class="n">dipole</span>
<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">dipole_line</span><span class="p">))</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">dipole_line</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a,f15.8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;  Dipole magnitude (Debye): &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dipole_magnitude</span>
<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">dipole_line</span><span class="p">))</span>
<span class="w">         </span><span class="k">end block</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Print detailed breakdown if requested</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">do_detailed_print</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Write JSON output (skip if we already wrote vibrational JSON for Hessian calculations)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">mbe_result</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_dipoles</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipoles</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_dipole_derivs</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_dipole_derivs</span><span class="p">)</span>

<span class="w">   </span><span class="k">end subroutine </span><span class="n">compute_mbe</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-11 09:40 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>