<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A demonstration of PIC as a framework for scientific applications targetting quantum chemistry">
    <meta name="author" content="Jorge Luis Galvez Vallejo" >
    <link rel="icon" href="../favicon.png">

    <title>compute_mbe &ndash; metalquicha</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">metalquicha </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>compute_mbe
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.9% of total for procedures.">143 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mqc_mbe.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mqc_mbe.f90.html'>mqc_mbe.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mqc_mbe.html'>mqc_mbe</a></li>
            <li class="breadcrumb-item active" aria-current="page">compute_mbe</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_grad">compute_grad</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-compute_hess">compute_hess</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-current_log_level~4">current_log_level</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_e~2">delta_E</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_energies~2">delta_energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_gradients~2">delta_gradients</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-delta_hessians~2">delta_hessians</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-do_detailed_print">do_detailed_print</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-energies~2">energies</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-fragment_size~8">fragment_size</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-hess_dim~2">hess_dim</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-i~25">i</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-lookup~5">lookup</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-nlevel~2">nlevel</a>
            <a class="list-group-item" href="../proc/compute_mbe.html#variable-sum_by_level~2">sum_by_level</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/compute_mbe.html#src">compute_mbe</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine compute_mbe(polymers, fragment_count, max_level, results, total_energy, sys_geom, total_gradient, total_hessian, bonds, world_comm)  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/mqc_result_types.html'>mqc_result_types</a></li>
                  <li class="list-inline-item"><a href='../module/mqc_config_parser.html'>mqc_config_parser</a></li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~UsesGraph Pages: 1 -->
<svg id="proccompute_mbeUsesGraph" width="497pt" height="262pt"
 viewBox="0.00 0.00 497.00 262.49" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 258.49)">
<title>proc~~compute_mbe~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-258.49 493,-258.49 493,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~UsesGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="489,-88.49 400,-88.49 400,-64.49 489,-64.49 489,-88.49"/>
<text text-anchor="middle" x="444.5" y="-74.09" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_node2" class="node">
<title>module~mqc_config_parser</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node2"><a xlink:href="../module/mqc_config_parser.html" xlink:title="mqc_config_parser">
<polygon fill="#337ab7" stroke="#337ab7" points="364,-149.49 250,-149.49 250,-125.49 364,-125.49 364,-149.49"/>
<text text-anchor="middle" x="307" y="-135.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_config_parser</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_config_parser -->
<g id="proc~~compute_mbe~~UsesGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_config_parser</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M416.73,-88.55C395.94,-97.9 366.92,-110.97 344.08,-121.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.4,-118.17 334.71,-125.47 345.27,-124.55 342.4,-118.17"/>
</g>
<!-- module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_node3" class="node">
<title>module~mqc_result_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node3"><a xlink:href="../module/mqc_result_types.html" xlink:title="mqc_result_types">
<polygon fill="#337ab7" stroke="#337ab7" points="359,-48.49 255,-48.49 255,-24.49 359,-24.49 359,-48.49"/>
<text text-anchor="middle" x="307" y="-34.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_result_types</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;module~mqc_result_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;module~mqc_result_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.85,-64.49C389.04,-60.42 373.43,-55.81 358.93,-51.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="359.68,-48.1 349.09,-48.62 357.69,-54.81 359.68,-48.1"/>
</g>
<!-- module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_node4" class="node">
<title>module~mqc_calc_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node4"><a xlink:href="../module/mqc_calc_types.html" xlink:title="mqc_calc_types">
<polygon fill="#337ab7" stroke="#337ab7" points="204.5,-254.49 107.5,-254.49 107.5,-230.49 204.5,-230.49 204.5,-254.49"/>
<text text-anchor="middle" x="156" y="-240.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_calc_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_calc_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge3" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_calc_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M295.55,-149.66C279.59,-167.58 247.45,-201.15 214,-221.49 211.21,-223.19 208.25,-224.79 205.22,-226.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.65,-223.15 195.97,-230.45 206.52,-229.53 203.65,-223.15"/>
</g>
<!-- module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_node5" class="node">
<title>module~mqc_error</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node5"><a xlink:href="../module/mqc_error.html" xlink:title="mqc_error">
<polygon fill="#337ab7" stroke="#337ab7" points="189.5,-212.49 122.5,-212.49 122.5,-188.49 189.5,-188.49 189.5,-212.49"/>
<text text-anchor="middle" x="156" y="-198.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_error</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_error -->
<g id="proc~~compute_mbe~~UsesGraph_edge4" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_error</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.84,-149.6C262.48,-158.28 236.89,-170.07 214,-179.49 209.25,-181.45 204.24,-183.42 199.24,-185.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.84,-182.12 189.72,-188.92 200.31,-188.67 197.84,-182.12"/>
</g>
<!-- module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_node6" class="node">
<title>module~mqc_geometry</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node6"><a xlink:href="../module/mqc_geometry.html" xlink:title="mqc_geometry">
<polygon fill="#337ab7" stroke="#337ab7" points="202.5,-170.49 109.5,-170.49 109.5,-146.49 202.5,-146.49 202.5,-170.49"/>
<text text-anchor="middle" x="156" y="-156.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_geometry</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_geometry -->
<g id="proc~~compute_mbe~~UsesGraph_edge5" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_geometry</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-145.43C237.57,-147.14 224.78,-148.94 212.7,-150.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.16,-147.18 202.75,-152.05 213.14,-154.12 212.16,-147.18"/>
</g>
<!-- module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_node7" class="node">
<title>module~mqc_method_types</title>
<g id="a_proc~~compute_mbe~~UsesGraph_node7"><a xlink:href="../module/mqc_method_types.html" xlink:title="mqc_method_types">
<polygon fill="#337ab7" stroke="#337ab7" points="214,-128.49 98,-128.49 98,-104.49 214,-104.49 214,-128.49"/>
<text text-anchor="middle" x="156" y="-114.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mqc_method_types</text>
</a>
</g>
</g>
<!-- module~mqc_config_parser&#45;&gt;module~mqc_method_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge6" class="edge">
<title>module~mqc_config_parser&#45;&gt;module~mqc_method_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.67,-129.55C241.47,-128.4 232.95,-127.2 224.56,-126.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="224.79,-122.51 214.4,-124.58 223.81,-129.44 224.79,-122.51"/>
</g>
<!-- pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_node9" class="node">
<title>pic_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="62,-128.49 0,-128.49 0,-104.49 62,-104.49 62,-128.49"/>
<text text-anchor="middle" x="31" y="-114.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_types</text>
</g>
<!-- module~mqc_config_parser&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge7" class="edge">
<title>module~mqc_config_parser&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.05,-125.34C267.98,-115.09 240.25,-101.2 214,-95.49 163.62,-84.54 148.95,-87.58 98,-95.49 89.37,-96.83 80.33,-99.1 71.81,-101.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="70.55,-98.39 62.09,-104.77 72.68,-105.06 70.55,-98.39"/>
</g>
<!-- pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_node8" class="node">
<title>pic_mpi_lib</title>
<polygon fill="#337ab7" stroke="#337ab7" points="192,-48.49 120,-48.49 120,-24.49 192,-24.49 192,-48.49"/>
<text text-anchor="middle" x="156" y="-34.09" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_mpi_lib</text>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_mpi_lib -->
<g id="proc~~compute_mbe~~UsesGraph_edge8" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_mpi_lib</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M254.72,-36.49C237.87,-36.49 219.26,-36.49 202.84,-36.49"/>
<polygon fill="#00ffff" stroke="#00ffff" points="202.41,-32.99 192.41,-36.49 202.41,-39.99 202.41,-32.99"/>
</g>
<!-- module~mqc_result_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge9" class="edge">
<title>module~mqc_result_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.47,-24.36C236.72,-7.93 156.1,15.94 98,-15.49 67.05,-32.24 48.3,-70.5 39.06,-94.83"/>
<polygon fill="#00ffff" stroke="#00ffff" points="35.75,-93.71 35.68,-104.3 42.34,-96.06 35.75,-93.71"/>
</g>
<!-- module~mqc_calc_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge10" class="edge">
<title>module~mqc_calc_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M112.51,-230.46C107.33,-227.98 102.34,-225.01 98,-221.49 70.32,-199.05 50.84,-161.74 40.53,-138.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="43.66,-136.56 36.56,-128.69 37.2,-139.27 43.66,-136.56"/>
</g>
<!-- module~mqc_geometry&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge11" class="edge">
<title>module~mqc_geometry&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M119.75,-146.46C104.85,-141.37 87.4,-135.41 72.02,-130.16"/>
<polygon fill="#00ff00" stroke="#00ff00" points="72.84,-126.74 62.25,-126.82 70.58,-133.37 72.84,-126.74"/>
</g>
<!-- module~mqc_method_types&#45;&gt;pic_types -->
<g id="proc~~compute_mbe~~UsesGraph_edge12" class="edge">
<title>module~mqc_method_types&#45;&gt;pic_types</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M97.82,-116.49C89.18,-116.49 80.42,-116.49 72.23,-116.49"/>
<polygon fill="#00ffff" stroke="#00ffff" points="72.22,-112.99 62.22,-116.49 72.22,-119.99 72.22,-112.99"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


    <p>Compute many-body expansion (MBE) energy with optional gradient and/or hessian</p>
<p>This is the core routine that handles all MBE computations.
Optional arguments control what derivatives are computed:
  - If sys_geom and total_gradient are present: compute gradient
  - If total_hessian is also present: compute hessian</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-polymers~11"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>polymers</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_count~2"></span>
              integer(kind=int64),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_count</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_level~9"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_level</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-results~4"></span>
              type(<a href='../type/calculation_result_t.html'>calculation_result_t</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>results</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_energy~2"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_energy</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sys_geom~23"></span>
              type(<a href='../type/system_geometry_t.html'>system_geometry_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys_geom</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_gradient~2"></span>
              real(kind=dp),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_gradient</strong>(:,:)</td>
            <td>
                <p>(3, total_atoms)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-total_hessian"></span>
              real(kind=dp),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>total_hessian</strong>(:,:)</td>
            <td>
                <p>(3<em>total_atoms, 3</em>total_atoms)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bonds~12"></span>
              type(<a href='../type/bond_t.html'>bond_t</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>bonds</strong>(:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-world_comm~18"></span>
              type(comm_t),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>world_comm</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CallsGraph Pages: 1 -->
<svg id="proccompute_mbeCallsGraph" width="641pt" height="596pt"
 viewBox="0.00 0.00 641.00 595.57" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CallsGraph" class="graph" transform="scale(0.38 0.38) rotate(0) translate(4 1558.79)">
<title>proc~~compute_mbe~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1558.79 1678,-1558.79 1678,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CallsGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="89,-729 0,-729 0,-705 89,-705 89,-729"/>
<text text-anchor="middle" x="44.5" y="-714.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_node2" class="node">
<title>abort_comm</title>
<polygon fill="#777777" stroke="#777777" points="853.5,-1316 773.5,-1316 773.5,-1292 853.5,-1292 853.5,-1316"/>
<text text-anchor="middle" x="813.5" y="-1301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abort_comm</text>
</g>
<!-- proc~compute_mbe&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge1" class="edge">
<title>proc~compute_mbe&#45;&gt;abort_comm</title>
<path fill="none" stroke="#ff0000" d="M45.64,-729.45C46.68,-800.46 55.35,-1153.98 125,-1231 290.98,-1414.53 635.51,-1349.8 763.36,-1317.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="764.44,-1320.98 773.26,-1315.11 762.7,-1314.2 764.44,-1320.98"/>
</g>
<!-- cart_disp -->
<g id="proc~~compute_mbe~~CallsGraph_node3" class="node">
<title>cart_disp</title>
<polygon fill="#777777" stroke="#777777" points="284,-276 223,-276 223,-252 284,-252 284,-276"/>
<text text-anchor="middle" x="253.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cart_disp</text>
</g>
<!-- proc~compute_mbe&#45;&gt;cart_disp -->
<g id="proc~~compute_mbe~~CallsGraph_edge2" class="edge">
<title>proc~compute_mbe&#45;&gt;cart_disp</title>
<path fill="none" stroke="#ff0000" d="M45.92,-704.81C48.37,-640.99 62.95,-345.89 125,-285 147.72,-262.71 184.41,-258.67 212.62,-259.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.8,-263.02 222.97,-260.04 213.16,-256.03 212.8,-263.02"/>
</g>
<!-- configuration -->
<g id="proc~~compute_mbe~~CallsGraph_node4" class="node">
<title>configuration</title>
<polygon fill="#777777" stroke="#777777" points="855.5,-1518 771.5,-1518 771.5,-1494 855.5,-1494 855.5,-1518"/>
<text text-anchor="middle" x="813.5" y="-1503.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">configuration</text>
</g>
<!-- proc~compute_mbe&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge3" class="edge">
<title>proc~compute_mbe&#45;&gt;configuration</title>
<path fill="none" stroke="#ff0000" d="M46.03,-729.05C49.99,-816.47 76.13,-1351.41 125,-1402 212.75,-1492.84 616.43,-1504.66 760.9,-1505.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="761.22,-1509.45 771.25,-1506.03 761.27,-1502.45 761.22,-1509.45"/>
</g>
<!-- error -->
<g id="proc~~compute_mbe~~CallsGraph_node5" class="node">
<title>error</title>
<polygon fill="#777777" stroke="#777777" points="1406.5,-1070 1352.5,-1070 1352.5,-1046 1406.5,-1046 1406.5,-1070"/>
<text text-anchor="middle" x="1379.5" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error</text>
</g>
<!-- proc~compute_mbe&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge4" class="edge">
<title>proc~compute_mbe&#45;&gt;error</title>
<path fill="none" stroke="#ff0000" d="M45.96,-729.06C49.55,-820.19 74.27,-1398.47 125,-1455 251.41,-1595.86 351.74,-1546 541,-1546 541,-1546 541,-1546 814.5,-1546 1008.25,-1546 1101.58,-1552.67 1227,-1405 1274.18,-1349.44 1235.47,-1312.49 1263,-1245 1289.59,-1179.81 1337.85,-1111.45 1362.73,-1078.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1365.55,-1080.43 1368.81,-1070.35 1359.97,-1076.2 1365.55,-1080.43"/>
</g>
<!-- fc_mdyne -->
<g id="proc~~compute_mbe~~CallsGraph_node6" class="node">
<title>fc_mdyne</title>
<polygon fill="#777777" stroke="#777777" points="285.5,-234 221.5,-234 221.5,-210 285.5,-210 285.5,-234"/>
<text text-anchor="middle" x="253.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fc_mdyne</text>
</g>
<!-- proc~compute_mbe&#45;&gt;fc_mdyne -->
<g id="proc~~compute_mbe~~CallsGraph_edge5" class="edge">
<title>proc~compute_mbe&#45;&gt;fc_mdyne</title>
<path fill="none" stroke="#ff0000" d="M45.7,-704.99C47.07,-637.94 57.2,-310.61 125,-243 147.12,-220.95 182.88,-216.67 210.91,-217.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.08,-220.87 221.23,-217.84 211.41,-213.88 211.08,-220.87"/>
</g>
<!-- force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node7" class="node">
<title>force_constants</title>
<polygon fill="#777777" stroke="#777777" points="301.5,-192 205.5,-192 205.5,-168 301.5,-168 301.5,-192"/>
<text text-anchor="middle" x="253.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">force_constants</text>
</g>
<!-- proc~compute_mbe&#45;&gt;force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge6" class="edge">
<title>proc~compute_mbe&#45;&gt;force_constants</title>
<path fill="none" stroke="#ff0000" d="M45.52,-704.87C45.91,-634.11 51.52,-275.25 125,-201 143.1,-182.71 170.57,-176.6 195.39,-175.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.55,-178.91 205.47,-175.19 195.39,-171.91 195.55,-178.91"/>
</g>
<!-- frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_node8" class="node">
<title>frequencies</title>
<polygon fill="#777777" stroke="#777777" points="291,-150 216,-150 216,-126 291,-126 291,-150"/>
<text text-anchor="middle" x="253.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">frequencies</text>
</g>
<!-- proc~compute_mbe&#45;&gt;frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_edge7" class="edge">
<title>proc~compute_mbe&#45;&gt;frequencies</title>
<path fill="none" stroke="#ff0000" d="M45.37,-704.87C44.83,-630.8 45.78,-239.96 125,-159 145.59,-137.96 178.58,-132.97 205.84,-133.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.88,-136.61 215.97,-133.39 206.07,-129.61 205.88,-136.61"/>
</g>
<!-- info -->
<g id="proc~~compute_mbe~~CallsGraph_node9" class="node">
<title>info</title>
<polygon fill="#777777" stroke="#777777" points="569,-834 515,-834 515,-810 569,-810 569,-834"/>
<text text-anchor="middle" x="542" y="-819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">info</text>
</g>
<!-- proc~compute_mbe&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge8" class="edge">
<title>proc~compute_mbe&#45;&gt;info</title>
<path fill="none" stroke="#ff0000" d="M52.67,-729.21C64.77,-748.51 91.26,-785.46 125,-801 254.07,-860.45 430.1,-841.01 504.95,-828.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="505.55,-832.21 514.83,-827.09 504.38,-825.3 505.55,-832.21"/>
</g>
<!-- proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_node10" class="node">
<title>proc~build_mbe_lookup_table</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node10"><a xlink:href="../proc/build_mbe_lookup_table.html" xlink:title="build_mbe_lookup_table">
<polygon fill="#d9534f" stroke="#d9534f" points="324.5,-434 182.5,-434 182.5,-410 324.5,-410 324.5,-434"/>
<text text-anchor="middle" x="253.5" y="-419.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_mbe_lookup_table</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table -->
<g id="proc~~compute_mbe~~CallsGraph_edge9" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~build_mbe_lookup_table</title>
<path fill="none" stroke="#ff0000" d="M54.13,-704.7C86.16,-659.05 198.42,-499.08 238.3,-442.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="241.18,-444.22 244.06,-434.03 235.45,-440.2 241.18,-444.22"/>
</g>
<!-- proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_node11" class="node">
<title>proc~compute_mbe_delta</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node11"><a xlink:href="../proc/compute_mbe_delta.html" xlink:title="compute_mbe_delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="314,-1162 193,-1162 193,-1138 314,-1138 314,-1162"/>
<text text-anchor="middle" x="253.5" y="-1147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_delta</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_delta -->
<g id="proc~~compute_mbe~~CallsGraph_edge10" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_delta</title>
<path fill="none" stroke="#ff0000" d="M46.35,-729.04C50.76,-788.41 72.88,-1049.36 125,-1108 139.97,-1124.84 161.82,-1134.95 183.22,-1141.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.44,-1144.43 192.99,-1143.53 184.18,-1137.65 182.44,-1144.43"/>
</g>
<!-- proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node12" class="node">
<title>proc~compute_mbe_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node12"><a xlink:href="../proc/compute_mbe_gradient.html" xlink:title="compute_mbe_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="323,-1222 184,-1222 184,-1198 323,-1198 323,-1222"/>
<text text-anchor="middle" x="253.5" y="-1207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge11" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_gradient</title>
<path fill="none" stroke="#ff0000" d="M45.96,-729.22C48.66,-794.58 64.47,-1102.49 125,-1171 137.79,-1185.48 155.79,-1194.66 174.25,-1200.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.34,-1203.84 183.91,-1203.2 175.24,-1197.11 173.34,-1203.84"/>
</g>
<!-- proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node13" class="node">
<title>proc~compute_mbe_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node13"><a xlink:href="../proc/compute_mbe_hessian.html" xlink:title="compute_mbe_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="321,-1099 186,-1099 186,-1075 321,-1075 321,-1099"/>
<text text-anchor="middle" x="253.5" y="-1084.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_mbe_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge12" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_mbe_hessian</title>
<path fill="none" stroke="#ff0000" d="M46.05,-729.25C48.49,-770.96 61.24,-909.83 125,-999 148.15,-1031.38 187.14,-1055.73 215.92,-1070.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="214.36,-1073.65 224.88,-1074.98 217.49,-1067.38 214.36,-1073.65"/>
</g>
<!-- proc~compute_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_node14" class="node">
<title>proc~compute_vibrational_analysis</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node14"><a xlink:href="../proc/compute_vibrational_analysis.html" xlink:title="compute_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="338.5,-318 168.5,-318 168.5,-294 338.5,-294 338.5,-318"/>
<text text-anchor="middle" x="253.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_edge13" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~compute_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M46.27,-704.62C50.24,-644.82 70.4,-386.47 125,-332 134.37,-322.66 146.12,-316.23 158.68,-311.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="159.86,-315.17 168.42,-308.92 157.83,-308.47 159.86,-315.17"/>
</g>
<!-- proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_node15" class="node">
<title>proc~energy_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node15"><a xlink:href="../proc/energy_total.html" xlink:title="energy_t%energy_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="321.5,-108 185.5,-108 185.5,-84 321.5,-84 321.5,-108"/>
<text text-anchor="middle" x="253.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">energy_t%energy_total</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~energy_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge14" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~energy_total</title>
<path fill="none" stroke="#ff0000" d="M45.24,-704.98C43.82,-628.01 40,-204.72 125,-117 138.17,-103.41 156.5,-96.5 175.16,-93.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.78,-96.78 185.23,-91.98 174.85,-89.85 175.78,-96.78"/>
</g>
<!-- proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node16" class="node">
<title>proc~fragment_lookup_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node16"><a xlink:href="../proc/fragment_lookup_destroy.html" xlink:title="fragment_lookup_t%fragment_lookup_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-66 125,-66 125,-42 382,-42 382,-66"/>
<text text-anchor="middle" x="253.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_destroy</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge15" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~fragment_lookup_destroy</title>
<path fill="none" stroke="#ff0000" d="M46.14,-704.91C50.69,-620.6 79.43,-122.43 125,-75 125.92,-74.04 126.86,-73.12 127.83,-72.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="130.02,-74.96 135.68,-66.01 125.67,-69.47 130.02,-74.96"/>
</g>
<!-- proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_node17" class="node">
<title>proc~map_fragment_to_system_gradient</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node17"><a xlink:href="../proc/map_fragment_to_system_gradient.html" xlink:title="map_fragment_to_system_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="642,-1394 442,-1394 442,-1370 642,-1370 642,-1394"/>
<text text-anchor="middle" x="542" y="-1379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_gradient</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge16" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#ff0000" d="M46.09,-729.08C50.33,-813.35 77.31,-1311.15 125,-1356 224.89,-1449.94 404.84,-1419.05 491.59,-1396.67"/>
<polygon fill="#ff0000" stroke="#ff0000" points="492.67,-1400 501.44,-1394.06 490.88,-1393.23 492.67,-1400"/>
</g>
<!-- proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node18" class="node">
<title>proc~map_fragment_to_system_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node18"><a xlink:href="../proc/map_fragment_to_system_hessian.html" xlink:title="map_fragment_to_system_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="640,-1120 444,-1120 444,-1096 640,-1096 640,-1120"/>
<text text-anchor="middle" x="542" y="-1105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">map_fragment_to_system_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge17" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#ff0000" d="M47.19,-729.3C52.52,-764 71.9,-864.1 125,-925 210.62,-1023.2 268.61,-1001.84 382,-1066 398.12,-1075.12 400.59,-1080.67 418,-1087 424.72,-1089.44 431.75,-1091.6 438.9,-1093.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="438.16,-1096.94 448.71,-1095.97 439.86,-1090.15 438.16,-1096.94"/>
</g>
<!-- proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node19" class="node">
<title>proc~print_detailed_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node19"><a xlink:href="../proc/print_detailed_breakdown.html" xlink:title="print_detailed_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-750 178.5,-750 178.5,-726 328.5,-726 328.5,-750"/>
<text text-anchor="middle" x="253.5" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge18" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown</title>
<path fill="none" stroke="#ff0000" d="M89.15,-721.43C112.08,-723.75 140.98,-726.69 168.07,-729.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.05,-732.95 178.35,-730.48 168.75,-725.99 168.05,-732.95"/>
</g>
<!-- proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_node20" class="node">
<title>proc~print_detailed_breakdown_json</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node20"><a xlink:href="../proc/print_detailed_breakdown_json.html" xlink:title="print_detailed_breakdown_json">
<polygon fill="#d9534f" stroke="#d9534f" points="342,-916 165,-916 165,-892 342,-892 342,-916"/>
<text text-anchor="middle" x="253.5" y="-901.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_detailed_breakdown_json</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json -->
<g id="proc~~compute_mbe~~CallsGraph_edge19" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_detailed_breakdown_json</title>
<path fill="none" stroke="#ff0000" d="M51.16,-729.1C62.44,-752.16 89.7,-802.96 125,-835 150.31,-857.97 184.66,-875.99 211.32,-887.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="210.2,-891.18 220.77,-891.93 212.98,-884.75 210.2,-891.18"/>
</g>
<!-- proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_node21" class="node">
<title>proc~print_mbe_energy_breakdown</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node21"><a xlink:href="../proc/print_mbe_energy_breakdown.html" xlink:title="print_mbe_energy_breakdown">
<polygon fill="#d9534f" stroke="#d9534f" points="340,-792 167,-792 167,-768 340,-768 340,-792"/>
<text text-anchor="middle" x="253.5" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_energy_breakdown</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown -->
<g id="proc~~compute_mbe~~CallsGraph_edge20" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_energy_breakdown</title>
<path fill="none" stroke="#ff0000" d="M64.32,-729.18C79.95,-738.74 103.1,-751.63 125,-759 135.17,-762.42 146,-765.3 156.88,-767.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.36,-771.19 166.86,-769.81 157.79,-764.33 156.36,-771.19"/>
</g>
<!-- proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_node22" class="node">
<title>proc~print_mbe_gradient_info</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node22"><a xlink:href="../proc/print_mbe_gradient_info.html" xlink:title="print_mbe_gradient_info">
<polygon fill="#d9534f" stroke="#d9534f" points="324.5,-666 182.5,-666 182.5,-642 324.5,-642 324.5,-666"/>
<text text-anchor="middle" x="253.5" y="-651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_mbe_gradient_info</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info -->
<g id="proc~~compute_mbe~~CallsGraph_edge21" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_mbe_gradient_info</title>
<path fill="none" stroke="#ff0000" d="M64.32,-704.82C79.95,-695.26 103.1,-682.37 125,-675 140.05,-669.93 156.53,-666.06 172.5,-663.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.11,-666.56 182.36,-661.4 171.9,-659.67 173.11,-666.56"/>
</g>
<!-- proc~print_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_node23" class="node">
<title>proc~print_vibrational_analysis</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node23"><a xlink:href="../proc/print_vibrational_analysis.html" xlink:title="print_vibrational_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="327.5,-708 179.5,-708 179.5,-684 327.5,-684 327.5,-708"/>
<text text-anchor="middle" x="253.5" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_vibrational_analysis</text>
</a>
</g>
</g>
<!-- proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis -->
<g id="proc~~compute_mbe~~CallsGraph_edge22" class="edge">
<title>proc~compute_mbe&#45;&gt;proc~print_vibrational_analysis</title>
<path fill="none" stroke="#ff0000" d="M89.15,-712.57C112.39,-710.21 141.76,-707.23 169.18,-704.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.58,-707.93 179.17,-703.44 168.87,-700.97 169.58,-707.93"/>
</g>
<!-- reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_node24" class="node">
<title>reduced_masses</title>
<polygon fill="#777777" stroke="#777777" points="304,-24 203,-24 203,0 304,0 304,-24"/>
<text text-anchor="middle" x="253.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduced_masses</text>
</g>
<!-- proc~compute_mbe&#45;&gt;reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_edge23" class="edge">
<title>proc~compute_mbe&#45;&gt;reduced_masses</title>
<path fill="none" stroke="#ff0000" d="M46.04,-704.97C50.06,-617.72 76.53,-83.83 125,-33 142.2,-14.96 168.5,-8.62 192.75,-7.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="193.09,-10.72 202.98,-6.92 192.88,-3.72 193.09,-10.72"/>
</g>
<!-- to_char -->
<g id="proc~~compute_mbe~~CallsGraph_node25" class="node">
<title>to_char</title>
<polygon fill="#777777" stroke="#777777" points="1406.5,-413 1352.5,-413 1352.5,-389 1406.5,-389 1406.5,-413"/>
<text text-anchor="middle" x="1379.5" y="-398.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_char</text>
</g>
<!-- proc~compute_mbe&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge24" class="edge">
<title>proc~compute_mbe&#45;&gt;to_char</title>
<path fill="none" stroke="#ff0000" d="M46.94,-704.86C53.37,-652.47 81.16,-446.35 125,-401 207.61,-315.54 284.16,-394.49 382,-327 403.95,-311.86 394.15,-290.93 418,-279 539.5,-218.25 1038.61,-290.01 1227,-338 1269.72,-348.88 1316.15,-369.63 1346.2,-384.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1344.84,-387.57 1355.35,-388.88 1347.95,-381.3 1344.84,-387.57"/>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge30" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;to_char</title>
<path fill="none" stroke="#00ff00" d="M277.53,-409.99C308.48,-394.6 365.66,-368.73 418,-359 773.14,-292.95 1214.26,-368.59 1342.18,-393.56"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1341.73,-397.04 1352.22,-395.54 1343.09,-390.17 1341.73,-397.04"/>
</g>
<!-- debug -->
<g id="proc~~compute_mbe~~CallsGraph_node26" class="node">
<title>debug</title>
<polygon fill="#777777" stroke="#777777" points="840.5,-1072 786.5,-1072 786.5,-1048 840.5,-1048 840.5,-1072"/>
<text text-anchor="middle" x="813.5" y="-1057.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">debug</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge25" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;debug</title>
<path fill="none" stroke="#00ff00" d="M259.64,-434.1C276.23,-471.55 332.34,-586.08 418,-637 513.85,-693.98 589.29,-594.07 666,-675 721.92,-733.99 647.14,-979.02 702,-1039 720.45,-1059.17 751.77,-1063.56 776.36,-1063.4"/>
<polygon fill="#00ff00" stroke="#00ff00" points="776.55,-1066.89 786.43,-1063.08 776.33,-1059.9 776.55,-1066.89"/>
</g>
<!-- get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_node27" class="node">
<title>get_elapsed_time</title>
<polygon fill="#777777" stroke="#777777" points="595,-312 489,-312 489,-288 595,-288 595,-312"/>
<text text-anchor="middle" x="542" y="-297.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_elapsed_time</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time -->
<g id="proc~~compute_mbe~~CallsGraph_edge26" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;get_elapsed_time</title>
<path fill="none" stroke="#00ff00" d="M285.82,-409.93C312.56,-398.9 351.42,-381.13 382,-360 400.11,-347.49 398.51,-336.21 418,-326 436.61,-316.25 458.61,-310.16 478.82,-306.35"/>
<polygon fill="#00ff00" stroke="#00ff00" points="479.63,-309.76 488.89,-304.61 478.44,-302.86 479.63,-309.76"/>
</g>
<!-- proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_node40" class="node">
<title>proc~fragment_lookup_init</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node40"><a xlink:href="../proc/fragment_lookup_init.html" xlink:title="fragment_lookup_t%fragment_lookup_init">
<polygon fill="#d9534f" stroke="#d9534f" points="659.5,-392 424.5,-392 424.5,-368 659.5,-368 659.5,-392"/>
<text text-anchor="middle" x="542" y="-377.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_init</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init -->
<g id="proc~~compute_mbe~~CallsGraph_edge27" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_init</title>
<path fill="none" stroke="#00ff00" d="M324.59,-411.73C362,-406.24 408.52,-399.42 448.83,-393.51"/>
<polygon fill="#00ff00" stroke="#00ff00" points="449.55,-396.94 458.94,-392.03 448.53,-390.02 449.55,-396.94"/>
</g>
<!-- proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_node41" class="node">
<title>proc~fragment_lookup_insert</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node41"><a xlink:href="../proc/fragment_lookup_insert.html" xlink:title="fragment_lookup_t%fragment_lookup_insert">
<polygon fill="#d9534f" stroke="#d9534f" points="666,-628 418,-628 418,-604 666,-604 666,-628"/>
<text text-anchor="middle" x="542" y="-613.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_insert</text>
</a>
</g>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert -->
<g id="proc~~compute_mbe~~CallsGraph_edge28" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;proc~fragment_lookup_insert</title>
<path fill="none" stroke="#00ff00" d="M272.42,-434.14C321.26,-467.21 456.88,-559.04 514.53,-598.07"/>
<polygon fill="#00ff00" stroke="#00ff00" points="512.84,-601.16 523.08,-603.87 516.77,-595.36 512.84,-601.16"/>
</g>
<!-- start -->
<g id="proc~~compute_mbe~~CallsGraph_node49" class="node">
<title>start</title>
<polygon fill="#777777" stroke="#777777" points="569,-434 515,-434 515,-410 569,-410 569,-434"/>
<text text-anchor="middle" x="542" y="-419.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start</text>
</g>
<!-- proc~build_mbe_lookup_table&#45;&gt;start -->
<g id="proc~~compute_mbe~~CallsGraph_edge29" class="edge">
<title>proc~build_mbe_lookup_table&#45;&gt;start</title>
<path fill="none" stroke="#00ff00" d="M324.59,-422C381.48,-422 459.43,-422 504.59,-422"/>
<polygon fill="#00ff00" stroke="#00ff00" points="504.78,-425.5 514.78,-422 504.78,-418.5 504.78,-425.5"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge31" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff3f" d="M297.64,-1162.05C322.5,-1169.28 354.23,-1179 382,-1189 398.31,-1194.88 401.55,-1198.52 418,-1204 539.97,-1244.62 687.83,-1278.02 763.18,-1293.93"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="762.81,-1297.43 773.32,-1296.06 764.25,-1290.58 762.81,-1297.43"/>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge32" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;error</title>
<path fill="none" stroke="#00ff3f" d="M314.12,-1159.52C345.03,-1163.98 383.44,-1168.79 418,-1171 528,-1178.04 555.79,-1172.28 666,-1171 781.13,-1169.67 830.15,-1230.28 925,-1165 959.81,-1141.04 926.46,-1101.35 961,-1077 1078.77,-993.99 1265.05,-1028.33 1342.69,-1047.91"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1341.92,-1051.33 1352.47,-1050.45 1343.67,-1044.55 1341.92,-1051.33"/>
</g>
<!-- proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_node39" class="node">
<title>proc~fragment_lookup_find</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node39"><a xlink:href="../proc/fragment_lookup_find.html" xlink:title="fragment_lookup_t%fragment_lookup_find">
<polygon fill="#d94e8f" stroke="#d94e8f" points="661,-1078 423,-1078 423,-1054 661,-1054 661,-1078"/>
<text text-anchor="middle" x="542" y="-1063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fragment_lookup_t%fragment_lookup_find</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge33" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff3f" d="M298.73,-1137.92C323.67,-1130.5 355.12,-1120.11 382,-1108 398.89,-1100.39 400.59,-1093.33 418,-1087 424.72,-1084.56 431.75,-1082.4 438.9,-1080.48"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="439.86,-1083.85 448.71,-1078.03 438.16,-1077.06 439.86,-1083.85"/>
</g>
<!-- proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_node44" class="node">
<title>proc~get_next_combination</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node44"><a xlink:href="../proc/get_next_combination.html" xlink:title="get_next_combination">
<polygon fill="#d9534f" stroke="#d9534f" points="607,-1162 477,-1162 477,-1138 607,-1138 607,-1162"/>
<text text-anchor="middle" x="542" y="-1147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_next_combination</text>
</a>
</g>
</g>
<!-- proc~compute_mbe_delta&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge34" class="edge">
<title>proc~compute_mbe_delta&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff3f" d="M314.21,-1150C358.52,-1150 419.21,-1150 466.67,-1150"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="466.89,-1153.5 476.89,-1150 466.89,-1146.5 466.89,-1153.5"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge35" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#00ff7f" d="M275.89,-1222.01C306.36,-1238.44 364.52,-1267.33 418,-1280 539.48,-1308.78 687.55,-1308.78 763.06,-1306.36"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="763.35,-1309.85 773.22,-1306.01 763.1,-1302.86 763.35,-1309.85"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge36" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;error</title>
<path fill="none" stroke="#00ff7f" d="M323.04,-1217.41C444.39,-1230.55 705.02,-1258.8 925,-1283 941,-1284.76 944.93,-1286.11 961,-1287 1079.04,-1293.54 1122.87,-1342.97 1227,-1287 1248.69,-1275.34 1334.04,-1133.36 1366.17,-1078.99"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1369.3,-1080.59 1371.36,-1070.19 1363.27,-1077.03 1369.3,-1080.59"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient -->
<g id="proc~~compute_mbe~~CallsGraph_edge39" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~map_fragment_to_system_gradient</title>
<path fill="none" stroke="#00ff7f" d="M271.78,-1222.28C301.2,-1242.98 363.17,-1285.74 418,-1318 447.44,-1335.32 482.02,-1353.1 507.01,-1365.51"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="505.57,-1368.7 516.09,-1369.99 508.67,-1362.42 505.57,-1368.7"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge37" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ff7f" d="M323.27,-1200.46C344.08,-1194.75 365.72,-1185.61 382,-1171 412.23,-1143.87 386.1,-1112.14 418,-1087 419.63,-1085.72 421.3,-1084.5 423.02,-1083.35"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="425.12,-1086.18 431.97,-1078.1 421.57,-1080.14 425.12,-1086.18"/>
</g>
<!-- proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge38" class="edge">
<title>proc~compute_mbe_gradient&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ff7f" d="M312.13,-1197.93C358.76,-1188.17 424.5,-1174.4 473.57,-1164.12"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="474.39,-1167.53 483.46,-1162.05 472.95,-1160.67 474.39,-1167.53"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge42" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~map_fragment_to_system_hessian</title>
<path fill="none" stroke="#00ffbf" d="M321.31,-1091.9C354.78,-1094.35 396.12,-1097.38 433.88,-1100.15"/>
<polygon fill="#00ffbf" stroke="#00ffbf" points="433.68,-1103.64 443.91,-1100.88 434.19,-1096.66 433.68,-1103.64"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find -->
<g id="proc~~compute_mbe~~CallsGraph_edge40" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~fragment_lookup_find</title>
<path fill="none" stroke="#00ffbf" d="M321.31,-1082.1C348.61,-1080.1 381.16,-1077.72 412.72,-1075.4"/>
<polygon fill="#00ffbf" stroke="#00ffbf" points="413.21,-1078.88 422.93,-1074.65 412.7,-1071.9 413.21,-1078.88"/>
</g>
<!-- proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination -->
<g id="proc~~compute_mbe~~CallsGraph_edge41" class="edge">
<title>proc~compute_mbe_hessian&#45;&gt;proc~get_next_combination</title>
<path fill="none" stroke="#00ffbf" d="M297.3,-1099.02C330.15,-1108 376.73,-1120.19 418,-1129 433.79,-1132.37 450.81,-1135.56 467.01,-1138.38"/>
<polygon fill="#00ffbf" stroke="#00ffbf" points="466.52,-1141.85 476.97,-1140.09 467.71,-1134.95 466.52,-1141.85"/>
</g>
<!-- proc~compute_cartesian_displacements -->
<g id="proc~~compute_mbe~~CallsGraph_node31" class="node">
<title>proc~compute_cartesian_displacements</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node31"><a xlink:href="../proc/compute_cartesian_displacements.html" xlink:title="compute_cartesian_displacements">
<polygon fill="#d9534f" stroke="#d9534f" points="912,-66 715,-66 715,-42 912,-42 912,-66"/>
<text text-anchor="middle" x="813.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_cartesian_displacements</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements -->
<g id="proc~~compute_mbe~~CallsGraph_edge43" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_cartesian_displacements</title>
<path fill="none" stroke="#00ffff" d="M338.67,-306.5C354.71,-302.89 370.17,-296.32 382,-285 438.12,-231.31 361.06,-166.81 418,-114 458.76,-76.19 611.09,-89.71 666,-81 690.47,-77.12 717.15,-72.36 740.95,-67.93"/>
<polygon fill="#00ffff" stroke="#00ffff" points="741.78,-71.33 750.96,-66.05 740.49,-64.45 741.78,-71.33"/>
</g>
<!-- proc~compute_force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_node32" class="node">
<title>proc~compute_force_constants</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node32"><a xlink:href="../proc/compute_force_constants.html" xlink:title="compute_force_constants">
<polygon fill="#d9534f" stroke="#d9534f" points="616,-190 468,-190 468,-166 616,-166 616,-190"/>
<text text-anchor="middle" x="542" y="-175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_force_constants</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants -->
<g id="proc~~compute_mbe~~CallsGraph_edge44" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_force_constants</title>
<path fill="none" stroke="#00ffff" d="M338.77,-304.35C354.35,-300.8 369.59,-294.81 382,-285 414.51,-259.31 385.57,-224.79 418,-199 429.44,-189.91 443.38,-184.15 457.72,-180.6"/>
<polygon fill="#00ffff" stroke="#00ffff" points="458.63,-183.98 467.69,-178.48 457.18,-177.14 458.63,-183.98"/>
</g>
<!-- proc~compute_reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_node33" class="node">
<title>proc~compute_reduced_masses</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node33"><a xlink:href="../proc/compute_reduced_masses.html" xlink:title="compute_reduced_masses">
<polygon fill="#d9534f" stroke="#d9534f" points="890.5,-108 736.5,-108 736.5,-84 890.5,-84 890.5,-108"/>
<text text-anchor="middle" x="813.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_reduced_masses</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses -->
<g id="proc~~compute_mbe~~CallsGraph_edge45" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_reduced_masses</title>
<path fill="none" stroke="#00ffff" d="M338.76,-305.74C354.61,-302.14 369.96,-295.77 382,-285 426.04,-245.59 373.77,-196.19 418,-157 429.47,-146.84 613.49,-121.59 726.09,-106.96"/>
<polygon fill="#00ffff" stroke="#00ffff" points="726.62,-110.42 736.08,-105.66 725.72,-103.48 726.62,-110.42"/>
</g>
<!-- proc~compute_vibrational_frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_node34" class="node">
<title>proc~compute_vibrational_frequencies</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node34"><a xlink:href="../proc/compute_vibrational_frequencies.html" xlink:title="compute_vibrational_frequencies">
<polygon fill="#d9534f" stroke="#d9534f" points="637,-232 447,-232 447,-208 637,-208 637,-232"/>
<text text-anchor="middle" x="542" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_vibrational_frequencies</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies -->
<g id="proc~~compute_mbe~~CallsGraph_edge46" class="edge">
<title>proc~compute_vibrational_analysis&#45;&gt;proc~compute_vibrational_frequencies</title>
<path fill="none" stroke="#00ffff" d="M338.74,-300.22C353.73,-296.97 368.77,-292.13 382,-285 402.77,-273.81 397.49,-257.66 418,-246 425.51,-241.73 433.65,-238.16 442.03,-235.17"/>
<polygon fill="#00ffff" stroke="#00ffff" points="443.16,-238.48 451.57,-232.04 440.98,-231.83 443.16,-238.48"/>
</g>
<!-- proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_node46" class="node">
<title>proc~mp2_total</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node46"><a xlink:href="../proc/mp2_total.html" xlink:title="mp2_energy_t%mp2_total">
<polygon fill="#d94e8f" stroke="#d94e8f" points="617.5,-72 466.5,-72 466.5,-48 617.5,-48 617.5,-72"/>
<text text-anchor="middle" x="542" y="-57.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mp2_energy_t%mp2_total</text>
</a>
</g>
</g>
<!-- proc~energy_total&#45;&gt;proc~mp2_total -->
<g id="proc~~compute_mbe~~CallsGraph_edge47" class="edge">
<title>proc~energy_total&#45;&gt;proc~mp2_total</title>
<path fill="none" stroke="#00bfff" d="M321.67,-87.56C361.86,-82.51 413.31,-76.04 456.28,-70.65"/>
<polygon fill="#00bfff" stroke="#00bfff" points="456.95,-74.09 466.44,-69.37 456.08,-67.14 456.95,-74.09"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;abort_comm -->
<g id="proc~~compute_mbe~~CallsGraph_edge48" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;abort_comm</title>
<path fill="none" stroke="#003fff" d="M623.92,-1369.93C638.27,-1366.39 652.83,-1361.83 666,-1356 684.05,-1348.01 684.05,-1338.2 702,-1330 721.24,-1321.22 743.76,-1315.23 763.43,-1311.24"/>
<polygon fill="#003fff" stroke="#003fff" points="764.27,-1314.64 773.43,-1309.33 762.95,-1307.77 764.27,-1314.64"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;configuration -->
<g id="proc~~compute_mbe~~CallsGraph_edge49" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;configuration</title>
<path fill="none" stroke="#003fff" d="M569.66,-1394.17C595.44,-1406.51 635.04,-1427.03 666,-1450 683.92,-1463.29 682.2,-1474.7 702,-1485 720.06,-1494.39 741.74,-1499.62 761.09,-1502.51"/>
<polygon fill="#003fff" stroke="#003fff" points="760.9,-1506.02 771.27,-1503.86 761.81,-1499.08 760.9,-1506.02"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge51" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;error</title>
<path fill="none" stroke="#003fff" d="M642.1,-1378.39C820.15,-1371.12 1180.08,-1352.57 1227,-1320 1257.37,-1298.91 1245.26,-1277.44 1263,-1245 1296.8,-1183.18 1341.93,-1113.26 1364.46,-1079.08"/>
<polygon fill="#003fff" stroke="#003fff" points="1367.59,-1080.69 1370.19,-1070.42 1361.75,-1076.83 1367.59,-1080.69"/>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;debug -->
<g id="proc~~compute_mbe~~CallsGraph_edge50" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;debug</title>
<path fill="none" stroke="#003fff" d="M550.86,-1369.98C571.39,-1338.29 627.68,-1249.49 666,-1171 684.9,-1132.29 668.75,-1108.39 702,-1081 722.52,-1064.1 752.47,-1059.23 776.01,-1058.38"/>
<polygon fill="#003fff" stroke="#003fff" points="776.37,-1061.88 786.32,-1058.25 776.28,-1054.88 776.37,-1061.88"/>
</g>
<!-- proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_node30" class="node">
<title>proc~build_fragment_from_indices</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node30"><a xlink:href="../proc/build_fragment_from_indices.html" xlink:title="build_fragment_from_indices">
<polygon fill="#d9534f" stroke="#d9534f" points="896.5,-1236 730.5,-1236 730.5,-1212 896.5,-1212 896.5,-1236"/>
<text text-anchor="middle" x="813.5" y="-1221.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">build_fragment_from_indices</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge52" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#003fff" d="M561.84,-1369.7C591.36,-1350.56 650.47,-1312.76 702,-1283 727.71,-1268.16 757.42,-1252.37 779.55,-1240.86"/>
<polygon fill="#003fff" stroke="#003fff" points="781.27,-1243.91 788.54,-1236.21 778.05,-1237.7 781.27,-1243.91"/>
</g>
<!-- proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_node36" class="node">
<title>proc~error_get_full_trace</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node36"><a xlink:href="../proc/error_get_full_trace.html" xlink:title="error_t%error_get_full_trace">
<polygon fill="#d94e8f" stroke="#d94e8f" points="894,-1476 733,-1476 733,-1452 894,-1452 894,-1476"/>
<text text-anchor="middle" x="813.5" y="-1461.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_get_full_trace</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace -->
<g id="proc~~compute_mbe~~CallsGraph_edge53" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_get_full_trace</title>
<path fill="none" stroke="#003fff" d="M570.07,-1394.09C601.32,-1407.65 654.51,-1429.49 702,-1443 710.76,-1445.49 719.99,-1447.77 729.24,-1449.83"/>
<polygon fill="#003fff" stroke="#003fff" points="728.74,-1453.31 739.26,-1451.99 730.21,-1446.46 728.74,-1453.31"/>
</g>
<!-- proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_node37" class="node">
<title>proc~error_has_error</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node37"><a xlink:href="../proc/error_has_error.html" xlink:title="error_t%error_has_error">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1163.5,-1396 1024.5,-1396 1024.5,-1372 1163.5,-1372 1163.5,-1396"/>
<text text-anchor="middle" x="1094" y="-1381.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_has_error</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge54" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#003fff" d="M642.28,-1382.36C748.97,-1382.75 916.37,-1383.36 1014.33,-1383.71"/>
<polygon fill="#003fff" stroke="#003fff" points="1014.45,-1387.21 1024.46,-1383.75 1014.47,-1380.21 1014.45,-1387.21"/>
</g>
<!-- proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node38" class="node">
<title>proc~fragment_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node38"><a xlink:href="../proc/fragment_destroy.html" xlink:title="physical_fragment_t%fragment_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="925,-1156 702,-1156 702,-1132 925,-1132 925,-1156"/>
<text text-anchor="middle" x="813.5" y="-1141.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_destroy</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge55" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#003fff" d="M551.45,-1369.8C573.38,-1338.8 635.08,-1255.74 702,-1203 724.12,-1185.57 752.14,-1170.67 774.42,-1160.21"/>
<polygon fill="#003fff" stroke="#003fff" points="775.96,-1163.36 783.59,-1156 773.04,-1156.99 775.96,-1163.36"/>
</g>
<!-- proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_node47" class="node">
<title>proc~redistribute_cap_gradients</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node47"><a xlink:href="../proc/redistribute_cap_gradients.html" xlink:title="redistribute_cap_gradients">
<polygon fill="#d9534f" stroke="#d9534f" points="890.5,-1434 736.5,-1434 736.5,-1410 890.5,-1410 890.5,-1434"/>
<text text-anchor="middle" x="813.5" y="-1419.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_gradients</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients -->
<g id="proc~~compute_mbe~~CallsGraph_edge56" class="edge">
<title>proc~map_fragment_to_system_gradient&#45;&gt;proc~redistribute_cap_gradients</title>
<path fill="none" stroke="#003fff" d="M623.86,-1394C656.18,-1398.8 693.44,-1404.33 726.28,-1409.2"/>
<polygon fill="#003fff" stroke="#003fff" points="725.91,-1412.69 736.31,-1410.69 726.94,-1405.76 725.91,-1412.69"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices -->
<g id="proc~~compute_mbe~~CallsGraph_edge57" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~build_fragment_from_indices</title>
<path fill="none" stroke="#0000ff" d="M640.21,-1118.73C649.18,-1121.45 657.92,-1124.82 666,-1129 686.1,-1139.39 683.82,-1151.52 702,-1165 724.78,-1181.88 753.01,-1196.87 775.24,-1207.52"/>
<polygon fill="#0000ff" stroke="#0000ff" points="773.83,-1210.72 784.37,-1211.81 776.81,-1204.39 773.83,-1210.72"/>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge58" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~fragment_destroy</title>
<path fill="none" stroke="#0000ff" d="M633.11,-1120.04C658.51,-1123.43 686.29,-1127.14 712.24,-1130.61"/>
<polygon fill="#0000ff" stroke="#0000ff" points="712.1,-1134.12 722.47,-1131.97 713.02,-1127.18 712.1,-1134.12"/>
</g>
<!-- proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node48" class="node">
<title>proc~redistribute_cap_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node48"><a xlink:href="../proc/redistribute_cap_hessian.html" xlink:title="redistribute_cap_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="885.5,-1114 741.5,-1114 741.5,-1090 885.5,-1090 885.5,-1114"/>
<text text-anchor="middle" x="813.5" y="-1099.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">redistribute_cap_hessian</text>
</a>
</g>
</g>
<!-- proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge59" class="edge">
<title>proc~map_fragment_to_system_hessian&#45;&gt;proc~redistribute_cap_hessian</title>
<path fill="none" stroke="#0000ff" d="M640.3,-1105.83C669.97,-1105.17 702.28,-1104.45 730.81,-1103.82"/>
<polygon fill="#0000ff" stroke="#0000ff" points="731.22,-1107.31 741.14,-1103.59 731.07,-1100.31 731.22,-1107.31"/>
</g>
<!-- header -->
<g id="proc~~compute_mbe~~CallsGraph_node28" class="node">
<title>header</title>
<polygon fill="#777777" stroke="#777777" points="569,-792 515,-792 515,-768 569,-768 569,-792"/>
<text text-anchor="middle" x="542" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">header</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;header -->
<g id="proc~~compute_mbe~~CallsGraph_edge60" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;header</title>
<path fill="none" stroke="#3f00ff" d="M328.65,-748.87C385.29,-757.17 460.88,-768.25 504.92,-774.71"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="504.47,-778.18 514.88,-776.17 505.49,-771.26 504.47,-778.18"/>
</g>
<!-- level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node29" class="node">
<title>level_name</title>
<polygon fill="#777777" stroke="#777777" points="579,-750 505,-750 505,-726 579,-726 579,-750"/>
<text text-anchor="middle" x="542" y="-735.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">level_name</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge61" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;level_name</title>
<path fill="none" stroke="#3f00ff" d="M328.65,-738C381.11,-738 449.81,-738 494.66,-738"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="494.68,-741.5 504.68,-738 494.68,-734.5 494.68,-741.5"/>
</g>
<!-- proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_node43" class="node">
<title>proc~get_frag_level_name</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node43"><a xlink:href="../proc/get_frag_level_name.html" xlink:title="get_frag_level_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="604,-876 480,-876 480,-852 604,-852 604,-876"/>
<text text-anchor="middle" x="542" y="-861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_frag_level_name</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge62" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#3f00ff" d="M328.74,-737.8C347.67,-740.9 366.9,-747.17 382,-759 413.97,-784.05 386.1,-817.86 418,-843 432.64,-854.54 451.34,-860.7 469.71,-863.78"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="469.47,-867.28 479.86,-865.19 470.44,-860.35 469.47,-867.28"/>
</g>
<!-- verbose -->
<g id="proc~~compute_mbe~~CallsGraph_node50" class="node">
<title>verbose</title>
<polygon fill="#777777" stroke="#777777" points="569.5,-708 514.5,-708 514.5,-684 569.5,-684 569.5,-708"/>
<text text-anchor="middle" x="542" y="-693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">verbose</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;verbose -->
<g id="proc~~compute_mbe~~CallsGraph_edge63" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;verbose</title>
<path fill="none" stroke="#3f00ff" d="M328.65,-727.13C384.99,-718.87 460.06,-707.87 504.2,-701.39"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="504.81,-704.84 514.19,-699.93 503.79,-697.92 504.81,-704.84"/>
</g>
<!-- warning -->
<g id="proc~~compute_mbe~~CallsGraph_node51" class="node">
<title>warning</title>
<polygon fill="#777777" stroke="#777777" points="841,-570 786,-570 786,-546 841,-546 841,-570"/>
<text text-anchor="middle" x="813.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warning</text>
</g>
<!-- proc~print_detailed_breakdown&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge64" class="edge">
<title>proc~print_detailed_breakdown&#45;&gt;warning</title>
<path fill="none" stroke="#3f00ff" d="M328.71,-739.52C347.96,-736.49 367.37,-729.92 382,-717 424.37,-679.57 374.35,-630.93 418,-595 471.92,-550.62 688.45,-553.36 775.75,-556.4"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="775.85,-559.9 785.97,-556.77 776.11,-552.91 775.85,-559.9"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge65" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;error</title>
<path fill="none" stroke="#7f00ff" d="M342.27,-903.53C356.58,-906.74 370.47,-912.18 382,-921 414.9,-946.19 383.5,-984.04 418,-1007 463.88,-1037.53 620.59,-1038.23 666,-1007 702.86,-981.65 665.14,-938.35 702,-913 783.66,-856.83 827.07,-897.73 925,-913 1085.82,-938.08 1267.55,-1010.37 1342.87,-1042.4"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1341.79,-1045.74 1352.36,-1046.46 1344.55,-1039.31 1341.79,-1045.74"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge66" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;info</title>
<path fill="none" stroke="#7f00ff" d="M282.04,-891.9C314.13,-878.24 369,-856.2 418,-843 446.74,-835.26 480.05,-829.78 504.75,-826.36"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="505.33,-829.82 514.78,-825.02 504.4,-822.88 505.33,-829.82"/>
</g>
<!-- proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_node42" class="node">
<title>proc~get_basename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node42"><a xlink:href="../proc/get_basename.html" xlink:title="get_basename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="587.5,-956 496.5,-956 496.5,-932 587.5,-932 587.5,-956"/>
<text text-anchor="middle" x="542" y="-941.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_basename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename -->
<g id="proc~~compute_mbe~~CallsGraph_edge67" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_basename</title>
<path fill="none" stroke="#7f00ff" d="M340.46,-916C387.72,-922.6 444.93,-930.59 486.13,-936.34"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="485.86,-939.84 496.25,-937.75 486.83,-932.9 485.86,-939.84"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name -->
<g id="proc~~compute_mbe~~CallsGraph_edge68" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_frag_level_name</title>
<path fill="none" stroke="#7f00ff" d="M340.46,-892C381.61,-886.25 430.32,-879.45 469.43,-873.99"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="470.25,-877.41 479.67,-872.56 469.28,-870.48 470.25,-877.41"/>
</g>
<!-- proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_node45" class="node">
<title>proc~get_output_json_filename</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node45"><a xlink:href="../proc/get_output_json_filename.html" xlink:title="get_output_json_filename">
<polygon fill="#d94e8f" stroke="#d94e8f" points="616.5,-998 467.5,-998 467.5,-974 616.5,-974 616.5,-998"/>
<text text-anchor="middle" x="542" y="-983.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_output_json_filename</text>
</a>
</g>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename -->
<g id="proc~~compute_mbe~~CallsGraph_edge69" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;proc~get_output_json_filename</title>
<path fill="none" stroke="#7f00ff" d="M282.04,-916.1C314.13,-929.76 369,-951.8 418,-965 430.58,-968.39 444.05,-971.35 457.28,-973.89"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="456.87,-977.37 467.34,-975.75 458.14,-970.49 456.87,-977.37"/>
</g>
<!-- proc~print_detailed_breakdown_json&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge70" class="edge">
<title>proc~print_detailed_breakdown_json&#45;&gt;warning</title>
<path fill="none" stroke="#7f00ff" d="M342.38,-910.41C447.37,-916.31 615.24,-919.57 666,-885 772.97,-812.15 802.83,-641.73 810.27,-580.45"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="813.76,-580.66 811.41,-570.33 806.81,-579.87 813.76,-580.66"/>
</g>
<!-- proc~print_mbe_energy_breakdown&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge71" class="edge">
<title>proc~print_mbe_energy_breakdown&#45;&gt;info</title>
<path fill="none" stroke="#bf00ff" d="M336.6,-792.04C392.09,-800.17 462.64,-810.51 504.68,-816.68"/>
<polygon fill="#bf00ff" stroke="#bf00ff" points="504.32,-820.16 514.72,-818.15 505.34,-813.23 504.32,-820.16"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge72" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;info</title>
<path fill="none" stroke="#ff00ff" d="M324.8,-651.82C345.34,-654.55 366.42,-661.12 382,-675 425.48,-713.75 374.63,-762.13 418,-801 441.28,-821.87 477.41,-825.88 504.5,-825.41"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="504.9,-828.9 514.76,-825.02 504.63,-821.9 504.9,-828.9"/>
</g>
<!-- proc~print_mbe_gradient_info&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge73" class="edge">
<title>proc~print_mbe_gradient_info&#45;&gt;to_char</title>
<path fill="none" stroke="#ff00ff" d="M261.31,-641.6C280.63,-607.83 339.52,-514.19 418,-476 460.33,-455.4 1171.29,-413.01 1341.91,-403.1"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1342.35,-406.59 1352.13,-402.51 1341.94,-399.6 1342.35,-406.59"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;info -->
<g id="proc~~compute_mbe~~CallsGraph_edge74" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;info</title>
<path fill="none" stroke="#ff00bf" d="M327.75,-695.64C346.99,-698.68 366.64,-704.96 382,-717 413.97,-742.05 386.1,-775.86 418,-801 442.33,-820.18 477.87,-824.48 504.49,-824.55"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="504.64,-828.04 514.58,-824.37 504.52,-821.05 504.64,-828.04"/>
</g>
<!-- proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_node35" class="node">
<title>proc~element_number_to_symbol</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node35"><a xlink:href="../proc/element_number_to_symbol.html" xlink:title="element_number_to_symbol">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1461,-834 1298,-834 1298,-810 1461,-810 1461,-834"/>
<text text-anchor="middle" x="1379.5" y="-819.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_number_to_symbol</text>
</a>
</g>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_edge75" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#ff00bf" d="M327.62,-698.4C347.43,-695.5 367.41,-688.79 382,-675 435.3,-624.64 360.78,-559.84 418,-514 506.02,-443.49 819.97,-495.92 925,-537 1082.88,-598.75 1095.61,-662.87 1227,-770 1243.36,-783.34 1243.95,-791.9 1263,-801 1270.88,-804.76 1279.37,-807.86 1288.03,-810.4"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1287.29,-813.82 1297.86,-813.04 1289.1,-807.06 1287.29,-813.82"/>
</g>
<!-- proc~print_vibrational_analysis&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge76" class="edge">
<title>proc~print_vibrational_analysis&#45;&gt;warning</title>
<path fill="none" stroke="#ff00bf" d="M327.53,-697.47C347.11,-694.5 366.98,-687.98 382,-675 421.88,-640.53 375.6,-593.32 418,-562 526.26,-482.03 700.76,-522.47 776.03,-545.59"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="775.38,-549.06 785.97,-548.72 777.48,-542.38 775.38,-549.06"/>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge82" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#ffeb00" d="M837.97,-1236.09C860.47,-1247.78 895.3,-1266.16 925,-1283 974.79,-1311.23 1031.67,-1345.96 1064.83,-1366.47"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1063.19,-1369.57 1073.53,-1371.86 1066.88,-1363.61 1063.19,-1369.57"/>
</g>
<!-- proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node54" class="node">
<title>proc~add_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node54"><a xlink:href="../proc/add_hydrogen_caps.html" xlink:title="add_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1153,-1236 1035,-1236 1035,-1212 1153,-1212 1153,-1236"/>
<text text-anchor="middle" x="1094" y="-1221.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">add_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge77" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~add_hydrogen_caps</title>
<path fill="none" stroke="#ffeb00" d="M896.55,-1224C937.35,-1224 986.08,-1224 1024.8,-1224"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1024.92,-1227.5 1034.92,-1224 1024.92,-1220.5 1024.92,-1227.5"/>
</g>
<!-- proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_node57" class="node">
<title>proc~calculate_monomer_distance</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node57"><a xlink:href="../proc/calculate_monomer_distance.html" xlink:title="calculate_monomer_distance">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1178.5,-1278 1009.5,-1278 1009.5,-1254 1178.5,-1254 1178.5,-1278"/>
<text text-anchor="middle" x="1094" y="-1263.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_monomer_distance</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance -->
<g id="proc~~compute_mbe~~CallsGraph_edge78" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~calculate_monomer_distance</title>
<path fill="none" stroke="#ffeb00" d="M894.31,-1236.04C928.25,-1241.15 967.99,-1247.15 1002.97,-1252.42"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1002.77,-1255.93 1013.18,-1253.96 1003.82,-1249.01 1002.77,-1255.93"/>
</g>
<!-- proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_node58" class="node">
<title>proc~check_duplicate_atoms</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node58"><a xlink:href="../proc/check_duplicate_atoms.html" xlink:title="check_duplicate_atoms">
<polygon fill="#d9534f" stroke="#d9534f" points="1162.5,-866 1025.5,-866 1025.5,-842 1162.5,-842 1162.5,-866"/>
<text text-anchor="middle" x="1094" y="-851.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_duplicate_atoms</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms -->
<g id="proc~~compute_mbe~~CallsGraph_edge79" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~check_duplicate_atoms</title>
<path fill="none" stroke="#ffeb00" d="M850.99,-1211.94C874.79,-1202.46 905.04,-1187.12 925,-1165 953.32,-1133.63 942.19,-1114.84 961,-1077 999.22,-1000.12 1053.81,-913.95 1079.12,-875.05"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1082.36,-876.5 1084.9,-866.22 1076.5,-872.67 1082.36,-876.5"/>
</g>
<!-- proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_node59" class="node">
<title>proc~count_hydrogen_caps</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node59"><a xlink:href="../proc/count_hydrogen_caps.html" xlink:title="count_hydrogen_caps">
<polygon fill="#d9534f" stroke="#d9534f" points="1158,-1152 1030,-1152 1030,-1128 1158,-1128 1158,-1152"/>
<text text-anchor="middle" x="1094" y="-1137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_hydrogen_caps</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps -->
<g id="proc~~compute_mbe~~CallsGraph_edge80" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~count_hydrogen_caps</title>
<path fill="none" stroke="#ffeb00" d="M891.25,-1211.95C902.98,-1208.42 914.62,-1203.87 925,-1198 944.97,-1186.7 940.63,-1171.56 961,-1161 978.97,-1151.68 1000.03,-1146.27 1019.98,-1143.19"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1020.54,-1146.65 1029.98,-1141.83 1019.6,-1139.71 1020.54,-1146.65"/>
</g>
<!-- proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_node61" class="node">
<title>proc~error_add_context</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node61"><a xlink:href="../proc/error_add_context.html" xlink:title="error_t%error_add_context">
<polygon fill="#d9534f" stroke="#d9534f" points="1171,-1110 1017,-1110 1017,-1086 1171,-1086 1171,-1110"/>
<text text-anchor="middle" x="1094" y="-1095.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_add_context</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~error_add_context -->
<g id="proc~~compute_mbe~~CallsGraph_edge81" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~error_add_context</title>
<path fill="none" stroke="#ffeb00" d="M896.68,-1213.7C906.92,-1209.9 916.7,-1204.81 925,-1198 954.83,-1173.52 930.29,-1142.37 961,-1119 974.15,-1108.99 990.2,-1102.93 1006.52,-1099.39"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1007.5,-1102.76 1016.69,-1097.49 1006.22,-1095.88 1007.5,-1102.76"/>
</g>
<!-- proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_node62" class="node">
<title>proc~fragment_compute_nelec</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node62"><a xlink:href="../proc/fragment_compute_nelec.html" xlink:title="physical_fragment_t%fragment_compute_nelec">
<polygon fill="#d9534f" stroke="#d9534f" points="1227,-1194 961,-1194 961,-1170 1227,-1170 1227,-1194"/>
<text text-anchor="middle" x="1094" y="-1179.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physical_fragment_t%fragment_compute_nelec</text>
</a>
</g>
</g>
<!-- proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec -->
<g id="proc~~compute_mbe~~CallsGraph_edge83" class="edge">
<title>proc~build_fragment_from_indices&#45;&gt;proc~fragment_compute_nelec</title>
<path fill="none" stroke="#ffeb00" d="M894.31,-1211.96C928.25,-1206.85 967.99,-1200.85 1002.97,-1195.58"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1003.82,-1198.99 1013.18,-1194.04 1002.77,-1192.07 1003.82,-1198.99"/>
</g>
<!-- proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_node60" class="node">
<title>proc~element_mass</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node60"><a xlink:href="../proc/element_mass.html" xlink:title="element_mass">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1139,-129 1049,-129 1049,-105 1139,-105 1139,-129"/>
<text text-anchor="middle" x="1094" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">element_mass</text>
</a>
</g>
</g>
<!-- proc~compute_cartesian_displacements&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge84" class="edge">
<title>proc~compute_cartesian_displacements&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#d7ff00" d="M881.24,-66.05C895.7,-68.83 910.89,-71.9 925,-75 963.32,-83.42 1006.23,-94.17 1039.09,-102.69"/>
<polygon fill="#d7ff00" stroke="#d7ff00" points="1038.39,-106.12 1048.95,-105.25 1040.15,-99.35 1038.39,-106.12"/>
</g>
<!-- proc~compute_reduced_masses&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge85" class="edge">
<title>proc~compute_reduced_masses&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#62ff00" d="M890.6,-101.74C937.47,-105.27 996.44,-109.72 1038.62,-112.9"/>
<polygon fill="#62ff00" stroke="#62ff00" points="1038.46,-116.4 1048.7,-113.66 1038.99,-109.42 1038.46,-116.4"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge86" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;error</title>
<path fill="none" stroke="#27ff00" d="M610.14,-232.01C691.23,-249.15 828.7,-286.85 925,-359 1106.4,-494.92 1124.64,-567.75 1227,-770 1251.19,-817.79 1239.9,-836.68 1263,-885 1291.34,-944.26 1337.72,-1006.65 1362.19,-1037.8"/>
<polygon fill="#27ff00" stroke="#27ff00" points="1359.53,-1040.07 1368.48,-1045.73 1365.01,-1035.72 1359.53,-1040.07"/>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;warning -->
<g id="proc~~compute_mbe~~CallsGraph_edge90" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;warning</title>
<path fill="none" stroke="#27ff00" d="M589.46,-232.08C615.36,-241.05 646.27,-255.83 666,-279 702.65,-322.05 677.4,-350.1 702,-401 727.87,-454.54 771.34,-509.7 795.32,-538.22"/>
<polygon fill="#27ff00" stroke="#27ff00" points="792.68,-540.51 801.82,-545.86 798.01,-535.98 792.68,-540.51"/>
</g>
<!-- pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_node53" class="node">
<title>pic_syev</title>
<polygon fill="#777777" stroke="#777777" points="842.5,-234 784.5,-234 784.5,-210 842.5,-210 842.5,-234"/>
<text text-anchor="middle" x="813.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_syev</text>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;pic_syev -->
<g id="proc~~compute_mbe~~CallsGraph_edge87" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;pic_syev</title>
<path fill="none" stroke="#27ff00" d="M637.26,-220.7C684.17,-221.05 738.29,-221.45 773.83,-221.71"/>
<polygon fill="#27ff00" stroke="#27ff00" points="774.21,-225.22 784.24,-221.79 774.26,-218.22 774.21,-225.22"/>
</g>
<!-- proc~mass_weight_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_node63" class="node">
<title>proc~mass_weight_hessian</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node63"><a xlink:href="../proc/mass_weight_hessian.html" xlink:title="mass_weight_hessian">
<polygon fill="#d9534f" stroke="#d9534f" points="877,-150 750,-150 750,-126 877,-126 877,-150"/>
<text text-anchor="middle" x="813.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mass_weight_hessian</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian -->
<g id="proc~~compute_mbe~~CallsGraph_edge88" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~mass_weight_hessian</title>
<path fill="none" stroke="#27ff00" d="M637.25,-210.69C647.29,-207.73 657.08,-203.91 666,-199 686.95,-187.46 681.16,-170.74 702,-159 713.52,-152.51 726.69,-147.98 739.81,-144.84"/>
<polygon fill="#27ff00" stroke="#27ff00" points="740.77,-148.21 749.82,-142.69 739.3,-141.37 740.77,-148.21"/>
</g>
<!-- proc~project_translation_rotation -->
<g id="proc~~compute_mbe~~CallsGraph_node65" class="node">
<title>proc~project_translation_rotation</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node65"><a xlink:href="../proc/project_translation_rotation.html" xlink:title="project_translation_rotation">
<polygon fill="#d9534f" stroke="#d9534f" points="892.5,-192 734.5,-192 734.5,-168 892.5,-168 892.5,-192"/>
<text text-anchor="middle" x="813.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">project_translation_rotation</text>
</a>
</g>
</g>
<!-- proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation -->
<g id="proc~~compute_mbe~~CallsGraph_edge89" class="edge">
<title>proc~compute_vibrational_frequencies&#45;&gt;proc~project_translation_rotation</title>
<path fill="none" stroke="#27ff00" d="M623.86,-208C655.61,-203.29 692.15,-197.86 724.56,-193.05"/>
<polygon fill="#27ff00" stroke="#27ff00" points="725.1,-196.51 734.48,-191.58 724.07,-189.59 725.1,-196.51"/>
</g>
<!-- proc~error_get_full_trace&#45;&gt;proc~error_has_error -->
<g id="proc~~compute_mbe~~CallsGraph_edge91" class="edge">
<title>proc~error_get_full_trace&#45;&gt;proc~error_has_error</title>
<path fill="none" stroke="#00ff4e" d="M886.19,-1452C899.18,-1449.37 912.55,-1446.35 925,-1443 969.83,-1430.94 1019.88,-1412.73 1053.59,-1399.73"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="1055.03,-1402.93 1063.08,-1396.04 1052.49,-1396.4 1055.03,-1402.93"/>
</g>
<!-- proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node56" class="node">
<title>proc~basis_set_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node56"><a xlink:href="../proc/basis_set_destroy.html" xlink:title="molecular_basis_type%basis_set_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1208.5,-803 979.5,-803 979.5,-779 1208.5,-779 1208.5,-803"/>
<text text-anchor="middle" x="1094" y="-788.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">molecular_basis_type%basis_set_destroy</text>
</a>
</g>
</g>
<!-- proc~fragment_destroy&#45;&gt;proc~basis_set_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge92" class="edge">
<title>proc~fragment_destroy&#45;&gt;proc~basis_set_destroy</title>
<path fill="none" stroke="#00ffc4" d="M914.37,-1131.94C918.22,-1129.38 921.79,-1126.42 925,-1123 1013.84,-1028.26 878.02,-932.91 961,-833 970.55,-821.5 983.25,-813.11 996.99,-807"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="998.68,-810.09 1006.65,-803.12 996.07,-803.6 998.68,-810.09"/>
</g>
<!-- fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_node52" class="node">
<title>fnv_1a_hash</title>
<polygon fill="#777777" stroke="#777777" points="853,-946 774,-946 774,-922 853,-922 853,-946"/>
<text text-anchor="middle" x="813.5" y="-931.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnv_1a_hash</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge93" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#00ffff" d="M642.63,-1053.96C651.05,-1050.34 659.01,-1045.76 666,-1040 697.66,-1013.91 670.07,-980.76 702,-955 719.24,-941.09 742.9,-935.38 763.9,-933.34"/>
<polygon fill="#00ffff" stroke="#00ffff" points="764.24,-936.83 773.96,-932.61 763.73,-929.84 764.24,-936.83"/>
</g>
<!-- proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node55" class="node">
<title>proc~arrays_equal_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node55"><a xlink:href="../proc/arrays_equal_internal.html" xlink:title="arrays_equal_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="877.5,-1030 749.5,-1030 749.5,-1006 877.5,-1006 877.5,-1030"/>
<text text-anchor="middle" x="813.5" y="-1015.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">arrays_equal_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge94" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;proc~arrays_equal_internal</title>
<path fill="none" stroke="#00ffff" d="M610.66,-1053.95C649.9,-1046.96 699.33,-1038.16 739.45,-1031.01"/>
<polygon fill="#00ffff" stroke="#00ffff" points="740.21,-1034.43 749.44,-1029.23 738.98,-1027.54 740.21,-1034.43"/>
</g>
<!-- sort -->
<g id="proc~~compute_mbe~~CallsGraph_node66" class="node">
<title>sort</title>
<polygon fill="#777777" stroke="#777777" points="840.5,-988 786.5,-988 786.5,-964 840.5,-964 840.5,-988"/>
<text text-anchor="middle" x="813.5" y="-973.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sort</text>
</g>
<!-- proc~fragment_lookup_find&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge95" class="edge">
<title>proc~fragment_lookup_find&#45;&gt;sort</title>
<path fill="none" stroke="#00ffff" d="M634.3,-1053.92C645.42,-1050.39 656.27,-1045.85 666,-1040 687.36,-1027.16 680.5,-1009.62 702,-997 724.39,-983.86 753.32,-978.7 775.97,-976.78"/>
<polygon fill="#00ffff" stroke="#00ffff" points="776.46,-980.26 786.2,-976.09 775.99,-973.27 776.46,-980.26"/>
</g>
<!-- proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_node64" class="node">
<title>proc~next_prime_internal</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node64"><a xlink:href="../proc/next_prime_internal.html" xlink:title="next_prime_internal">
<polygon fill="#d94e8f" stroke="#d94e8f" points="872.5,-392 754.5,-392 754.5,-368 872.5,-368 872.5,-392"/>
<text text-anchor="middle" x="813.5" y="-377.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">next_prime_internal</text>
</a>
</g>
</g>
<!-- proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal -->
<g id="proc~~compute_mbe~~CallsGraph_edge96" class="edge">
<title>proc~fragment_lookup_init&#45;&gt;proc~next_prime_internal</title>
<path fill="none" stroke="#00c4ff" d="M659.64,-380C688.4,-380 718.27,-380 743.9,-380"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="744.24,-383.5 754.24,-380 744.24,-376.5 744.24,-383.5"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash -->
<g id="proc~~compute_mbe~~CallsGraph_edge97" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;fnv_1a_hash</title>
<path fill="none" stroke="#0089ff" d="M641.01,-628.02C649.97,-631.62 658.48,-636.2 666,-642 757.8,-712.81 796.4,-856.72 808.23,-911.84"/>
<polygon fill="#0089ff" stroke="#0089ff" points="804.86,-912.82 810.31,-921.91 811.72,-911.41 804.86,-912.82"/>
</g>
<!-- proc~fragment_lookup_insert&#45;&gt;sort -->
<g id="proc~~compute_mbe~~CallsGraph_edge98" class="edge">
<title>proc~fragment_lookup_insert&#45;&gt;sort</title>
<path fill="none" stroke="#0089ff" d="M648.23,-628.05C654.82,-631.76 660.86,-636.35 666,-642 760.26,-745.55 606.68,-852.42 702,-955 720.49,-974.9 751.52,-979.37 776,-979.31"/>
<polygon fill="#0089ff" stroke="#0089ff" points="776.13,-982.81 786.03,-979.04 775.94,-975.81 776.13,-982.81"/>
</g>
<!-- proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node68" class="node">
<title>proc~atomic_basis_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node68"><a xlink:href="../proc/atomic_basis_destroy.html" xlink:title="atomic_basis_type%atomic_basis_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1496,-792 1263,-792 1263,-768 1496,-768 1496,-792"/>
<text text-anchor="middle" x="1379.5" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">atomic_basis_type%atomic_basis_destroy</text>
</a>
</g>
</g>
<!-- proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge99" class="edge">
<title>proc~basis_set_destroy&#45;&gt;proc~atomic_basis_destroy</title>
<path fill="none" stroke="#65ff00" d="M1208.68,-786.59C1223.2,-786.03 1238.12,-785.45 1252.82,-784.88"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1253.09,-788.37 1262.95,-784.48 1252.82,-781.37 1253.09,-788.37"/>
</g>
<!-- proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_node70" class="node">
<title>proc~to_angstrom</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node70"><a xlink:href="../proc/to_angstrom.html" xlink:title="to_angstrom">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1419,-1278 1340,-1278 1340,-1254 1419,-1254 1419,-1278"/>
<text text-anchor="middle" x="1379.5" y="-1263.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_angstrom</text>
</a>
</g>
</g>
<!-- proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom -->
<g id="proc~~compute_mbe~~CallsGraph_edge100" class="edge">
<title>proc~calculate_monomer_distance&#45;&gt;proc~to_angstrom</title>
<path fill="none" stroke="#00ff00" d="M1178.53,-1266C1227.76,-1266 1288.34,-1266 1329.84,-1266"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1329.96,-1269.5 1339.96,-1266 1329.96,-1262.5 1329.96,-1269.5"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;error -->
<g id="proc~~compute_mbe~~CallsGraph_edge101" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;error</title>
<path fill="none" stroke="#00ff66" d="M1162.56,-858.49C1184.26,-862.17 1207.65,-868.66 1227,-880 1293.81,-919.15 1345.2,-998.84 1367.03,-1036.88"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1363.99,-1038.6 1371.94,-1045.6 1370.09,-1035.17 1363.99,-1038.6"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;to_char -->
<g id="proc~~compute_mbe~~CallsGraph_edge104" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;to_char</title>
<path fill="none" stroke="#00ff66" d="M1162.6,-844.82C1185.43,-838.76 1209.53,-828.7 1227,-812 1286.47,-755.15 1353.63,-500.82 1373.01,-423.42"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1376.5,-423.88 1375.51,-413.33 1369.7,-422.19 1376.5,-423.88"/>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol -->
<g id="proc~~compute_mbe~~CallsGraph_edge102" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~element_number_to_symbol</title>
<path fill="none" stroke="#00ff66" d="M1162.55,-846.38C1199.99,-842.15 1247.05,-836.84 1287.68,-832.25"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1288.31,-835.7 1297.86,-831.1 1287.53,-828.75 1288.31,-835.7"/>
</g>
<!-- proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_node69" class="node">
<title>proc~error_set</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node69"><a xlink:href="../proc/error_set.html" xlink:title="error_t%error_set">
<polygon fill="#d9534f" stroke="#d9534f" points="1432,-876 1327,-876 1327,-852 1432,-852 1432,-876"/>
<text text-anchor="middle" x="1379.5" y="-861.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">error_t%error_set</text>
</a>
</g>
</g>
<!-- proc~check_duplicate_atoms&#45;&gt;proc~error_set -->
<g id="proc~~compute_mbe~~CallsGraph_edge103" class="edge">
<title>proc~check_duplicate_atoms&#45;&gt;proc~error_set</title>
<path fill="none" stroke="#00ff66" d="M1162.55,-856.38C1209.44,-858.04 1271.43,-860.22 1316.96,-861.83"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1316.88,-865.33 1326.99,-862.18 1317.12,-858.33 1316.88,-865.33"/>
</g>
<!-- proc~mass_weight_hessian&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge105" class="edge">
<title>proc~mass_weight_hessian&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#6500ff" d="M877,-133.29C925.61,-129.62 992.35,-124.59 1038.74,-121.09"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1039.18,-124.57 1048.89,-120.33 1038.66,-117.59 1039.18,-124.57"/>
</g>
<!-- proc~project_translation_rotation&#45;&gt;proc~element_mass -->
<g id="proc~~compute_mbe~~CallsGraph_edge107" class="edge">
<title>proc~project_translation_rotation&#45;&gt;proc~element_mass</title>
<path fill="none" stroke="#ff00cb" d="M881.24,-167.95C895.7,-165.17 910.89,-162.1 925,-159 963.32,-150.58 1006.23,-139.83 1039.09,-131.31"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1040.15,-134.65 1048.95,-128.75 1038.39,-127.88 1040.15,-134.65"/>
</g>
<!-- pic_gesvd -->
<g id="proc~~compute_mbe~~CallsGraph_node67" class="node">
<title>pic_gesvd</title>
<polygon fill="#777777" stroke="#777777" points="1126.5,-192 1061.5,-192 1061.5,-168 1126.5,-168 1126.5,-192"/>
<text text-anchor="middle" x="1094" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pic_gesvd</text>
</g>
<!-- proc~project_translation_rotation&#45;&gt;pic_gesvd -->
<g id="proc~~compute_mbe~~CallsGraph_edge106" class="edge">
<title>proc~project_translation_rotation&#45;&gt;pic_gesvd</title>
<path fill="none" stroke="#ff00cb" d="M892.82,-180C944.28,-180 1009.58,-180 1051.34,-180"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1051.42,-183.5 1061.42,-180 1051.42,-176.5 1051.42,-183.5"/>
</g>
<!-- proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_node71" class="node">
<title>proc~cgto_destroy</title>
<g id="a_proc~~compute_mbe~~CallsGraph_node71"><a xlink:href="../proc/cgto_destroy.html" xlink:title="cgto_type%cgto_destroy">
<polygon fill="#d9534f" stroke="#d9534f" points="1674,-792 1532,-792 1532,-768 1674,-768 1674,-792"/>
<text text-anchor="middle" x="1603" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cgto_type%cgto_destroy</text>
</a>
</g>
</g>
<!-- proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy -->
<g id="proc~~compute_mbe~~CallsGraph_edge108" class="edge">
<title>proc~atomic_basis_destroy&#45;&gt;proc~cgto_destroy</title>
<path fill="none" stroke="#7fff00" d="M1496.12,-780C1504.77,-780 1513.38,-780 1521.74,-780"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1521.79,-783.5 1531.79,-780 1521.79,-776.5 1521.79,-783.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCallsGraph = svgPanZoom('#proccompute_mbeCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~compute_mbe~~CalledByGraph Pages: 1 -->
<svg id="proccompute_mbeCalledByGraph" width="641pt" height="72pt"
 viewBox="0.00 0.00 641.00 72.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~compute_mbe~~CalledByGraph" class="graph" transform="scale(0.62 0.62) rotate(0) translate(4 112)">
<title>proc~~compute_mbe~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 1025,-112 1025,4 -4,4"/>
<!-- proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_node1" class="node">
<title>proc~compute_mbe</title>
<polygon fill="none" stroke="black" points="1021,-66 932,-66 932,-42 1021,-42 1021,-66"/>
<text text-anchor="middle" x="976.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">compute_mbe</text>
</g>
<!-- proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node2" class="node">
<title>proc~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node2"><a xlink:href="../proc/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#d9534f" stroke="#d9534f" points="875.5,-87 762.5,-87 762.5,-63 875.5,-63 875.5,-87"/>
<text text-anchor="middle" x="819" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- proc~global_coordinator&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge1" class="edge">
<title>proc~global_coordinator&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M875.7,-67.48C890.71,-65.45 906.92,-63.26 921.82,-61.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="922.45,-64.7 931.89,-59.89 921.51,-57.76 922.45,-64.7"/>
</g>
<!-- proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node3" class="node">
<title>proc~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node3"><a xlink:href="../proc/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#d9534f" stroke="#d9534f" points="896,-45 742,-45 742,-21 896,-21 896,-45"/>
<text text-anchor="middle" x="819" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- proc~serial_fragment_processor&#45;&gt;proc~compute_mbe -->
<g id="proc~~compute_mbe~~CalledByGraph_edge2" class="edge">
<title>proc~serial_fragment_processor&#45;&gt;proc~compute_mbe</title>
<path fill="none" stroke="#ff0000" d="M896.38,-43.32C904.92,-44.47 913.47,-45.62 921.64,-46.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="921.36,-50.22 931.74,-48.09 922.3,-43.28 921.36,-50.22"/>
</g>
<!-- interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_node4" class="node">
<title>interface~global_coordinator</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node4"><a xlink:href="../interface/global_coordinator.html" xlink:title="global_coordinator">
<polygon fill="#a7506f" stroke="#a7506f" points="685.5,-87 572.5,-87 572.5,-63 685.5,-63 685.5,-87"/>
<text text-anchor="middle" x="629" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">global_coordinator</text>
</a>
</g>
</g>
<!-- interface~global_coordinator&#45;&gt;proc~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge3" class="edge">
<title>interface~global_coordinator&#45;&gt;proc~global_coordinator</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M685.64,-75C706.58,-75 730.58,-75 752.35,-75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="752.5,-78.5 762.5,-75 752.5,-71.5 752.5,-78.5"/>
</g>
<!-- interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_node5" class="node">
<title>interface~serial_fragment_processor</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node5"><a xlink:href="../interface/serial_fragment_processor.html" xlink:title="serial_fragment_processor">
<polygon fill="#a7506f" stroke="#a7506f" points="706,-45 552,-45 552,-21 706,-21 706,-45"/>
<text text-anchor="middle" x="629" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">serial_fragment_processor</text>
</a>
</g>
</g>
<!-- interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge4" class="edge">
<title>interface~serial_fragment_processor&#45;&gt;proc~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M706.2,-33C714.52,-33 723.03,-33 731.47,-33"/>
<polygon fill="#00ffff" stroke="#00ffff" points="731.7,-36.5 741.7,-33 731.7,-29.5 731.7,-36.5"/>
</g>
<!-- proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node6" class="node">
<title>proc~run_fragmented_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node6"><a xlink:href="../proc/run_fragmented_calculation.html" xlink:title="run_fragmented_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="516,-66 353,-66 353,-42 516,-42 516,-66"/>
<text text-anchor="middle" x="434.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_fragmented_calculation</text>
</a>
</g>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator -->
<g id="proc~~compute_mbe~~CalledByGraph_edge5" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~global_coordinator</title>
<path fill="none" stroke="#ff0000" d="M516.02,-62.78C531.42,-64.46 547.38,-66.21 562.25,-67.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="562.03,-71.32 572.35,-68.93 562.79,-64.37 562.03,-71.32"/>
</g>
<!-- proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor -->
<g id="proc~~compute_mbe~~CalledByGraph_edge6" class="edge">
<title>proc~run_fragmented_calculation&#45;&gt;interface~serial_fragment_processor</title>
<path fill="none" stroke="#00ffff" d="M516.02,-45.22C524.54,-44.29 533.22,-43.34 541.8,-42.4"/>
<polygon fill="#00ffff" stroke="#00ffff" points="542.24,-45.88 551.8,-41.31 541.48,-38.92 542.24,-45.88"/>
</g>
<!-- proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_node7" class="node">
<title>proc~run_calculation</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node7"><a xlink:href="../proc/run_calculation.html" xlink:title="run_calculation">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-66 223,-66 223,-42 317,-42 317,-66"/>
<text text-anchor="middle" x="270" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_calculation</text>
</a>
</g>
</g>
<!-- proc~run_calculation&#45;&gt;proc~run_fragmented_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge7" class="edge">
<title>proc~run_calculation&#45;&gt;proc~run_fragmented_calculation</title>
<path fill="none" stroke="#ff0000" d="M317.13,-54C325.24,-54 333.94,-54 342.78,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.8,-57.5 352.8,-54 342.8,-50.5 342.8,-57.5"/>
</g>
<!-- proc~compute_energy_and_forces -->
<g id="proc~~compute_mbe~~CalledByGraph_node8" class="node">
<title>proc~compute_energy_and_forces</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node8"><a xlink:href="../proc/compute_energy_and_forces.html" xlink:title="compute_energy_and_forces">
<polygon fill="#d9534f" stroke="#d9534f" points="176.5,-108 10.5,-108 10.5,-84 176.5,-84 176.5,-108"/>
<text text-anchor="middle" x="93.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_energy_and_forces</text>
</a>
</g>
</g>
<!-- proc~compute_energy_and_forces&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge8" class="edge">
<title>proc~compute_energy_and_forces&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M148.85,-83.92C161.39,-81.06 174.67,-77.98 187,-75 195.32,-72.99 204.09,-70.81 212.69,-68.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.82,-71.96 222.65,-66.11 212.1,-65.18 213.82,-71.96"/>
</g>
<!-- proc~run_multi_molecule_calculations -->
<g id="proc~~compute_mbe~~CalledByGraph_node9" class="node">
<title>proc~run_multi_molecule_calculations</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node9"><a xlink:href="../proc/run_multi_molecule_calculations.html" xlink:title="run_multi_molecule_calculations">
<polygon fill="#d9534f" stroke="#d9534f" points="187,-66 0,-66 0,-42 187,-42 187,-66"/>
<text text-anchor="middle" x="93.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">run_multi_molecule_calculations</text>
</a>
</g>
</g>
<!-- proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge9" class="edge">
<title>proc~run_multi_molecule_calculations&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M187.11,-54C195.83,-54 204.48,-54 212.7,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.87,-57.5 222.87,-54 212.87,-50.5 212.87,-57.5"/>
</g>
<!-- program~main -->
<g id="proc~~compute_mbe~~CalledByGraph_node10" class="node">
<title>program~main</title>
<g id="a_proc~~compute_mbe~~CalledByGraph_node10"><a xlink:href="../program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="120.5,-24 66.5,-24 66.5,0 120.5,0 120.5,-24"/>
<text text-anchor="middle" x="93.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~run_calculation -->
<g id="proc~~compute_mbe~~CalledByGraph_edge10" class="edge">
<title>program~main&#45;&gt;proc~run_calculation</title>
<path fill="none" stroke="#ff0000" d="M120.86,-17.78C139.39,-21.9 164.75,-27.63 187,-33 195.32,-35.01 204.09,-37.19 212.69,-39.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.1,-42.82 222.65,-41.89 213.82,-36.04 212.1,-42.82"/>
</g>
</g>
</svg>
</div>                <script>
                  var panproccompute_mbeCalledByGraph = svgPanZoom('#proccompute_mbeCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    <section>    
      <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_grad"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_grad</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-compute_hess"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>compute_hess</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-current_log_level~4"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>current_log_level</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_e~2"></span>
              real(kind=dp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>delta_E</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_gradients~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_gradients</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-delta_hessians~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>delta_hessians</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-do_detailed_print"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>do_detailed_print</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-energies~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>energies</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fragment_size~8"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fragment_size</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-hess_dim~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>hess_dim</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-i~25"></span>
              integer(kind=int64),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lookup~5"></span>
              type(<a href='../type/fragment_lookup_t.html'>fragment_lookup_t</a>),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lookup</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nlevel~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nlevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sum_by_level~2"></span>
              real(kind=dp),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>sum_by_level</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">   </span><span class="k">subroutine </span><span class="n">compute_mbe</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">      </span><span class="c">!! Compute many-body expansion (MBE) energy with optional gradient and/or hessian</span>
<span class="w">      </span><span class="c">!!</span>
<span class="w">      </span><span class="c">!! This is the core routine that handles all MBE computations.</span>
<span class="w">      </span><span class="c">!! Optional arguments control what derivatives are computed:</span>
<span class="w">      </span><span class="c">!!   - If sys_geom and total_gradient are present: compute gradient</span>
<span class="w">      </span><span class="c">!!   - If total_hessian is also present: compute hessian</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_result_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculation_result_t</span>
<span class="w">      </span><span class="k">use </span><span class="n">mqc_config_parser</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">bond_t</span>

<span class="w">      </span><span class="c">! Required arguments</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">polymers</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">calculation_result_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">results</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_energy</span>

<span class="w">      </span><span class="c">! Optional arguments for gradient computation</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">system_geometry_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sys_geom</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!! (3, total_atoms)</span>

<span class="w">      </span><span class="c">! Optional arguments for hessian computation</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">   </span><span class="c">!! (3*total_atoms, 3*total_atoms)</span>

<span class="w">      </span><span class="c">! Optional bond information for hydrogen cap handling</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">bond_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bonds</span><span class="p">(:)</span>

<span class="w">      </span><span class="c">! Optional MPI communicator for abort</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">comm_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">world_comm</span>

<span class="w">      </span><span class="c">! Local variables</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(:),</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(:),</span><span class="w"> </span><span class="n">energies</span><span class="p">(:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">      </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">do_detailed_print</span><span class="p">,</span><span class="w"> </span><span class="n">compute_grad</span><span class="p">,</span><span class="w"> </span><span class="n">compute_hess</span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="n">fragment_lookup_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lookup</span>

<span class="w">      </span><span class="c">! Determine what to compute based on optional arguments</span>
<span class="w">      </span><span class="n">compute_grad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">sys_geom</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">total_gradient</span><span class="p">)</span>
<span class="w">      </span><span class="n">compute_hess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_grad</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">total_hessian</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Validate inputs for gradient computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_gradient</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have gradient!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  error stop</span><span class="w"> </span><span class="s2">&quot;Missing gradient in compute_mbe_internal&quot;</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Validate inputs for hessian computation</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">has_hessian</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">logger</span><span class="p">%</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fragment &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not have Hessian!&quot;</span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">world_comm</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">abort_comm</span><span class="p">(</span><span class="n">world_comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">               </span><span class="k">else</span>
<span class="k">                  error stop</span><span class="w"> </span><span class="s2">&quot;Missing Hessian in compute_mbe_internal&quot;</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">hess_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Get logger configuration</span>
<span class="w">      </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">configuration</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="n">do_detailed_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">current_log_level</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">verbose_level</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Allocate energy arrays (always needed)</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">max_level</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">energies</span><span class="p">(</span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">      </span><span class="n">sum_by_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="n">delta_energies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>

<span class="w">      </span><span class="c">! Extract total energies from results</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">         </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">energy</span><span class="p">%</span><span class="n">total</span><span class="p">()</span>
<span class="w">      </span><span class="k">end do</span>

<span class="w">      </span><span class="c">! Allocate gradient arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">total_atoms</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_gradients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">total_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Allocate hessian arrays if needed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">(</span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">hess_dim</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">))</span>
<span class="w">         </span><span class="n">delta_hessians</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">         </span><span class="n">total_hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Build hash table for fast fragment lookups</span>
<span class="w">      </span><span class="k">call </span><span class="n">build_mbe_lookup_table</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">lookup</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Bottom-up computation: process fragments by size (1-body, then 2-body, etc.)</span>
<span class="w">      </span><span class="c">! This makes the algorithm independent of input fragment order</span>
<span class="w">      </span><span class="c">! We process by n-mer level to ensure all subsets are computed before they&#39;re needed</span>
<span class="w">      </span><span class="k">do </span><span class="n">nlevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span>
<span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Only process fragments of the current nlevel</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! 1-body: delta = value (no subsets to subtract)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_gradient</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">gradient</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                      </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">map_fragment_to_system_hessian</span><span class="p">(</span><span class="n">results</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">hessian</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                   </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">            else if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! n-body: delta = value - sum(all subset deltas)</span>
<span class="w">               </span><span class="n">delta_E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_mbe_delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="n">delta_energies</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delta_E</span>
<span class="w">               </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum_by_level</span><span class="p">(</span><span class="n">fragment_size</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_E</span>

<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_gradient</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">,</span><span class="w"> </span><span class="n">world_comm</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>

<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">compute_mbe_hessian</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">fragment_size</span><span class="p">),</span><span class="w"> </span><span class="n">lookup</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                           </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_size</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">bonds</span><span class="p">)</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">         end do</span>
<span class="k">      end do</span>

<span class="w">      </span><span class="c">! Clean up lookup table</span>
<span class="w">      </span><span class="k">call </span><span class="n">lookup</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>

<span class="w">      </span><span class="c">! Compute totals</span>
<span class="w">      </span><span class="n">total_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">)</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">total_gradient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_gradient</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_gradients</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_int64</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span>
<span class="w">            </span><span class="n">fragment_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="n">polymers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fragment_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_level</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">total_hessian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_hessian</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">delta_hessians</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Print energy breakdown (always)</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_mbe_energy_breakdown</span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">)</span>

<span class="w">      </span><span class="c">! Print gradient info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_mbe_gradient_info</span><span class="p">(</span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">,</span><span class="w"> </span><span class="n">current_log_level</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Print hessian info if computed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MBE Hessian computation completed&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Total Hessian Frobenius norm: &quot;</span><span class="o">//</span><span class="n">to_char</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">total_hessian</span><span class="o">**</span><span class="mi">2</span><span class="p">))))</span>

<span class="w">         </span><span class="c">! Compute and print full vibrational analysis</span>
<span class="w">         </span><span class="k">block</span>
<span class="k">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">frequencies</span><span class="p">(:),</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">(:),</span><span class="w"> </span><span class="n">force_constants</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  Computing vibrational analysis (projecting trans/rot modes)...&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_vibrational_analysis</span><span class="p">(</span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">coordinates</span><span class="o">=</span><span class="n">sys_geom</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">project_trans_rot</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                              </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">frequencies</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               call </span><span class="n">print_vibrational_analysis</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                               </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">sys_geom</span><span class="p">%</span><span class="n">element_numbers</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                               </span><span class="n">force_constants_mdyne</span><span class="o">=</span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">               </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="w"> </span><span class="n">reduced_masses</span><span class="p">,</span><span class="w"> </span><span class="n">force_constants</span><span class="p">,</span><span class="w"> </span><span class="n">cart_disp</span><span class="p">,</span><span class="w"> </span><span class="n">fc_mdyne</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">         end block</span>
<span class="k">      end if</span>

<span class="w">      </span><span class="c">! Print detailed breakdown if requested</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">do_detailed_print</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Write JSON output with appropriate arguments</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_hess</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">total_hessian</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_grad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="n">total_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">         call </span><span class="n">print_detailed_breakdown_json</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span><span class="w"> </span><span class="n">fragment_count</span><span class="p">,</span><span class="w"> </span><span class="n">max_level</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>

<span class="w">      </span><span class="c">! Cleanup</span>
<span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">sum_by_level</span><span class="p">,</span><span class="w"> </span><span class="n">delta_energies</span><span class="p">,</span><span class="w"> </span><span class="n">energies</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_gradients</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta_hessians</span><span class="p">)</span>

<span class="w">   </span><span class="k">end subroutine </span><span class="n">compute_mbe</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              metalquicha
 was developed by Jorge Luis Galvez Vallejo<br>              &copy; 2026 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-09 10:11 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>